24-09-03.20:09:15.038 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 40344 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.20:09:15.039 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
24-09-03.20:09:16.826 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.20:09:16.832 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.20:09:16.908 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 52 ms. Found 0 Redis repository interfaces.
24-09-03.20:09:17.488 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:09:17.504 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:09:17.831 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$65b678bd] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:09:18.858 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.20:10:27.110 [main            ] ERROR HikariPool             - HikariPool-1 - Exception during pool initialization.
java.sql.SQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up.
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:110)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:89)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:63)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:73)
	at com.mysql.cj.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:906)
	at com.mysql.cj.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:831)
	at com.mysql.cj.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:456)
	at com.mysql.cj.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:246)
	at com.mysql.cj.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:198)
	at com.zaxxer.hikari.util.DriverDataSource.getConnection(DriverDataSource.java:138)
	at com.zaxxer.hikari.pool.PoolBase.newConnection(PoolBase.java:364)
	at com.zaxxer.hikari.pool.PoolBase.newPoolEntry(PoolBase.java:206)
	at com.zaxxer.hikari.pool.HikariPool.createPoolEntry(HikariPool.java:476)
	at com.zaxxer.hikari.pool.HikariPool.checkFailFast(HikariPool.java:561)
	at com.zaxxer.hikari.pool.HikariPool.<init>(HikariPool.java:115)
	at com.zaxxer.hikari.HikariDataSource.getConnection(HikariDataSource.java:112)
	at org.apache.shardingsphere.infra.database.type.DatabaseTypeRecognizer.getDatabaseType(DatabaseTypeRecognizer.java:53)
	at org.apache.shardingsphere.infra.database.type.DatabaseTypeRecognizer.getDatabaseType(DatabaseTypeRecognizer.java:44)
	at org.apache.shardingsphere.infra.rule.builder.schema.SchemaRulesBuilder.buildRules(SchemaRulesBuilder.java:69)
	at org.apache.shardingsphere.mode.manager.standalone.StandaloneContextManagerBuilder.build(StandaloneContextManagerBuilder.java:76)
	at org.apache.shardingsphere.driver.jdbc.core.datasource.ShardingSphereDataSource.createContextManager(ShardingSphereDataSource.java:75)
	at org.apache.shardingsphere.driver.jdbc.core.datasource.ShardingSphereDataSource.<init>(ShardingSphereDataSource.java:61)
	at org.apache.shardingsphere.driver.api.ShardingSphereDataSourceFactory.createDataSource(ShardingSphereDataSourceFactory.java:79)
	at org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration.shardingSphereDataSource(ShardingSphereAutoConfiguration.java:93)
	at org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$65b678bd.CGLIB$shardingSphereDataSource$3(<generated>)
	at org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$65b678bd$$FastClassBySpringCGLIB$$e37231fb.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331)
	at org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$65b678bd.shardingSphereDataSource(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:653)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:638)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:887)
	at org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:791)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:541)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1519)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1417)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:544)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:544)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:213)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.resolveBeanByName(AbstractAutowireCapableBeanFactory.java:479)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.autowireResource(CommonAnnotationBeanPostProcessor.java:550)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:520)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$ResourceElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:673)
	at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:228)
	at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:119)
	at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessProperties(CommonAnnotationBeanPostProcessor.java:329)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1431)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:619)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:920)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:583)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:731)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:408)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:307)
	at org.springframework.boot.test.context.SpringBootContextLoader.loadContext(SpringBootContextLoader.java:136)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContextInternal(DefaultCacheAwareContextLoaderDelegate.java:141)
	at org.springframework.test.context.cache.DefaultCacheAwareContextLoaderDelegate.loadContext(DefaultCacheAwareContextLoaderDelegate.java:90)
	at org.springframework.test.context.support.DefaultTestContext.getApplicationContext(DefaultTestContext.java:124)
	at org.springframework.test.context.web.ServletTestExecutionListener.setUpRequestContextIfNecessary(ServletTestExecutionListener.java:190)
	at org.springframework.test.context.web.ServletTestExecutionListener.prepareTestInstance(ServletTestExecutionListener.java:132)
	at org.springframework.test.context.TestContextManager.prepareTestInstance(TestContextManager.java:248)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.createTest(SpringJUnit4ClassRunner.java:227)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner$1.runReflectiveCall(SpringJUnit4ClassRunner.java:289)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.methodBlock(SpringJUnit4ClassRunner.java:291)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:246)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:89)
	at com.mysql.cj.NativeSession.connect(NativeSession.java:144)
	at com.mysql.cj.jdbc.ConnectionImpl.connectWithRetries(ConnectionImpl.java:850)
	... 146 common frames omitted
Caused by: java.net.ConnectException: Connection timed out: connect
	at java.net.DualStackPlainSocketImpl.waitForConnect(Native Method)
	at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:85)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at com.mysql.cj.protocol.StandardSocketFactory.connect(StandardSocketFactory.java:155)
	at com.mysql.cj.protocol.a.NativeSocketConnection.connect(NativeSocketConnection.java:63)
	... 148 common frames omitted
24-09-03.20:10:27.114 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.20:10:50.465 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.20:10:50.684 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.20:10:50.945 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.20:10:54.471 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.20:10:55.150 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:10:55.338 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:10:58.852 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.20:10:58.871 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.20:10:58.871 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.20:10:58.872 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.20:10:58.873 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.20:10:58.873 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.20:10:58.873 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.20:10:58.873 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@35b5056e
24-09-03.20:10:59.041 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.20:10:59.188 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.20:10:59.375 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6b71fded:0/SimpleConnection@649a76c1 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 65442]
24-09-03.20:10:59.745 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.20:10:59.745 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.20:10:59.765 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 105.287 seconds (JVM running for 106.874)
24-09-03.20:11:00.016 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.20:11:00.065 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.20:11:00.132 [main            ] INFO  RaffleStrategyController - 查询抽奖奖品列表配开始 userId:lyt activityId:101
24-09-03.20:11:00.982 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.20:11:00.982 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id
        from raffle_activity where activity_id = ?;
24-09-03.20:11:00.982 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:11:00.982 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@68f74ea1], lock=Optional.empty, window=Optional.empty)
24-09-03.20:11:00.982 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.20:11:00.982 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.20:11:00.982 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.20:11:01.123 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort,
               rule_models
        from strategy_award
        where strategy_id = ?
24-09-03.20:11:01.123 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:11:01.123 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort,
               rule_models
        from strategy_award
        where strategy_id = ? ::: [100004]
24-09-03.20:11:01.251 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            tree_id,
            rule_value
        from rule_tree_node
        where rule_key = 'rule_lock' and tree_id in
         (  
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         )
24-09-03.20:11:01.251 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:11:01.251 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            tree_id,
            rule_value
        from rule_tree_node
        where rule_key = 'rule_lock' and tree_id in
         (  
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         ) ::: [tree_lock, tree_lock, tree_lock, tree_lock, tree_lock]
24-09-03.20:11:01.401 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select day_count - day_count_surplus
        from raffle_activity_account_day
        where user_id = ?
          and activity_id = ?
          and `day` = ?;
24-09-03.20:11:01.401 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:11:01.401 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select day_count - day_count_surplus
        from raffle_activity_account_day_0
        where user_id = ?
          and activity_id = ?
          and `day` = ?; ::: [lyt, 101, 2024-09-03]
24-09-03.20:11:01.737 [main            ] INFO  RaffleStrategyController - 查询抽奖奖品列表配置完成 userId:lyt activityId:101 response: {"code":"0000","data":[{"awardId":100,"awardRuleLockCount":8,"awardTitle":"随机积分","isAwardUnlock":false,"sort":1,"waitUnlockCount":8},{"awardId":101,"awardRuleLockCount":8,"awardTitle":"10000积分","isAwardUnlock":false,"sort":2,"waitUnlockCount":8},{"awardId":102,"awardRuleLockCount":8,"awardTitle":"公仔一只","isAwardUnlock":false,"sort":3,"waitUnlockCount":8},{"awardId":103,"awardRuleLockCount":8,"awardTitle":"台灯一个","isAwardUnlock":false,"sort":4,"waitUnlockCount":8},{"awardId":104,"awardRuleLockCount":8,"awardTitle":"增加5次抽奖机会","isAwardUnlock":false,"sort":5,"waitUnlockCount":8}],"info":"成功"}
24-09-03.20:11:01.742 [main            ] INFO  RaffleStrategyControllerTest - 请求参数：{"activityId":101,"userId":"lyt"}
24-09-03.20:11:01.746 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":100,"awardRuleLockCount":8,"awardTitle":"随机积分","isAwardUnlock":false,"sort":1,"waitUnlockCount":8},{"awardId":101,"awardRuleLockCount":8,"awardTitle":"10000积分","isAwardUnlock":false,"sort":2,"waitUnlockCount":8},{"awardId":102,"awardRuleLockCount":8,"awardTitle":"公仔一只","isAwardUnlock":false,"sort":3,"waitUnlockCount":8},{"awardId":103,"awardRuleLockCount":8,"awardTitle":"台灯一个","isAwardUnlock":false,"sort":4,"waitUnlockCount":8},{"awardId":104,"awardRuleLockCount":8,"awardTitle":"增加5次抽奖机会","isAwardUnlock":false,"sort":5,"waitUnlockCount":8}],"info":"成功"}
24-09-03.20:11:01.785 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:11:01.806 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:11:01.806 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:11:02.675 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:11:02.796 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:11:02.798 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.20:11:02.798 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.20:11:02.798 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:11:02.798 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.20:11:02.799 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:11:02.801 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:11:02.907 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.20:11:02.915 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.20:11:02.915 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.20:11:02.920 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.20:14:38.185 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 33344 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.20:14:38.186 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
24-09-03.20:14:40.060 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.20:14:40.067 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.20:14:40.182 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 73 ms. Found 0 Redis repository interfaces.
24-09-03.20:14:40.855 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:14:40.875 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:14:41.223 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$21444c8e] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:14:42.495 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.20:14:43.660 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.20:14:43.679 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.20:14:43.990 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.20:14:46.462 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.20:14:47.068 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:14:47.218 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:14:50.214 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.20:14:50.229 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.20:14:50.229 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.20:14:50.231 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.20:14:50.231 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.20:14:50.231 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.20:14:50.231 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.20:14:50.231 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@2026af0
24-09-03.20:14:50.400 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.20:14:50.528 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.20:14:50.693 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4823f3b8:0/SimpleConnection@20f1c8ed [delegate=amqp://admin@8.138.41.137:5672/, localPort= 49700]
24-09-03.20:14:50.980 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.20:14:50.980 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.20:14:50.999 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 13.335 seconds (JVM running for 14.55)
24-09-03.20:14:51.293 [main            ] INFO  RaffleStrategyController - 查询抽奖奖品列表配开始 userId:lyt activityId:101
24-09-03.20:14:52.131 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id
        from raffle_activity where activity_id = ?;
24-09-03.20:14:52.131 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:14:52.131 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.20:14:52.407 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            tree_id,
            rule_value
        from rule_tree_node
        where rule_key = 'rule_lock' and tree_id in
         (  
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         )
24-09-03.20:14:52.407 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:14:52.408 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            tree_id,
            rule_value
        from rule_tree_node
        where rule_key = 'rule_lock' and tree_id in
         (  
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         , 
            ?
         ) ::: [tree_lock, tree_lock, tree_lock, tree_lock, tree_lock]
24-09-03.20:14:52.585 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select day_count - day_count_surplus
        from raffle_activity_account_day
        where user_id = ?
          and activity_id = ?
          and `day` = ?;
24-09-03.20:14:52.585 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:14:52.585 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select day_count - day_count_surplus
        from raffle_activity_account_day_0
        where user_id = ?
          and activity_id = ?
          and `day` = ?; ::: [lyt, 101, 2024-09-03]
24-09-03.20:14:52.902 [main            ] INFO  RaffleStrategyController - 查询抽奖奖品列表配置完成 userId:lyt activityId:101 response: {"code":"0000","data":[{"awardId":100,"awardRuleLockCount":8,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":101,"awardRuleLockCount":8,"awardTitle":"10000积分","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":102,"awardRuleLockCount":8,"awardTitle":"公仔一只","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":103,"awardRuleLockCount":8,"awardTitle":"台灯一个","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":104,"awardRuleLockCount":8,"awardTitle":"增加5次抽奖机会","isAwardUnlock":true,"sort":5,"waitUnlockCount":0}],"info":"成功"}
24-09-03.20:14:52.908 [main            ] INFO  RaffleStrategyControllerTest - 请求参数：{"activityId":101,"userId":"lyt"}
24-09-03.20:14:52.911 [main            ] INFO  RaffleStrategyControllerTest - 测试结果：{"code":"0000","data":[{"awardId":100,"awardRuleLockCount":8,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":101,"awardRuleLockCount":8,"awardTitle":"10000积分","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":102,"awardRuleLockCount":8,"awardTitle":"公仔一只","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":103,"awardRuleLockCount":8,"awardTitle":"台灯一个","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":104,"awardRuleLockCount":8,"awardTitle":"增加5次抽奖机会","isAwardUnlock":true,"sort":5,"waitUnlockCount":0}],"info":"成功"}
24-09-03.20:14:52.944 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:14:52.963 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:14:52.963 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:14:53.027 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:14:53.940 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:14:53.942 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.20:14:53.942 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.20:14:53.942 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:14:53.943 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.20:14:53.945 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:14:53.945 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:14:54.018 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.20:14:54.027 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.20:14:54.027 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.20:14:54.035 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.20:34:49.126 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 42060 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.20:34:49.127 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
24-09-03.20:34:50.870 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.20:34:50.877 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.20:34:50.969 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 64 ms. Found 0 Redis repository interfaces.
24-09-03.20:34:51.542 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:34:51.558 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:34:51.838 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$7c0b4d66] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:34:52.802 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.20:34:53.903 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.20:34:53.917 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.20:34:54.156 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.20:34:56.567 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.20:34:57.136 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:34:57.288 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:35:00.205 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.20:35:00.221 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.20:35:00.221 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.20:35:00.223 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.20:35:00.223 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.20:35:00.223 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.20:35:00.223 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.20:35:00.223 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@53a20aab
24-09-03.20:35:00.386 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.20:35:00.507 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.20:35:00.683 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#78395e28:0/SimpleConnection@4a0b1701 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 50242]
24-09-03.20:35:01.041 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.20:35:01.042 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.20:35:01.062 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 12.462 seconds (JVM running for 13.629)
24-09-03.20:35:01.332 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 activityId:101
24-09-03.20:35:02.118 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus
        from raffle_activity_sku where activity_id = ?;
24-09-03.20:35:02.119 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:35:02.119 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus
        from raffle_activity_sku where activity_id = ?; ::: [101]
24-09-03.20:35:02.332 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.20:35:02.332 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:35:02.332 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.20:35:02.437 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.20:35:02.437 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:35:02.437 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.20:35:02.489 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id
        from raffle_activity where activity_id = ?;
24-09-03.20:35:02.489 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:35:02.489 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.20:35:02.556 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort,
               rule_models
        from strategy_award
        where strategy_id = ?
24-09-03.20:35:02.556 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:35:02.556 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort,
               rule_models
        from strategy_award
        where strategy_id = ? ::: [100004]
24-09-03.20:35:02.877 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            id,
            strategy_id,
            strategy_desc,
            rule_models,
            create_time,
            update_time
        from strategy
        where strategy_id = ?
24-09-03.20:35:02.877 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:35:02.877 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            id,
            strategy_id,
            strategy_desc,
            rule_models,
            create_time,
            update_time
        from strategy
        where strategy_id = ? ::: [100004]
24-09-03.20:35:02.919 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，完成 activityId:101
24-09-03.20:35:03.100 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":true,"info":"成功"}
24-09-03.20:35:03.137 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:35:03.160 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:35:03.160 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:35:03.972 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:35:04.077 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:35:04.079 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.20:35:04.079 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.20:35:04.079 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:35:04.079 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.20:35:04.081 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:35:04.081 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:35:04.151 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.20:35:04.159 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.20:35:04.160 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.20:35:04.166 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.20:36:54.444 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 17776 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.20:36:54.446 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
24-09-03.20:36:56.080 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.20:36:56.085 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.20:36:56.172 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 61 ms. Found 0 Redis repository interfaces.
24-09-03.20:36:56.765 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:36:56.783 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:36:57.056 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$b5a30c43] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:36:57.981 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.20:36:59.076 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.20:36:59.088 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.20:36:59.326 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.20:37:01.566 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.20:37:02.118 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:37:02.268 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:37:05.123 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.20:37:05.137 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.20:37:05.138 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.20:37:05.138 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.20:37:05.139 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.20:37:05.139 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.20:37:05.139 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.20:37:05.139 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@7b4e5982
24-09-03.20:37:05.291 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.20:37:05.401 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.20:37:05.584 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#3a5e591b:0/SimpleConnection@1b0e81b3 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 50380]
24-09-03.20:37:05.864 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.20:37:05.864 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.20:37:05.880 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 11.933 seconds (JVM running for 13.17)
24-09-03.20:37:06.127 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，开始 activityId:101
24-09-03.20:37:06.912 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus
        from raffle_activity_sku where activity_id = ?;
24-09-03.20:37:06.912 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:37:06.912 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus
        from raffle_activity_sku where activity_id = ?; ::: [101]
24-09-03.20:37:07.106 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.20:37:07.106 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:37:07.106 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.20:37:07.216 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.20:37:07.216 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:37:07.216 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.20:37:07.271 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id
        from raffle_activity where activity_id = ?;
24-09-03.20:37:07.271 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:37:07.271 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.20:37:07.314 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort,
               rule_models
        from strategy_award
        where strategy_id = ?
24-09-03.20:37:07.314 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:37:07.314 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort,
               rule_models
        from strategy_award
        where strategy_id = ? ::: [100004]
24-09-03.20:37:07.607 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            id,
            strategy_id,
            strategy_desc,
            rule_models,
            create_time,
            update_time
        from strategy
        where strategy_id = ?
24-09-03.20:37:07.607 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:37:07.607 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            id,
            strategy_id,
            strategy_desc,
            rule_models,
            create_time,
            update_time
        from strategy
        where strategy_id = ? ::: [100004]
24-09-03.20:37:07.650 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，完成 activityId:101
24-09-03.20:37:07.828 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":true,"info":"成功"}
24-09-03.20:37:07.861 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:37:07.879 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:37:07.879 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:37:07.900 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:37:08.812 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:37:08.814 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.20:37:08.814 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.20:37:08.814 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:37:08.814 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.20:37:08.816 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:37:08.816 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:37:08.888 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.20:37:08.899 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.20:37:08.899 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.20:37:08.906 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.20:38:05.867 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 34204 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.20:38:05.868 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
24-09-03.20:38:07.659 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.20:38:07.668 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.20:38:07.760 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 64 ms. Found 0 Redis repository interfaces.
24-09-03.20:38:08.440 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:38:08.456 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:38:08.744 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$fa1a9ebd] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.20:38:09.753 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.20:38:12.466 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.20:38:12.481 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.20:38:12.727 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.20:38:15.179 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.20:38:15.884 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:38:16.047 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.20:38:19.349 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.20:38:19.387 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.20:38:19.387 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.20:38:19.388 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.20:38:19.388 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.20:38:19.389 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.20:38:19.389 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.20:38:19.389 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@717c00f9
24-09-03.20:38:19.553 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.20:38:19.668 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.20:38:19.853 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#48ebcce5:0/SimpleConnection@3af4b14e [delegate=amqp://admin@8.138.41.137:5672/, localPort= 50490]
24-09-03.20:38:20.195 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.20:38:20.195 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.20:38:20.212 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 14.882 seconds (JVM running for 16.188)
24-09-03.20:38:20.536 [main            ] INFO  RaffleActivityController - 活动抽奖 userId:lyt activityId:101
24-09-03.20:38:21.641 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select activity_name,
               strategy_id,
               order_id,
               order_time,
               order_state
        from user_raffle_order where activity_id = ? and user_id = ? and order_state = 'create'
24-09-03.20:38:21.641 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:21.641 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select activity_name,
               strategy_id,
               order_id,
               order_time,
               order_state
        from user_raffle_order_0 where activity_id = ? and user_id = ? and order_state = 'create' ::: [101, lyt]
24-09-03.20:38:21.772 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select total_count,
               total_count_surplus,
               day_count,
               day_count_surplus,
               month_count,
               month_count_surplus
        from raffle_activity_account where user_id = ? and activity_id = ?
24-09-03.20:38:21.772 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:21.772 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select total_count,
               total_count_surplus,
               day_count,
               day_count_surplus,
               month_count,
               month_count_surplus
        from raffle_activity_account_0 where user_id = ? and activity_id = ? ::: [lyt, 101]
24-09-03.20:38:21.813 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select user_id,
               activity_id,
               `month`,
               month_count,
               month_count_surplus
        from raffle_activity_account_month
        where user_id = ?
          and activity_id = ?
          and `month` = ?;
24-09-03.20:38:21.813 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:21.813 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select user_id,
               activity_id,
               `month`,
               month_count,
               month_count_surplus
        from raffle_activity_account_month_0
        where user_id = ?
          and activity_id = ?
          and `month` = ?; ::: [lyt, 101, 2024-09]
24-09-03.20:38:21.845 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select user_id,
               activity_id,
               `day`,
               day_count,
               day_count_surplus
        from raffle_activity_account_day
        where user_id = ?
          and activity_id = ?
          and `day` = ?;
24-09-03.20:38:21.845 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:21.845 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select user_id,
               activity_id,
               `day`,
               day_count,
               day_count_surplus
        from raffle_activity_account_day_0
        where user_id = ?
          and activity_id = ?
          and `day` = ?; ::: [lyt, 101, 2024-09-03]
24-09-03.20:38:21.958 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183094844766
24-09-03.20:38:21.998 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_account set total_count_surplus = total_count_surplus - 1,
                                           day_count_surplus = day_count_surplus - 1,
                                           month_count_surplus = month_count_surplus - 1, update_time = now()
        where user_id = ? and activity_id = ?
        and total_count_surplus > 0 and day_count_surplus > 0 and month_count_surplus > 0;
24-09-03.20:38:21.999 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.20:38:21.999 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update raffle_activity_account_0 set total_count_surplus = total_count_surplus - 1,
                                           day_count_surplus = day_count_surplus - 1,
                                           month_count_surplus = month_count_surplus - 1, update_time = now()
        where user_id = ? and activity_id = ?
        and total_count_surplus > 0 and day_count_surplus > 0 and month_count_surplus > 0; ::: [lyt, 101]
24-09-03.20:38:22.059 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_account_month
        set month_count_surplus = month_count_surplus - 1,update_time = now()
        where user_id = ? and activity_id = ?
        and `month` = ? and month_count_surplus > 0
24-09-03.20:38:22.059 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.20:38:22.059 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update raffle_activity_account_month_0
        set month_count_surplus = month_count_surplus - 1,update_time = now()
        where user_id = ? and activity_id = ?
        and `month` = ? and month_count_surplus > 0 ::: [lyt, 101, 2024-09]
24-09-03.20:38:22.105 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_account_day
        set day_count_surplus = day_count_surplus - 1, update_time = now()
        where user_id = ? and activity_id = ? and day = ? and day_count_surplus > 0
24-09-03.20:38:22.105 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.20:38:22.105 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update raffle_activity_account_day_0
        set day_count_surplus = day_count_surplus - 1, update_time = now()
        where user_id = ? and activity_id = ? and day = ? and day_count_surplus > 0 ::: [lyt, 101, 2024-09-03]
24-09-03.20:38:22.158 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_raffle_order(
            user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state, create_time, update_time
        )
        values(
                  ?, ?, ?, ?, ?, ?, ?, now(), now()
              )
24-09-03.20:38:22.158 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-09-03.20:38:22.158 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_raffle_order_0(
            user_id, activity_id, activity_name, strategy_id, order_id, order_time, order_state, create_time, update_time
        , id)
        values(?, ?, ?, ?, ?, ?, ?, now(), now(), ?) ::: [lyt, 101, 测试, 100004, 183094844766, 2024-09-03 20:38:20.541, create, 1037828105039228928]
24-09-03.20:38:22.242 [main            ] INFO  RaffleActivityController - 活动抽奖，创建订单 userId:lyt activityId:101 orderId:183094844766
24-09-03.20:38:22.356 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userId: lyt strategyId: 100004 ruleModel: rule_default awardId: 100
24-09-03.20:38:22.365 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select rule_models
        from strategy_award
        where strategy_id = ?
          and award_id = ?
24-09-03.20:38:22.365 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.365 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select rule_models
        from strategy_award
        where strategy_id = ?
          and award_id = ? ::: [100004, 100]
24-09-03.20:38:22.446 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            tree_id,
            tree_name,
            tree_desc,
            tree_root_rule_key
        from rule_tree
        where tree_id = ?;
24-09-03.20:38:22.446 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.446 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            tree_id,
            tree_name,
            tree_desc,
            tree_root_rule_key
        from rule_tree
        where tree_id = ?; ::: [tree_lock]
24-09-03.20:38:22.466 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            tree_id,
            rule_key,
            rule_desc,
            rule_value
        from rule_tree_node
        where tree_id = ?;
24-09-03.20:38:22.466 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.467 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            tree_id,
            rule_key,
            rule_desc,
            rule_value
        from rule_tree_node
        where tree_id = ?; ::: [tree_lock]
24-09-03.20:38:22.488 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select
            tree_id,
            rule_node_from,
            rule_node_to,
            rule_limit_type,
            rule_limit_value
        from rule_tree_node_line
        where tree_id = ?;
24-09-03.20:38:22.488 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.488 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select
            tree_id,
            rule_node_from,
            rule_node_to,
            rule_limit_type,
            rule_limit_value
        from rule_tree_node_line
        where tree_id = ?; ::: [tree_lock]
24-09-03.20:38:22.555 [main            ] INFO  RuleLockLogicTreeNode  - 规则过滤-次数锁 userId:lyt strategyId:100004 awardId:100
24-09-03.20:38:22.557 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select activity_id
        from raffle_activity where strategy_id = ?;
24-09-03.20:38:22.557 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.557 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select activity_id
        from raffle_activity where strategy_id = ?; ::: [100004]
24-09-03.20:38:22.577 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select user_id,
               activity_id,
               `day`,
               day_count,
               day_count_surplus
        from raffle_activity_account_day
        where user_id = ?
          and activity_id = ?
          and `day` = ?;
24-09-03.20:38:22.577 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.577 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select user_id,
               activity_id,
               `day`,
               day_count,
               day_count_surplus
        from raffle_activity_account_day_0
        where user_id = ?
          and activity_id = ?
          and `day` = ?; ::: [lyt, 101, 2024-09-03]
24-09-03.20:38:22.598 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock node:rule_lock code:0000
24-09-03.20:38:22.599 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:lyt strategyId:100004 awardId:100
24-09-03.20:38:22.637 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId:lyt strategyId:100004 awardId:100
24-09-03.20:38:22.701 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树】treeId:tree_lock node:rule_stock code:0001
24-09-03.20:38:22.701 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 lyt 100004 100 null
24-09-03.20:38:22.722 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort
        from strategy_award
        where strategy_id = ?
        and award_id = ?
24-09-03.20:38:22.722 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.20:38:22.722 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select strategy_id,
               award_id,
               award_title,
               award_subtitle,
               award_count,
               award_count_surplus,
               award_rate,
               sort
        from strategy_award
        where strategy_id = ?
        and award_id = ? ::: [100004, 100]
24-09-03.20:38:22.770 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309484510
24-09-03.20:38:22.991 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-09-03.20:38:22.991 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-09-03.20:38:22.991 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 101, 100004, 183094844766, 100, 随机积分, 2024-09-03 20:38:22.768, create, 1037828108507918337]
24-09-03.20:38:23.060 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-09-03.20:38:23.061 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-09-03.20:38:23.061 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":100,"awardTitle":"随机积分","userId":"lyt"},"id":"18309484510","timeStamp":"2024-09-03 20:38:22.77"}, 18309484510, create, 1037828108793131008]
24-09-03.20:38:23.117 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update user_raffle_order set order_state = 'used',update_time = now()
                                              where user_id = ? and order_id = ? and order_state = 'create';
24-09-03.20:38:23.117 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.20:38:23.117 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update user_raffle_order_0 set order_state = 'used',update_time = now()
                                              where user_id = ? and order_id = ? and order_state = 'create'; ::: [lyt, 183094844766]
24-09-03.20:38:23.240 [main            ] INFO  RaffleActivityControllerTest - 请求参数：{"activityId":101,"userId":"lyt"}
24-09-03.20:38:23.245 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":{"awardId":100,"awardIndex":1,"awardTitle":"随机积分"},"info":"成功"}
24-09-03.20:38:23.261 [pool-7-thread-1 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":100,"awardTitle":"随机积分","userId":"lyt"},"id":"18309484510","timeStamp":"2024-09-03 20:38:22.77"}
24-09-03.20:38:23.264 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-09-03.20:38:23.264 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.20:38:23.264 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18309484510]
24-09-03.20:38:23.264 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18309484510]
24-09-03.20:38:23.271 [pool-7-thread-1 ] ERROR AwardRepository        - 写入中奖记录，发送MQ消息失败 userId:lyt topic:send_award
24-09-03.20:38:23.273 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?;
24-09-03.20:38:23.273 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.20:38:23.273 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18309484510]
24-09-03.20:38:23.273 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18309484510]
24-09-03.20:38:23.284 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:38:23.293 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":100,"awardTitle":"随机积分","userId":"lyt"},"id":"18309484510","timeStamp":"2024-09-03 20:38:22.77"}
24-09-03.20:38:23.305 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:38:23.305 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.20:38:23.329 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:38:24.142 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.20:38:24.144 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.20:38:24.144 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.20:38:24.144 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.20:38:24.145 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.20:38:24.146 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:38:24.147 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.20:38:24.235 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.20:38:24.242 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.20:38:24.242 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.20:38:24.249 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:02:39.545 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 42700 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:02:39.545 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:02:41.295 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:02:41.303 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:02:41.389 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 59 ms. Found 0 Redis repository interfaces.
24-09-03.21:02:41.992 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:02:42.009 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:02:42.290 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$fa1a9ebd] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:02:43.284 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:02:44.403 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:02:44.417 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:02:44.659 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:02:47.004 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:02:47.596 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:02:47.753 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:02:50.860 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:02:50.876 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:02:50.876 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:02:50.877 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:02:50.877 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:02:50.877 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:02:50.877 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:02:50.877 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@d7d984c
24-09-03.21:02:51.046 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:02:51.179 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:02:51.357 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#11f6a083:0/SimpleConnection@1fb320de [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51215]
24-09-03.21:02:51.696 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:02:51.696 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:02:51.713 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.69 seconds (JVM running for 13.906)
24-09-03.21:02:52.863 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:02:52.863 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:02:52.863 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:02:53.131 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:02:53.219 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095461858
24-09-03.21:02:53.283 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:53.283 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:53.323 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:53.387 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:53.387 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095461928
24-09-03.21:02:53.445 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:53.445 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:53.484 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:53.503 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:53.503 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095461977
24-09-03.21:02:53.560 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:53.560 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:53.599 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:53.619 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:53.620 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462026
24-09-03.21:02:53.676 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:53.676 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:53.715 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:53.733 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:53.733 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462073
24-09-03.21:02:53.791 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:53.791 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:53.829 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:53.849 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:53.850 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462122
24-09-03.21:02:53.906 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:53.906 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:53.944 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:53.963 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:53.963 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462170
24-09-03.21:02:54.020 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.020 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.057 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.076 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.077 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462218
24-09-03.21:02:54.134 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.135 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.171 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.191 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.192 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462266
24-09-03.21:02:54.248 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.248 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.288 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.308 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.308 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462315
24-09-03.21:02:54.366 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.366 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.405 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.424 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.424 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462363
24-09-03.21:02:54.481 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.481 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.519 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.538 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.539 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462411
24-09-03.21:02:54.597 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.597 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.634 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.652 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.653 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462459
24-09-03.21:02:54.709 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.709 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.746 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.766 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.767 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462507
24-09-03.21:02:54.823 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.823 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.861 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.880 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.880 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462554
24-09-03.21:02:54.937 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:54.937 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:54.975 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:54.995 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:54.995 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462603
24-09-03.21:02:55.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:02:55.048 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:02:55.048 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:02:55.048 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:02:55.053 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:55.054 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:55.099 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:55.118 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:55.118 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462654
24-09-03.21:02:55.121 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:02:55.177 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:55.178 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:55.220 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:55.227 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:02:55.228 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7d508a8], lock=Optional.empty, window=Optional.empty)
24-09-03.21:02:55.228 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:02:55.228 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:02:55.240 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:55.240 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462705
24-09-03.21:02:55.300 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:55.300 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:55.339 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:55.359 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:55.359 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462755
24-09-03.21:02:55.416 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:55.417 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:55.455 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:02:55.475 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:55.476 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095462804
24-09-03.21:02:55.541 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:02:55.541 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:02:55.565 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309546284
24-09-03.21:02:55.799 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309546284","timeStamp":"2024-09-03 21:02:55.565"}
24-09-03.21:02:55.799 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:02:55.832 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309546284","timeStamp":"2024-09-03 21:02:55.565"}
24-09-03.21:02:55.879 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:02:55.879 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:02:55.880 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:03:00.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:00.008 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:03:00.008 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7d508a8], lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:00.008 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:00.008 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:00.026 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:00.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:00.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:00.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:05.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:05.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:05.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:05.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:05.071 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:05.092 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:03:05.092 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7d508a8], lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:05.092 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:05.092 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:10.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:10.023 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:10.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:10.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:10.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:10.143 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:03:10.143 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7d508a8], lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:10.143 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:10.143 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:15.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:15.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:15.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:15.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:03:15.079 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:03:15.080 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:03:15.080 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7d508a8], lock=Optional.empty, window=Optional.empty)
24-09-03.21:03:15.080 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:15.080 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:03:17.410 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:03:17.433 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:03:17.433 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:03:17.915 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:03:18.191 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:03:18.193 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:03:18.193 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:03:18.193 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:03:18.194 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:03:18.195 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:03:18.196 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:03:18.286 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:03:18.295 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:03:18.295 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:03:18.301 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:04:13.016 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 16220 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:04:13.017 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:04:14.670 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:04:14.678 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:04:14.768 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 60 ms. Found 0 Redis repository interfaces.
24-09-03.21:04:15.375 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:04:15.391 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:04:15.677 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$9a4071bb] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:04:16.616 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:04:17.740 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:04:17.759 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:04:18.010 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:04:20.377 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:04:20.956 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:04:21.121 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:04:24.202 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:04:24.218 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:04:24.218 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:04:24.219 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:04:24.220 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:04:24.220 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:04:24.220 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:04:24.220 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@8dba70a
24-09-03.21:04:24.381 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:04:24.503 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:04:24.663 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#3f8090db:0/SimpleConnection@2dc0cbbc [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51321]
24-09-03.21:04:24.942 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:04:24.943 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:04:24.961 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.478 seconds (JVM running for 13.726)
24-09-03.21:04:25.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:04:32.342 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:04:32.419 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095503465
24-09-03.21:04:32.506 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:32.507 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:32.560 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:32.560 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095503524
24-09-03.21:04:32.623 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:32.623 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:32.668 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:32.669 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095503570
24-09-03.21:04:32.737 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:32.737 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:32.782 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:32.782 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095503618
24-09-03.21:04:32.857 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:32.857 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:32.865 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:04:32.865 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:04:32.865 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:04:32.865 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:04:32.865 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:04:32.865 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:04:32.865 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:04:32.922 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:32.922 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095503676
24-09-03.21:04:32.980 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:32.981 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:37.141 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:04:37.141 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:04:37.142 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:04:42.905 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:42.905 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095507863
24-09-03.21:04:46.660 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:04:46.690 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:04:46.690 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:04:46.690 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:04:46.690 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:04:47.792 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:47.792 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:47.834 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:47.834 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095509931
24-09-03.21:04:47.892 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:47.893 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:47.935 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:47.935 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095509973
24-09-03.21:04:47.993 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:47.993 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.033 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.033 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510014
24-09-03.21:04:48.092 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.093 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.132 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.133 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510056
24-09-03.21:04:48.190 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.190 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.231 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.231 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510097
24-09-03.21:04:48.288 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.288 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.328 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.328 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510138
24-09-03.21:04:48.386 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.386 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.427 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.427 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510180
24-09-03.21:04:48.485 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.485 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.525 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.526 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510221
24-09-03.21:04:48.583 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.583 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.623 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.623 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510262
24-09-03.21:04:48.681 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.681 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.720 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.720 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510302
24-09-03.21:04:48.781 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.781 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.821 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.821 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510345
24-09-03.21:04:48.881 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.881 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:48.922 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:48.922 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510387
24-09-03.21:04:48.979 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:48.979 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:49.019 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:49.020 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510428
24-09-03.21:04:49.076 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:49.076 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:49.117 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:49.117 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095510469
24-09-03.21:04:49.174 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:04:49.174 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:04:49.213 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:04:50.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:04:50.029 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:15.412 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:15.412 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:15.412 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:15.412 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:15.412 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:15.412 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:15.412 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:15.469 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:15.491 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:15.491 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:15.491 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:15.491 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:20.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:20.028 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:20.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:20.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:20.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:20.029 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:20.029 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:20.029 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:20.029 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:25.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:25.016 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:25.016 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:25.016 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:25.016 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:25.034 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:25.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:25.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:25.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:30.013 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:30.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:30.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:30.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:30.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:30.033 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:30.034 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:30.034 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:30.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:35.011 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:35.032 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:35.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:35.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:35.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:35.098 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:35.098 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:35.098 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:35.098 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:40.009 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:40.010 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:40.010 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:40.010 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:40.067 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:40.068 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:40.068 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:40.068 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:40.070 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:45.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:45.033 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:05:45.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:45.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:45.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:05:45.095 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:05:45.095 [pool-7-thread-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@55d5c24c], lock=Optional.empty, window=Optional.empty)
24-09-03.21:05:45.095 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:45.095 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:05:45.306 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:05:45.329 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:05:45.329 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:05:45.649 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:05:45.649 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:05:45.652 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:05:45.652 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:05:45.652 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:05:45.653 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:05:45.655 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:05:45.655 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:05:45.720 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:05:45.728 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:05:45.728 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:05:45.735 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:05:48.927 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 41044 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:05:48.928 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:05:50.682 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:05:50.688 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:05:50.772 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 57 ms. Found 0 Redis repository interfaces.
24-09-03.21:05:51.447 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:05:51.465 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:05:51.750 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$9a65e2a8] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:05:52.807 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:05:53.943 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:05:53.957 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:05:54.205 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:05:56.693 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:05:57.282 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:05:57.437 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:06:00.467 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:06:00.482 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:06:00.482 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:06:00.483 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:06:00.484 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:06:00.484 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:06:00.484 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:06:00.484 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@67a6f2c4
24-09-03.21:06:00.657 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:06:00.790 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:06:00.957 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#340ef431:0/SimpleConnection@7c9a39cb [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51429]
24-09-03.21:06:01.252 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:06:01.252 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:06:01.271 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.875 seconds (JVM running for 14.15)
24-09-03.21:06:01.740 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:06:01.802 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095540955
24-09-03.21:06:01.889 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:01.889 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:01.942 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:01.943 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541014
24-09-03.21:06:01.999 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:01.999 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.037 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.037 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541054
24-09-03.21:06:02.093 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.093 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.131 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.131 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541093
24-09-03.21:06:02.188 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.188 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.225 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.226 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541133
24-09-03.21:06:02.282 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.282 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.320 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.321 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541173
24-09-03.21:06:02.377 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.377 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.415 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.415 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541212
24-09-03.21:06:02.471 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.471 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.508 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.508 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541251
24-09-03.21:06:02.564 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.564 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.601 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.601 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541290
24-09-03.21:06:02.658 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.658 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.695 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.696 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541330
24-09-03.21:06:02.752 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.752 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.789 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.789 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541369
24-09-03.21:06:02.845 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.845 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.882 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.882 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541408
24-09-03.21:06:02.938 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:02.938 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:02.976 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:02.976 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541448
24-09-03.21:06:03.032 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.032 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.068 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.068 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541486
24-09-03.21:06:03.123 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.125 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.162 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.162 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541526
24-09-03.21:06:03.218 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.218 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.256 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.257 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541566
24-09-03.21:06:03.312 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.312 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.351 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.352 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541605
24-09-03.21:06:03.407 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.407 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.445 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.445 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541644
24-09-03.21:06:03.500 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.500 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.537 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.538 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541683
24-09-03.21:06:03.592 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.593 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.646 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:03.646 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095541729
24-09-03.21:06:03.701 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:06:03.701 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:06:03.738 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:06:05.002 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:05.880 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:05.880 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:06:05.880 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:05.880 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:05.880 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7e0692d1], lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:05.880 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:05.880 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:06.031 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:10.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:10.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:10.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:10.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:10.075 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:10.108 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:06:10.108 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7e0692d1], lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:10.108 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:10.108 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:15.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:15.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:15.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:15.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:15.066 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:15.066 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:06:15.066 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7e0692d1], lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:15.066 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:15.066 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:20.003 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:20.004 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:20.004 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:20.004 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:20.065 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:20.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:06:20.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7e0692d1], lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:20.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:20.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:25.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:25.026 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:25.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:25.027 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:06:25.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:25.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:25.027 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7e0692d1], lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:25.027 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:25.027 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:29.545 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:06:29.565 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:06:29.565 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:06:30.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:30.014 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:30.014 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:30.014 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:06:30.073 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:06:30.094 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:06:30.094 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7e0692d1], lock=Optional.empty, window=Optional.empty)
24-09-03.21:06:30.094 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:30.094 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:06:30.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:06:30.513 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:06:30.517 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:06:30.518 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:06:30.518 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:06:30.518 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:06:30.519 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:06:30.520 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:06:30.587 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:06:30.596 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:06:30.596 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:06:30.603 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:06:51.255 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 28996 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:06:51.257 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:06:54.479 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:06:54.486 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:06:54.575 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 65 ms. Found 0 Redis repository interfaces.
24-09-03.21:06:55.126 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:06:55.143 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:06:55.432 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$173fe03e] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:06:56.386 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:06:57.523 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:06:57.543 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:06:57.815 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:07:00.425 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:07:01.066 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:07:01.236 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:07:04.591 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:07:04.604 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:07:04.604 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:07:04.605 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:07:04.605 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:07:04.605 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:07:04.605 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:07:04.605 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@25c6f0fc
24-09-03.21:07:04.762 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:07:04.883 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:07:05.040 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#40f7fb45:0/SimpleConnection@56de370d [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51629]
24-09-03.21:07:05.357 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:07:05.357 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:07:05.379 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 15.093 seconds (JVM running for 16.566)
24-09-03.21:07:06.504 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:07:06.504 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:06.504 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:07:06.746 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:07:06.747 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:06.747 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:07:06.839 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:07:06.839 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:06.839 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:07:06.880 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:07:06.944 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095568278
24-09-03.21:07:07.057 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:07.057 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:07.103 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:10.999 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:16.666 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:16.666 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:16.666 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:17.728 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:19.917 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:07:19.917 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7cfdf986], lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:19.918 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:19.918 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:20.935 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:21.964 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:21.965 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:21.965 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:21.965 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:25.930 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:25.930 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095576241
24-09-03.21:07:25.947 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:25.948 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:07:25.948 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7cfdf986], lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:25.948 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:25.948 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:25.993 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:25.993 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:26.038 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:28.439 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:28.439 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577293
24-09-03.21:07:28.496 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:28.497 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:28.548 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:28.567 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:28.567 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577347
24-09-03.21:07:28.631 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:28.631 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:28.675 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:28.694 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:28.694 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577400
24-09-03.21:07:28.765 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:28.765 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:28.802 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:28.821 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:28.822 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577454
24-09-03.21:07:28.892 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:28.892 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:28.930 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:28.956 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:28.956 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577510
24-09-03.21:07:29.013 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.013 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.063 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.082 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.082 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577563
24-09-03.21:07:29.145 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.145 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.189 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.208 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.208 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577616
24-09-03.21:07:29.278 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.278 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.316 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.335 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.336 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577670
24-09-03.21:07:29.407 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.407 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.444 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.470 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.470 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577726
24-09-03.21:07:29.532 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.532 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.577 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.603 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.603 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577782
24-09-03.21:07:29.659 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.659 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.710 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.730 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.730 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577835
24-09-03.21:07:29.793 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.793 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.837 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.854 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.856 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577888
24-09-03.21:07:29.926 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:29.926 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:29.963 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:29.982 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:29.982 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577941
24-09-03.21:07:30.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:30.027 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:30.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:30.028 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:07:30.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:30.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:30.028 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7cfdf986], lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:30.028 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:30.028 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:30.052 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:30.052 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:30.090 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:30.115 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:30.116 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095577997
24-09-03.21:07:30.174 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:30.174 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:30.225 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:30.245 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:30.245 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095578051
24-09-03.21:07:30.309 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:30.309 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:30.362 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:30.382 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:30.382 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095578108
24-09-03.21:07:30.454 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:30.454 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:30.491 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:30.508 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:30.508 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095578161
24-09-03.21:07:30.580 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:30.580 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:30.625 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:07:30.651 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:30.651 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095578221
24-09-03.21:07:30.714 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:07:30.714 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:07:30.734 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309557825
24-09-03.21:07:30.957 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309557825","timeStamp":"2024-09-03 21:07:30.734"}
24-09-03.21:07:30.959 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:07:30.986 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309557825","timeStamp":"2024-09-03 21:07:30.734"}
24-09-03.21:07:31.024 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:07:31.024 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:07:31.024 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:07:35.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:35.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:35.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:35.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:35.072 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:35.093 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:07:35.093 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7cfdf986], lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:35.093 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:35.093 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:40.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:40.029 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:40.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:40.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:40.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:40.030 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:07:40.031 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7cfdf986], lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:40.031 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:40.031 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:45.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:45.027 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:07:45.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:45.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:45.028 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:07:45.092 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:07:45.092 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7cfdf986], lock=Optional.empty, window=Optional.empty)
24-09-03.21:07:45.093 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:45.093 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:07:48.971 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:07:48.990 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:07:48.990 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:07:49.303 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:07:49.547 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:07:49.550 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:07:49.550 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:07:49.550 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:07:49.551 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:07:49.553 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:07:49.553 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:07:49.641 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:07:49.650 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:07:49.650 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:07:49.658 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:08:59.679 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 42140 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:08:59.687 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:09:01.441 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:09:01.448 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:09:01.539 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 63 ms. Found 0 Redis repository interfaces.
24-09-03.21:09:02.172 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:09:02.190 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:09:02.483 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$abb58b3b] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:09:03.498 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:09:04.623 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:09:04.639 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:09:04.926 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:09:07.246 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:09:07.843 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:09:08.012 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:09:11.146 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:09:11.160 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:09:11.160 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:09:11.161 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:09:11.162 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:09:11.162 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:09:11.162 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:09:11.162 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@647dcc5e
24-09-03.21:09:11.322 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:09:11.450 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:09:11.635 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5c1dc4e9:0/SimpleConnection@21e5feb [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51744]
24-09-03.21:09:11.954 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:09:11.954 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:09:11.971 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.826 seconds (JVM running for 14.093)
24-09-03.21:09:13.102 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:09:13.102 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:13.102 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:09:13.373 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:09:13.373 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:13.373 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:09:13.448 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:09:13.448 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:13.448 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:09:13.505 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:09:13.567 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621387
24-09-03.21:09:13.677 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:13.677 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:13.723 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:13.788 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:13.788 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621480
24-09-03.21:09:13.855 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:13.855 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:13.893 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:13.912 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:13.912 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621532
24-09-03.21:09:13.977 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:13.977 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.016 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.040 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.040 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621586
24-09-03.21:09:14.101 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.101 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.143 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.166 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.166 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621639
24-09-03.21:09:14.222 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.223 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.267 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.287 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.287 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621689
24-09-03.21:09:14.348 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.349 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.390 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.410 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.410 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621741
24-09-03.21:09:14.473 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.474 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.511 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.531 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.531 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621792
24-09-03.21:09:14.597 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.597 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.635 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.658 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.658 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621845
24-09-03.21:09:14.717 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.717 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.758 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.782 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.782 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621897
24-09-03.21:09:14.838 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.838 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:14.882 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:14.902 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:14.902 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621947
24-09-03.21:09:14.962 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:14.962 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:15.003 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:15.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:09:15.022 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:15.023 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095621998
24-09-03.21:09:15.046 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:09:15.046 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:15.046 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:09:15.098 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:09:15.098 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@250d7fcf], lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:15.098 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:09:15.098 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:09:15.100 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:15.100 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:41.380 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:09:41.403 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:41.408 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:09:41.408 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@250d7fcf], lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:41.409 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:09:41.409 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:09:41.421 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:41.421 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633070
24-09-03.21:09:41.482 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:41.482 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:41.523 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:41.541 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:41.542 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633121
24-09-03.21:09:41.606 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:41.606 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:41.643 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:41.662 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:41.663 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633172
24-09-03.21:09:41.726 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:41.726 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:41.763 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:41.785 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:41.786 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633223
24-09-03.21:09:41.847 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:41.847 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:41.887 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:41.912 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:41.912 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633276
24-09-03.21:09:41.968 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:41.968 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:42.012 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:42.031 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:42.032 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633326
24-09-03.21:09:42.091 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:42.092 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:42.133 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:42.155 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:42.155 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633378
24-09-03.21:09:42.221 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:42.221 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:42.258 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:09:42.278 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:42.278 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095633430
24-09-03.21:09:42.343 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:09:42.343 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:09:42.362 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309563346
24-09-03.21:09:42.586 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309563346","timeStamp":"2024-09-03 21:09:42.363"}
24-09-03.21:09:42.587 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:09:42.618 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309563346","timeStamp":"2024-09-03 21:09:42.363"}
24-09-03.21:09:42.655 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:09:42.655 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:09:42.655 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:09:45.011 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:09:45.012 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:09:45.012 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:09:45.012 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:10:14.701 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:10:14.723 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:10:14.723 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@250d7fcf], lock=Optional.empty, window=Optional.empty)
24-09-03.21:10:14.723 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:10:14.723 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:10:14.756 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:10:14.777 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:10:14.777 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:10:15.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:10:15.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:10:15.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:10:15.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:10:15.057 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:10:15.058 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:10:15.058 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@250d7fcf], lock=Optional.empty, window=Optional.empty)
24-09-03.21:10:15.058 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:10:15.058 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:10:15.738 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:10:15.738 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:10:15.740 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:10:15.740 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:10:15.741 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:10:15.741 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:10:15.742 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:10:15.743 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:10:15.833 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:10:15.843 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:10:15.843 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:10:15.851 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:10:22.725 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 38832 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:10:22.732 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:10:24.376 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:10:24.383 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:10:24.473 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 62 ms. Found 0 Redis repository interfaces.
24-09-03.21:10:25.057 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:10:25.074 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:10:25.365 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$d5311c7b] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:10:26.265 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:10:27.366 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:10:27.379 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:10:27.626 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:10:29.803 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:10:30.381 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:10:30.532 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:10:33.424 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:10:33.437 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:10:33.437 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:10:33.438 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:10:33.438 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:10:33.438 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:10:33.438 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:10:33.438 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@15a8b228
24-09-03.21:10:33.588 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:10:33.706 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:10:33.866 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#608c03e3:0/SimpleConnection@5af535ff [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51855]
24-09-03.21:10:34.143 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:10:34.143 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:10:34.161 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 11.974 seconds (JVM running for 13.163)
24-09-03.21:10:34.558 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:10:34.612 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655380
24-09-03.21:10:34.680 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:34.680 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:34.720 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:34.720 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655425
24-09-03.21:10:34.784 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:34.784 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:34.821 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:34.822 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655468
24-09-03.21:10:34.885 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:34.885 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:34.923 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:34.923 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655511
24-09-03.21:10:34.986 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:34.986 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.010 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:10:35.023 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.023 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655552
24-09-03.21:10:35.087 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.087 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.125 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.126 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655596
24-09-03.21:10:35.190 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.191 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.336 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.337 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655684
24-09-03.21:10:35.401 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.401 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.439 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.439 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655727
24-09-03.21:10:35.501 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.501 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.541 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.541 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655770
24-09-03.21:10:35.609 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.609 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.653 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.653 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655817
24-09-03.21:10:35.720 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.720 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.759 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.759 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655861
24-09-03.21:10:35.824 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.825 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.863 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.864 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655905
24-09-03.21:10:35.880 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:10:35.881 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:10:35.881 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:10:35.927 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:10:35.927 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:10:35.978 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:10:35.978 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095655953
24-09-03.21:10:47.782 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:10:47.834 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:10:47.854 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:10:47.854 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:10:47.892 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:10:47.892 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@7b19db95], lock=Optional.empty, window=Optional.empty)
24-09-03.21:10:47.892 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:10:47.892 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:10:48.806 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:10:48.806 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:10:48.808 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:10:48.808 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:10:48.808 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:10:48.808 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:10:48.810 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:10:48.811 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:10:48.860 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:10:48.860 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:10:48.860 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:10:48.878 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:10:48.889 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:10:48.890 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:10:48.898 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:10:52.183 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 41912 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:10:52.185 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:10:53.983 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:10:53.990 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:10:54.071 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 56 ms. Found 0 Redis repository interfaces.
24-09-03.21:10:54.691 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:10:54.709 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:10:54.999 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$f6e711a7] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:10:55.981 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:10:57.105 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:10:57.121 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:10:57.404 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:10:59.660 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:11:00.232 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:11:00.403 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:11:03.303 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:11:03.317 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:11:03.317 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:11:03.318 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:11:03.318 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:11:03.318 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:11:03.318 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:11:03.319 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@2523730b
24-09-03.21:11:03.479 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:11:03.591 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:11:03.746 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#52b53172:0/SimpleConnection@11f415e4 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 51951]
24-09-03.21:11:04.021 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:11:04.022 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:11:04.039 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.363 seconds (JVM running for 13.768)
24-09-03.21:11:05.010 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:11:05.167 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:11:05.167 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:11:05.167 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:11:05.167 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:05.167 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:05.167 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@50c3912], lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:05.167 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:11:05.167 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:11:05.167 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:05.167 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:11.256 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:11:11.285 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:11:11.285 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@50c3912], lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:11.287 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:11.287 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:11.380 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:11:11.380 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:11.380 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:11:11.455 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:11:11.455 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:11.456 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:11:11.496 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:11:11.553 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095670874
24-09-03.21:11:11.666 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:11.666 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:11.708 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:16.256 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:11:27.531 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:11:27.531 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:27.531 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:11:27.580 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:11:27.595 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:11:27.598 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:11:27.598 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:11:27.598 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:27.600 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677605
24-09-03.21:11:27.620 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:11:27.620 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@50c3912], lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:27.620 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:27.620 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:27.664 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:27.664 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:27.708 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:27.728 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:27.728 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677659
24-09-03.21:11:27.796 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:27.796 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:27.837 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:27.856 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:27.857 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677713
24-09-03.21:11:27.928 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:27.928 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:27.965 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:27.992 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:27.992 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677769
24-09-03.21:11:28.057 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:28.057 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:28.101 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:28.126 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:28.126 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677825
24-09-03.21:11:28.194 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:28.194 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:28.244 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:28.267 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:28.267 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677885
24-09-03.21:11:28.333 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:28.333 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:28.378 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:28.397 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:28.397 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677939
24-09-03.21:11:28.464 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:28.464 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:28.506 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:28.526 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:28.526 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095677993
24-09-03.21:11:28.552 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:11:28.552 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:11:28.554 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:11:28.555 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:11:28.555 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:11:28.555 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:11:28.557 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:11:28.557 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:11:28.596 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:28.596 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:31.707 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:11:31.714 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:11:31.714 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:11:31.722 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:11:39.323 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 31688 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:11:39.325 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:11:41.133 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:11:41.140 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:11:41.237 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 71 ms. Found 0 Redis repository interfaces.
24-09-03.21:11:41.880 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:11:41.898 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:11:42.181 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$a8555264] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:11:43.137 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:11:44.237 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:11:44.251 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:11:44.538 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:11:46.918 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:11:47.506 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:11:47.661 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:11:50.665 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:11:50.682 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:11:50.683 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:11:50.683 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:11:50.684 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:11:50.684 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:11:50.684 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:11:50.684 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@6ab4215d
24-09-03.21:11:50.847 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:11:50.978 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:11:51.149 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#201c1d99:0/SimpleConnection@439b893a [delegate=amqp://admin@8.138.41.137:5672/, localPort= 52060]
24-09-03.21:11:51.436 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:11:51.436 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:11:51.455 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.7 seconds (JVM running for 14.253)
24-09-03.21:11:52.585 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:11:52.585 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:52.585 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:11:52.819 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:11:52.819 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:52.819 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:11:52.888 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:11:52.888 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:52.888 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:11:52.931 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:11:52.997 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688257
24-09-03.21:11:53.115 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.115 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.154 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.221 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.221 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688351
24-09-03.21:11:53.278 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.278 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.316 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.336 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.337 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688400
24-09-03.21:11:53.393 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.393 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.431 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.451 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.451 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688448
24-09-03.21:11:53.507 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.507 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.545 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.564 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.564 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688495
24-09-03.21:11:53.622 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.622 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.660 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.679 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.679 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688543
24-09-03.21:11:53.736 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.736 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.773 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.792 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.793 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688591
24-09-03.21:11:53.848 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.848 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.886 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:53.906 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:53.906 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688638
24-09-03.21:11:53.961 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:53.961 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:53.998 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.018 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.018 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688685
24-09-03.21:11:54.075 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.075 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.112 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.131 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.131 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688733
24-09-03.21:11:54.187 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.187 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.225 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.243 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.243 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688780
24-09-03.21:11:54.300 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.301 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.337 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.357 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.357 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688828
24-09-03.21:11:54.413 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.413 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.451 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.469 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.470 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688875
24-09-03.21:11:54.525 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.525 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.563 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.582 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.582 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688922
24-09-03.21:11:54.645 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.645 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.683 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.702 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.702 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095688972
24-09-03.21:11:54.758 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.758 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.795 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.813 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.813 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095689019
24-09-03.21:11:54.870 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.870 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:54.907 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:54.926 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:54.926 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095689066
24-09-03.21:11:54.984 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:54.984 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:55.009 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:11:55.021 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:55.042 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:55.042 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:11:55.042 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095689115
24-09-03.21:11:55.042 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:55.042 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:11:55.098 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:55.098 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:59.858 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:11:59.877 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:11:59.898 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:11:59.898 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095691152
24-09-03.21:11:59.934 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:11:59.934 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@399eab2d], lock=Optional.empty, window=Optional.empty)
24-09-03.21:11:59.934 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:59.934 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:11:59.955 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:11:59.956 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:11:59.994 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:12:00.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:12:00.012 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:12:00.013 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095691200
24-09-03.21:12:00.028 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:12:00.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:12:00.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:12:00.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:12:00.070 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:12:00.070 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:12:05.352 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:12:15.143 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309569754
24-09-03.21:12:15.155 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:12:15.155 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:12:15.155 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:12:15.215 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:12:15.216 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:12:15.216 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@399eab2d], lock=Optional.empty, window=Optional.empty)
24-09-03.21:12:15.216 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:12:15.216 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:12:15.361 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309569754","timeStamp":"2024-09-03 21:12:15.144"}
24-09-03.21:12:15.361 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:12:15.389 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309569754","timeStamp":"2024-09-03 21:12:15.144"}
24-09-03.21:12:15.420 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:12:15.420 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:12:15.420 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:12:20.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:12:20.004 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:12:20.004 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@399eab2d], lock=Optional.empty, window=Optional.empty)
24-09-03.21:12:20.004 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:12:20.004 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:12:20.022 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:12:20.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:12:20.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:12:20.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:12:25.549 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:12:25.572 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:12:25.572 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@399eab2d], lock=Optional.empty, window=Optional.empty)
24-09-03.21:12:25.573 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:12:25.573 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:12:28.926 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:12:28.956 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:12:28.956 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:12:29.597 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:12:29.597 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:12:29.599 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:12:29.599 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:12:29.600 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:12:29.600 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:12:29.601 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:12:29.602 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:12:29.686 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:12:29.694 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:12:29.694 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:12:29.700 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:13:17.432 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 12384 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:13:17.440 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:13:19.406 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:13:19.413 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:13:19.502 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 62 ms. Found 0 Redis repository interfaces.
24-09-03.21:13:20.159 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:13:20.179 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:13:20.488 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$884d4e13] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:13:21.499 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:13:22.651 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:13:22.670 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:13:22.957 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:13:25.330 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:13:25.908 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:13:26.062 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:13:29.473 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:13:29.487 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:13:29.487 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:13:29.487 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:13:29.488 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:13:29.488 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:13:29.488 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:13:29.488 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@65c2610f
24-09-03.21:13:29.667 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:13:29.801 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:13:29.963 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#2aabd5a0:0/SimpleConnection@530dd2d7 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 52169]
24-09-03.21:13:30.293 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:13:30.293 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:13:30.314 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 13.458 seconds (JVM running for 14.835)
24-09-03.21:13:31.487 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:13:31.487 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:31.488 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:13:31.742 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:13:31.742 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:31.742 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:13:31.828 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:13:31.828 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:31.828 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:13:31.884 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:13:31.963 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095729766
24-09-03.21:13:32.075 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.075 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.115 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.184 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.184 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095729859
24-09-03.21:13:32.242 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.243 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.280 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.300 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.301 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095729908
24-09-03.21:13:32.357 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.357 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.396 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.417 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.417 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095729957
24-09-03.21:13:32.474 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.475 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.513 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.533 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.533 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730006
24-09-03.21:13:32.590 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.590 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.627 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.647 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.647 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730053
24-09-03.21:13:32.704 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.704 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.742 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.761 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.761 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730101
24-09-03.21:13:32.818 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.818 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.856 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.875 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.875 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730149
24-09-03.21:13:32.933 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:32.933 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:32.971 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:32.992 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:32.992 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730198
24-09-03.21:13:33.048 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.048 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.087 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.106 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.106 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730246
24-09-03.21:13:33.163 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.163 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.202 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.220 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.220 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730294
24-09-03.21:13:33.278 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.279 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.315 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.336 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.336 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730342
24-09-03.21:13:33.395 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.395 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.432 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.451 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.452 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730391
24-09-03.21:13:33.509 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.509 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.546 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.567 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.567 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730439
24-09-03.21:13:33.623 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.624 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.668 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.687 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.688 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730490
24-09-03.21:13:33.745 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.745 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.783 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.802 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.802 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730538
24-09-03.21:13:33.860 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.860 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:33.896 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:33.916 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:33.916 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730586
24-09-03.21:13:33.973 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:33.973 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:34.011 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:34.030 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:34.030 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730633
24-09-03.21:13:34.087 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:34.087 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:34.125 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:34.145 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:34.145 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730682
24-09-03.21:13:34.200 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:34.201 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:34.237 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:13:34.256 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:34.257 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095730729
24-09-03.21:13:34.315 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:13:34.315 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:13:34.335 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309573076
24-09-03.21:13:34.563 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309573076","timeStamp":"2024-09-03 21:13:34.335"}
24-09-03.21:13:34.563 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:13:34.591 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309573076","timeStamp":"2024-09-03 21:13:34.335"}
24-09-03.21:13:34.665 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:13:34.665 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:13:34.665 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:13:35.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:35.034 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:35.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:35.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:35.074 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:13:35.074 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:35.074 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:35.074 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:35.081 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:40.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:40.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:40.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:40.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:40.013 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:13:40.013 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:40.014 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:40.014 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:40.077 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:45.001 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:45.001 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:45.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:45.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:45.075 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:45.095 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:13:45.095 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:45.095 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:45.095 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:50.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:50.026 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:50.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:50.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:50.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:50.094 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:13:50.094 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:50.094 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:50.094 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:55.002 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:55.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:55.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:55.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:13:55.067 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:13:55.087 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:13:55.087 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:13:55.087 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:13:55.087 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:00.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:00.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:00.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:00.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:00.073 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:00.095 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:14:00.095 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:00.095 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:00.095 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:05.013 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:05.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:14:05.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:05.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:05.015 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:05.032 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:05.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:05.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:05.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:10.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:10.023 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:10.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:10.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:10.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:10.036 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:14:10.060 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:14:10.060 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:14:10.096 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:14:10.097 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@59deb542], lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:10.097 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:10.097 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:10.596 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:14:11.031 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:14:11.032 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:14:11.032 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:14:11.032 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:14:11.032 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:14:11.034 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:14:11.034 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:14:11.117 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:14:11.125 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:14:11.125 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:14:11.131 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:14:36.029 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 42588 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:14:36.030 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:14:37.812 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:14:37.817 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:14:37.900 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 60 ms. Found 0 Redis repository interfaces.
24-09-03.21:14:38.553 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:14:38.568 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:14:38.860 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$edc36bc2] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:14:39.785 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:14:41.111 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:14:41.126 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:14:41.424 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:14:43.824 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:14:44.418 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:14:44.576 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:14:47.578 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:14:47.592 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:14:47.593 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:14:47.593 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:14:47.595 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:14:47.595 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:14:47.595 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:14:47.595 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@376ba8e3
24-09-03.21:14:47.761 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:14:47.887 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:14:48.045 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5cb4e255:0/SimpleConnection@250d3c1b [delegate=amqp://admin@8.138.41.137:5672/, localPort= 52279]
24-09-03.21:14:48.389 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:14:48.389 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:14:48.407 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.913 seconds (JVM running for 14.148)
24-09-03.21:14:49.488 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:14:49.488 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:49.488 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:14:49.745 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:14:49.745 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:49.745 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:14:49.816 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:14:49.817 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:49.817 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:14:49.861 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:14:49.917 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762463
24-09-03.21:14:50.009 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:50.027 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.027 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.053 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:50.053 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:50.053 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:50.073 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.107 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:14:50.108 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:50.108 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:50.108 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:50.119 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:50.168 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.168 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762568
24-09-03.21:14:50.261 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.261 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.323 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.351 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.351 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762645
24-09-03.21:14:50.432 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.432 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.477 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.497 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.497 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762706
24-09-03.21:14:50.556 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.557 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.598 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.617 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.617 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762756
24-09-03.21:14:50.680 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.680 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.718 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.737 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.738 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762807
24-09-03.21:14:50.801 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.801 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.837 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.859 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.859 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762858
24-09-03.21:14:50.919 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:50.919 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:50.960 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:50.981 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:50.982 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762909
24-09-03.21:14:51.038 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.038 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.082 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.101 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.101 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095762959
24-09-03.21:14:51.160 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.160 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.200 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.219 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.219 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763009
24-09-03.21:14:51.280 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.280 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.321 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.339 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.339 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763059
24-09-03.21:14:51.403 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.403 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.439 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.461 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.461 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763110
24-09-03.21:14:51.520 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.520 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.560 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.583 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.583 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763162
24-09-03.21:14:51.638 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.638 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.682 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.701 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.701 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763211
24-09-03.21:14:51.759 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.759 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.800 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.819 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.819 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763260
24-09-03.21:14:51.880 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:51.881 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:51.918 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:51.936 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:51.937 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763310
24-09-03.21:14:52.002 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:52.002 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:52.038 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:52.060 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:52.060 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763362
24-09-03.21:14:52.122 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:52.122 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:52.162 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:52.184 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:52.185 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763414
24-09-03.21:14:52.241 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:52.241 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:52.286 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:52.305 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:52.305 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763464
24-09-03.21:14:52.363 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:52.363 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:52.404 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:14:52.423 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:52.423 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095763514
24-09-03.21:14:52.483 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:14:52.483 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:14:52.505 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309576354
24-09-03.21:14:52.711 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309576354","timeStamp":"2024-09-03 21:14:52.505"}
24-09-03.21:14:52.711 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:14:52.739 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309576354","timeStamp":"2024-09-03 21:14:52.505"}
24-09-03.21:14:52.775 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:14:52.775 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:14:52.775 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:14:55.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:55.005 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:14:55.005 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:55.005 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:55.005 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:14:55.025 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:14:55.026 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:14:55.026 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:14:55.026 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:00.009 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:00.010 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:00.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:00.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:03.469 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:15:03.469 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:03.470 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:03.470 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:03.470 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:05.013 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:05.036 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:05.037 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:05.037 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:05.037 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:05.099 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:15:05.099 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:05.099 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:05.099 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:10.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:10.023 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:10.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:10.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:10.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:10.025 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:15:10.025 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:10.025 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:10.025 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:15.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:15.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:15.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:15.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:15.062 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:15.086 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:15:15.086 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:15.086 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:15.086 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:20.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:20.003 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:15:20.003 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:20.003 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:20.003 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:20.029 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:20.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:20.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:20.030 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:25.002 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:25.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:25.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:25.003 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:15:25.059 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:15:25.079 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:15:25.079 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@462ccd80], lock=Optional.empty, window=Optional.empty)
24-09-03.21:15:25.079 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:25.079 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:15:27.647 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:15:27.680 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:15:27.680 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:15:27.684 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:15:27.699 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:15:27.701 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:15:27.701 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:15:27.701 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:15:27.702 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:15:27.703 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:15:27.703 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:15:27.799 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:15:27.806 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:15:27.807 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:15:27.815 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:16:36.803 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 23848 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:16:36.804 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:16:38.563 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:16:38.570 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:16:38.649 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 56 ms. Found 0 Redis repository interfaces.
24-09-03.21:16:39.230 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:16:39.245 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:16:39.532 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$33f044a1] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:16:40.465 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:16:41.573 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:16:41.586 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:16:41.848 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:16:42.155 [main            ] WARN  GenericWebApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'raffleActivityController': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'activityArmory': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'activityRepository': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'IRaffleActivityOrderDao' defined in file [C:\Users\27132\Java\big-market\big-market-infrastructure\target\classes\com\big\market\infrastructure\infrastructure\persistent\dao\IRaffleActivityOrderDao.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [org/mybatis/spring/boot/autoconfigure/MybatisAutoConfiguration.class]: Unsatisfied dependency expressed through method 'sqlSessionFactory' parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'shardingSphereDataSource' defined in class path resource [org/apache/shardingsphere/spring/boot/ShardingSphereAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [javax.sql.DataSource]: Factory method 'shardingSphereDataSource' threw exception; nested exception is java.lang.IllegalStateException: Shutdown in progress
24-09-03.21:17:07.804 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 10764 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:17:07.812 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:17:09.498 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:17:09.503 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:17:09.581 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 56 ms. Found 0 Redis repository interfaces.
24-09-03.21:17:10.172 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:17:10.189 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:17:10.470 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$e227e9ba] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:17:11.432 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:17:12.533 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:17:12.549 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:17:12.887 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:17:15.153 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:17:15.761 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:17:15.925 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:17:18.813 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:17:18.828 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:17:18.828 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:17:18.829 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:17:18.829 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:17:18.829 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:17:18.830 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:17:18.830 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@685e8e17
24-09-03.21:17:18.985 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:17:19.111 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:17:19.282 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#44f86613:0/SimpleConnection@7b5f886d [delegate=amqp://admin@8.138.41.137:5672/, localPort= 52410]
24-09-03.21:17:19.588 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:17:19.588 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:17:19.607 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 12.317 seconds (JVM running for 13.485)
24-09-03.21:17:20.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:20.821 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:20.821 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?;
24-09-03.21:17:20.821 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:20.821 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:20.821 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:20.821 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:20.821 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               sku,
               activity_id,
               activity_count_id,
               stock_count,
               stock_count_surplus,
               create_time,
               update_time
        from raffle_activity_sku where sku = ?; ::: [9011]
24-09-03.21:17:20.821 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:20.821 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:20.821 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:20.960 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:21.068 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?;
24-09-03.21:17:21.068 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:21.068 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_id,
               activity_name,
               activity_desc,
               begin_date_time,
               end_date_time,
               stock_count,
               stock_count_surplus,
               activity_count_id,
               strategy_id,
               `state`,
               create_time,
               update_time
        from raffle_activity where activity_id = ?; ::: [101]
24-09-03.21:17:21.141 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?;
24-09-03.21:17:21.141 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:21.141 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select id,
               activity_count_id,
               total_count,
               day_count,
               month_count,
               create_time,
               update_time
        from raffle_activity_count where activity_count_id = ?; ::: [101]
24-09-03.21:17:21.181 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:17:21.241 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095825933
24-09-03.21:17:21.353 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:21.353 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:21.393 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:26.714 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:26.715 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:26.715 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:26.715 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:26.715 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:26.715 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:26.715 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:26.715 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:26.775 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:26.775 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095828254
24-09-03.21:17:26.781 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:26.834 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:26.835 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:26.876 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:28.401 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:28.402 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095828936
24-09-03.21:17:28.465 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:28.465 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:28.502 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:29.976 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:29.977 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095829597
24-09-03.21:17:30.011 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:30.012 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:30.012 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:30.012 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:30.037 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:30.037 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:30.077 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:34.355 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:17:34.356 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:34.356 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095831433
24-09-03.21:17:34.366 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:17:34.366 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:17:34.366 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:17:34.445 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:34.445 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:34.458 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:34.491 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:34.491 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:34.491 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:34.491 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:34.505 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:35.892 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:35.893 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:35.893 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:35.894 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:35.894 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:35.915 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:35.915 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095832087
24-09-03.21:17:35.915 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:35.917 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:35.917 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:35.917 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:35.975 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:35.975 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:36.675 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:17:36.676 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:17:36.676 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:17:36.676 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:17:36.695 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:37.182 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:37.182 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095832619
24-09-03.21:17:37.247 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:37.247 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:37.285 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:37.693 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:37.693 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095832833
24-09-03.21:17:37.757 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:37.757 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:37.794 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:37.976 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:37.976 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095832952
24-09-03.21:17:38.037 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:38.037 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:38.079 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:38.258 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:38.259 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095833070
24-09-03.21:17:38.315 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:38.315 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:38.358 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:38.595 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:38.596 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095833212
24-09-03.21:17:38.654 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:38.655 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:38.695 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:38.942 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:38.942 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095833357
24-09-03.21:17:39.007 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:39.007 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:39.044 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:39.826 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:39.827 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095833728
24-09-03.21:17:39.887 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:39.887 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:39.929 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:40.418 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:40.437 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:40.437 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095833984
24-09-03.21:17:40.438 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:40.439 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:40.439 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:40.439 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:40.439 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:40.439 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:40.439 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:40.439 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:40.496 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:40.496 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:41.157 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:17:41.159 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:17:41.159 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:17:41.159 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:17:41.179 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:41.632 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:41.633 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095834485
24-09-03.21:17:41.697 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:41.699 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:41.739 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:41.955 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:41.955 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095834621
24-09-03.21:17:42.016 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:42.016 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:42.053 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:42.241 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:42.242 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095834741
24-09-03.21:17:42.298 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:42.298 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:42.342 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:42.705 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:42.705 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095834935
24-09-03.21:17:42.774 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:42.774 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:42.814 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:42.936 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:42.936 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095835032
24-09-03.21:17:43.000 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:43.000 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:43.036 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:43.135 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:43.135 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095835116
24-09-03.21:17:43.193 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:17:43.193 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:17:43.235 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】成功。sku:9011 activityId:101
24-09-03.21:17:43.524 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:17:45.012 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:45.031 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:45.032 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:45.032 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:45.032 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:45.032 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:45.032 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:45.032 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:45.032 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:46.225 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:17:46.227 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:17:46.227 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:17:46.227 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:17:50.016 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:50.034 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:50.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:50.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:50.035 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:50.035 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:50.035 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:50.035 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:50.035 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:52.456 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:17:52.457 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:17:52.457 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:17:52.457 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:17:55.002 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:55.021 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:17:55.022 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:55.022 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:55.022 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:17:58.119 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:17:58.120 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:17:58.120 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:17:58.120 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:17:58.194 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:17:58.194 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:17:58.194 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:17:58.194 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:00.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:00.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:00.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:00.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:00.009 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:00.009 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:00.009 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:00.009 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:00.072 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:00.073 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:00.073 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:00.073 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:00.121 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:05.011 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:05.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:05.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:05.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:05.077 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:05.078 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:05.078 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:05.078 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:05.126 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:05.127 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:05.127 [pool-7-thread-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:05.127 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:05.127 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:10.007 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:10.028 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:10.029 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:10.029 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:10.029 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:10.092 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:10.092 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:10.092 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:10.092 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:10.141 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:10.142 [pool-7-thread-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:10.142 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:10.142 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:15.000 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:15.001 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:15.001 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:15.001 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:15.065 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:15.066 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:15.066 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:15.066 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:15.115 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:15.116 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:15.116 [pool-7-thread-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:15.116 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:15.116 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:20.015 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:20.015 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:20.016 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:20.016 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:20.085 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:20.086 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:20.086 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:20.086 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:20.133 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:20.135 [pool-7-thread-13] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:20.135 [pool-7-thread-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:20.135 [pool-7-thread-13] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:20.135 [pool-7-thread-13] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:25.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:25.025 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:25.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:25.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:25.025 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:25.088 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:25.089 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:25.089 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:25.089 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:25.139 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:25.139 [pool-7-thread-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:25.139 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:25.139 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:30.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:30.030 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:30.031 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:30.031 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:30.031 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:30.094 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:30.094 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:30.094 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:30.094 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:30.145 [pool-7-thread-15] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:30.145 [pool-7-thread-15] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:30.145 [pool-7-thread-15] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:30.145 [pool-7-thread-15] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:35.014 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:35.037 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:35.038 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:35.038 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:35.038 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:35.101 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:35.102 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:35.102 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:35.102 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:35.153 [pool-7-thread-16] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:35.153 [pool-7-thread-16] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:35.153 [pool-7-thread-16] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:35.153 [pool-7-thread-16] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:40.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:40.028 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:40.029 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:40.029 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:40.029 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:40.097 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:40.098 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:40.098 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:40.098 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:40.147 [pool-7-thread-17] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:40.147 [pool-7-thread-17] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:40.147 [pool-7-thread-17] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:40.147 [pool-7-thread-17] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:45.011 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:45.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:45.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:45.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:45.074 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:45.075 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:45.075 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:45.075 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:45.123 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:45.146 [pool-7-thread-18] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:45.146 [pool-7-thread-18] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:45.146 [pool-7-thread-18] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:45.146 [pool-7-thread-18] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:50.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:50.026 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:50.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:50.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:50.027 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:50.027 [pool-7-thread-19] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:50.027 [pool-7-thread-19] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:50.027 [pool-7-thread-19] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:50.027 [pool-7-thread-19] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:50.089 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:50.089 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:50.089 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:50.089 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:55.001 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:55.001 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:55.001 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:55.002 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:18:55.069 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:18:55.070 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:18:55.070 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:18:55.070 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:18:55.121 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:18:55.142 [pool-7-thread-20] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:18:55.142 [pool-7-thread-20] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:18:55.142 [pool-7-thread-20] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:18:55.142 [pool-7-thread-20] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:00.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:00.032 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:00.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:00.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:00.033 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:00.340 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:19:00.341 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:19:00.341 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:19:00.341 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:19:00.652 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:19:00.652 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:00.652 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:00.652 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:05.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:05.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:05.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:05.013 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:05.076 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存 sku:9011 activityId:101
24-09-03.21:19:05.076 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:19:05.076 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:19:05.076 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = stock_count_surplus - 1, update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:19:05.124 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:05.125 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:19:05.125 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:05.125 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:05.125 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:10.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:10.007 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:10.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:10.008 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:10.075 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:10.097 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:19:10.097 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:10.097 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:10.097 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:15.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:15.006 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:15.006 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:15.006 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:15.007 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:19:15.007 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:15.007 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:15.007 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:15.068 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:20.005 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:20.006 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:20.006 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:19:20.006 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:20.006 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:19:20.006 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6845df1a], lock=Optional.empty, window=Optional.empty)
24-09-03.21:19:20.006 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:20.006 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:19:20.072 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:19:24.438 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:19:24.457 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:19:24.457 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:19:24.675 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:19:24.675 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:19:24.676 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:19:24.677 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:19:24.677 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:19:24.677 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:19:24.678 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:19:24.679 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:19:24.749 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:19:24.757 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:19:24.757 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:19:24.762 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-09-03.21:21:03.851 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Starting RaffleActivityAccountQuotaServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 13132 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-09-03.21:21:03.852 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - The following 1 profile is active: "dev"
24-09-03.21:21:05.757 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-09-03.21:21:05.780 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-09-03.21:21:05.930 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 108 ms. Found 0 Redis repository interfaces.
24-09-03.21:21:06.608 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:21:06.629 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:21:06.930 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$4f7cebf5] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-09-03.21:21:07.949 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-09-03.21:21:09.105 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-09-03.21:21:09.122 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-09-03.21:21:09.399 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-09-03.21:21:11.988 [main            ] INFO  Version                - Redisson 3.23.4
24-09-03.21:21:12.580 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:21:12.755 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-09-03.21:21:16.473 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-09-03.21:21:16.489 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-09-03.21:21:16.489 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-09-03.21:21:16.490 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-09-03.21:21:16.491 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-09-03.21:21:16.491 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-09-03.21:21:16.491 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-09-03.21:21:16.491 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@47cf41d7
24-09-03.21:21:16.669 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-09-03.21:21:16.819 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-09-03.21:21:16.989 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#16ef07fa:0/SimpleConnection@62765e11 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 52590]
24-09-03.21:21:17.315 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-09-03.21:21:17.315 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-09-03.21:21:17.338 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - Started RaffleActivityAccountQuotaServiceTest in 14.003 seconds (JVM running for 15.505)
24-09-03.21:21:17.830 [main            ] INFO  RaffleActivityAccountQuotaServiceTest - 装配活动：true
24-09-03.21:21:17.919 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925203
24-09-03.21:21:17.988 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:17.988 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:18.010 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18309592524
24-09-03.21:21:18.400 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:activity_sku_stock_zero, message:{"data":9011,"id":"18309592524","timeStamp":"2024-09-03 21:21:18.011"}
24-09-03.21:21:18.400 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:18.400 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925404
24-09-03.21:21:18.429 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ActivitySkuStockZeroCustomer - 监听活动sku库存消耗为0消息 topic: activity_sku_stock_zero message: {"data":9011,"id":"18309592524","timeStamp":"2024-09-03 21:21:18.011"}
24-09-03.21:21:18.462 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:18.462 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:18.501 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:18.501 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925447
24-09-03.21:21:18.562 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:18.562 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:18.601 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:18.601 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925489
24-09-03.21:21:18.667 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:18.668 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:18.706 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:18.706 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925533
24-09-03.21:21:18.765 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:18.767 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:18.804 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:18.804 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925574
24-09-03.21:21:18.865 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:18.865 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:18.902 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:18.902 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925615
24-09-03.21:21:18.964 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:18.964 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.002 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.002 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925657
24-09-03.21:21:19.065 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.065 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.103 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.103 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925699
24-09-03.21:21:19.167 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.167 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.201 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Logic SQL: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0;
24-09-03.21:21:19.201 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-09-03.21:21:19.201 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-1] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update raffle_activity_sku
        set stock_count_surplus = 0 and update_time = now()
        where sku = ? and stock_count_surplus > 0; ::: [9011]
24-09-03.21:21:19.206 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.206 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925742
24-09-03.21:21:19.266 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.267 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.303 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.304 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925783
24-09-03.21:21:19.363 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.364 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.404 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.405 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925826
24-09-03.21:21:19.461 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.461 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.502 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.502 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925867
24-09-03.21:21:19.559 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.560 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.600 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.600 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925908
24-09-03.21:21:19.657 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.657 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.698 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.698 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925949
24-09-03.21:21:19.757 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.757 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.797 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.797 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095925990
24-09-03.21:21:19.853 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.853 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.894 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.894 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095926031
24-09-03.21:21:19.950 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:19.950 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:19.992 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:19.992 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095926072
24-09-03.21:21:20.000 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:20.058 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:20.059 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:20.086 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:20.087 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:20.087 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:20.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:21:20.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@76470c8f], lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:20.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:20.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:20.124 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:20.126 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095926128
24-09-03.21:21:20.173 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:20.185 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:20.185 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:20.222 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:20.223 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:183095926169
24-09-03.21:21:20.283 [main            ] INFO  ActivityBaseActionChain - 活动责任链-基础信息【有效期、状态、库存(sku)】校验开始。sku:9011 activityId:101
24-09-03.21:21:20.284 [main            ] INFO  ActivitySkuStockActionChain - 活动责任链-商品库存处理【有效期、状态、库存(sku)】开始。sku:9011 activityId:101
24-09-03.21:21:20.321 [main            ] WARN  RaffleActivityAccountQuotaServiceTest - 活动库存不足
24-09-03.21:21:25.015 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:25.035 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:25.036 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:25.037 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:25.037 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:25.037 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:21:25.037 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@76470c8f], lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:25.037 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:25.037 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:30.004 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:30.023 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:30.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:30.024 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:21:30.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:30.024 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:30.024 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@76470c8f], lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:30.024 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:30.024 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:35.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:35.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:35.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:35.009 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:35.066 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:35.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:21:35.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@76470c8f], lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:35.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:35.085 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:40.010 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:40.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Logic SQL: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:40.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional.empty, lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:40.011 [scheduling-1    ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select sku
        from raffle_activity_sku
        where activity_id in (select activity_id from raffle_activity where state = 'open')
24-09-03.21:21:40.071 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-09-03.21:21:40.091 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) limit 10;;
24-09-03.21:21:40.091 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@76470c8f], lock=Optional.empty, window=Optional.empty)
24-09-03.21:21:40.092 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:40.092 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60000000000000) ORDER BY id ASC  limit 10;;
24-09-03.21:21:42.782 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:21:42.802 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:21:42.802 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-09-03.21:21:43.493 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:21:43.583 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-09-03.21:21:43.585 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-09-03.21:21:43.585 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-09-03.21:21:43.588 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-09-03.21:21:43.589 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-09-03.21:21:43.591 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:21:43.591 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-09-03.21:21:43.680 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-09-03.21:21:43.688 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-09-03.21:21:43.688 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-09-03.21:21:43.696 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
