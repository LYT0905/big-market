24-08-22.16:16:29.569 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 5776 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:16:29.570 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:16:31.430 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:16:31.437 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:16:31.515 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 51 ms. Found 0 Redis repository interfaces.
24-08-22.16:16:32.085 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:16:32.101 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:16:32.429 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$2ef37041] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:16:34.019 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:16:34.777 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:16:35.206 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:16:35.736 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:16:37.112 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:16:37.134 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:16:37.779 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:16:43.063 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:16:43.079 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:16:43.079 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:16:43.080 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:16:43.080 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:16:43.080 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:16:43.080 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:16:43.080 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@25a41143
24-08-22.16:16:43.237 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:16:43.376 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:16:43.687 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7dc16d33:0/SimpleConnection@31b846f [delegate=amqp://admin@8.138.41.137:5672/, localPort= 60198]
24-08-22.16:16:44.322 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:16:44.322 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:16:44.347 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 15.314 seconds (JVM running for 17.069)
24-08-22.16:16:44.725 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653395431
24-08-22.16:16:44.727 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265339543
24-08-22.16:16:45.095 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:16:45.159 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:16:45.777 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:16:45.777 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@5928178c], lock=Optional.empty, window=Optional.empty)
24-08-22.16:16:45.778 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:16:45.778 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:16:45.839 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:16:45.839 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:16:45.839 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into user_award_record_2(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [xiaofuge, 100301, 100006, 182653395431, 101, OpenAI 增加使用次数, 2024-08-22 16:16:44.725, create, 1033413615002562560]
24-08-22.16:16:46.299 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:16:46.352 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:16:46.352 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:16:46.413 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:16:47.150 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:16:47.152 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:16:47.152 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:16:47.152 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:16:47.153 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:16:47.154 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:16:47.154 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:16:47.217 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:16:47.226 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:16:47.226 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:16:47.233 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:19:05.727 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 26600 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:19:05.728 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:19:07.315 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:19:07.321 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:19:07.399 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 56 ms. Found 0 Redis repository interfaces.
24-08-22.16:19:07.989 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:19:08.006 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:19:08.268 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$caf41c65] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:19:09.494 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:19:10.136 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:19:10.517 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:19:10.895 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:19:12.208 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:19:12.222 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:19:12.774 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:19:18.856 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:19:18.869 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:19:18.869 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:19:18.869 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:19:18.871 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:19:18.871 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:19:18.871 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:19:18.871 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@1ea6446b
24-08-22.16:19:19.017 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:19:19.135 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:19:19.414 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#1915879c:0/SimpleConnection@10ba757f [delegate=amqp://admin@8.138.41.137:5672/, localPort= 60703]
24-08-22.16:19:20.077 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:19:20.078 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:19:20.095 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 14.854 seconds (JVM running for 15.953)
24-08-22.16:19:20.390 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653460721
24-08-22.16:19:20.392 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265346072
24-08-22.16:19:21.359 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:19:21.359 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:19:21.360 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653460721, 101, OpenAI 增加使用次数, 2024-08-22 16:19:20.39, create, 1033414267279749120]
24-08-22.16:19:21.886 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:19:21.942 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:19:21.942 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:19:21.946 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:19:22.141 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:19:22.143 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:19:22.143 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:19:22.143 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:19:22.143 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:19:22.145 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:19:22.145 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:19:22.224 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:19:22.233 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:19:22.233 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:19:22.240 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:19:53.929 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 21240 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:19:53.930 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:19:55.666 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:19:55.671 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:19:55.747 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 0 Redis repository interfaces.
24-08-22.16:19:56.260 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:19:56.275 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:19:56.536 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$7cce6912] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:19:57.765 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:19:58.441 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:19:58.817 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:19:59.193 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:20:00.483 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:20:00.496 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:20:01.095 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:20:05.673 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:20:05.686 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:20:05.686 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:20:05.687 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:20:05.688 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:20:05.688 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:20:05.688 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:20:05.688 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@1467dcd0
24-08-22.16:20:05.836 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:20:05.952 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:20:06.239 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4164ab12:0/SimpleConnection@26c9225a [delegate=amqp://admin@8.138.41.137:5672/, localPort= 60807]
24-08-22.16:20:06.920 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:20:06.920 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:20:06.937 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.548 seconds (JVM running for 14.82)
24-08-22.16:20:07.233 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653480369
24-08-22.16:20:07.235 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265348037
24-08-22.16:20:08.227 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:20:08.228 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:20:08.228 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653480369, 101, OpenAI 增加使用次数, 2024-08-22 16:20:07.233, create, 1033414463858388992]
24-08-22.16:20:08.630 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:20:08.630 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:20:08.630 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265348037","timeStamp":"2024-08-22 16:20:07.235"}, 18265348037, create, 1033414466060398593]
24-08-22.16:20:09.242 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:20:09.295 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:20:09.295 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:20:09.733 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:20:10.001 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:20:10.003 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:20:10.003 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:20:10.003 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:20:10.003 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:20:10.004 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:20:10.005 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:20:10.057 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:20:10.066 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:20:10.067 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:20:10.074 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:20:54.776 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 14104 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:20:54.777 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:20:56.407 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:20:56.412 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:20:56.488 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 55 ms. Found 0 Redis repository interfaces.
24-08-22.16:20:57.017 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:20:57.031 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:20:57.303 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$e5d31448] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:20:58.509 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:20:59.168 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:20:59.542 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:20:59.941 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:21:01.303 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:21:01.318 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:21:01.896 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:21:06.724 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:21:06.737 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:21:06.738 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:21:06.738 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:21:06.740 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:21:06.740 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:21:06.740 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:21:06.740 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@35c55050
24-08-22.16:21:06.889 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:21:07.008 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:21:07.278 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4164ab12:0/SimpleConnection@1b131102 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 60931]
24-08-22.16:21:07.923 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:21:07.923 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:21:07.939 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.659 seconds (JVM running for 14.785)
24-08-22.16:21:08.235 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653505955
24-08-22.16:21:08.239 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350595
24-08-22.16:21:09.234 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:09.235 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:09.235 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653505955, 101, OpenAI 增加使用次数, 2024-08-22 16:21:08.236, create, 1033414719668989952]
24-08-22.16:21:09.521 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:09.521 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:09.521 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350595","timeStamp":"2024-08-22 16:21:08.239"}, 18265350595, create, 1033414721451569153]
24-08-22.16:21:09.946 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350595","timeStamp":"2024-08-22 16:21:08.239"}
24-08-22.16:21:09.999 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350595","timeStamp":"2024-08-22 16:21:08.239"}
24-08-22.16:21:09.999 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:09.999 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:10.000 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350595]
24-08-22.16:21:10.000 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350595]
24-08-22.16:21:10.000 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:10.075 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:10.242 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:10.243 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:10.243 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:10.243 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:10.610 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653506951
24-08-22.16:21:10.611 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350695
24-08-22.16:21:10.612 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:10.612 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:10.612 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653506951, 101, OpenAI 增加使用次数, 2024-08-22 16:21:10.61, create, 1033414726069497856]
24-08-22.16:21:10.748 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:10.749 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:10.749 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350695","timeStamp":"2024-08-22 16:21:10.611"}, 18265350695, create, 1033414726639923201]
24-08-22.16:21:11.135 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350695","timeStamp":"2024-08-22 16:21:10.611"}
24-08-22.16:21:11.136 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:11.136 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:11.136 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350695]
24-08-22.16:21:11.136 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350695]
24-08-22.16:21:11.174 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350695","timeStamp":"2024-08-22 16:21:10.611"}
24-08-22.16:21:11.729 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653507420
24-08-22.16:21:11.729 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350742
24-08-22.16:21:11.730 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:11.730 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:11.730 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653507420, 101, OpenAI 增加使用次数, 2024-08-22 16:21:11.729, create, 1033414730758729728]
24-08-22.16:21:11.942 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:11.943 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:11.943 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350742","timeStamp":"2024-08-22 16:21:11.729"}, 18265350742, create, 1033414731647922177]
24-08-22.16:21:12.296 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350742","timeStamp":"2024-08-22 16:21:11.729"}
24-08-22.16:21:12.297 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:12.298 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:12.298 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350742]
24-08-22.16:21:12.298 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350742]
24-08-22.16:21:12.341 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350742","timeStamp":"2024-08-22 16:21:11.729"}
24-08-22.16:21:12.912 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653507917
24-08-22.16:21:12.912 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350791
24-08-22.16:21:12.913 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:12.913 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:12.913 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653507917, 101, OpenAI 增加使用次数, 2024-08-22 16:21:12.912, create, 1033414735720591360]
24-08-22.16:21:13.091 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:13.091 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:13.091 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350791","timeStamp":"2024-08-22 16:21:12.912"}, 18265350791, create, 1033414736462983169]
24-08-22.16:21:13.455 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350791","timeStamp":"2024-08-22 16:21:12.912"}
24-08-22.16:21:13.455 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:13.455 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:13.456 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350791]
24-08-22.16:21:13.456 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350791]
24-08-22.16:21:13.494 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350791","timeStamp":"2024-08-22 16:21:12.912"}
24-08-22.16:21:14.051 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653508394
24-08-22.16:21:14.051 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350839
24-08-22.16:21:14.052 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:14.052 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:14.052 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653508394, 101, OpenAI 增加使用次数, 2024-08-22 16:21:14.051, create, 1033414740497903616]
24-08-22.16:21:14.282 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:14.283 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:14.283 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350839","timeStamp":"2024-08-22 16:21:14.051"}, 18265350839, create, 1033414741462593537]
24-08-22.16:21:14.645 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350839","timeStamp":"2024-08-22 16:21:14.051"}
24-08-22.16:21:14.646 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:14.646 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:14.646 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350839]
24-08-22.16:21:14.646 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350839]
24-08-22.16:21:14.684 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350839","timeStamp":"2024-08-22 16:21:14.051"}
24-08-22.16:21:15.003 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:15.005 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:15.061 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:15.269 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653508905
24-08-22.16:21:15.269 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350890
24-08-22.16:21:15.270 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:15.271 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:15.271 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653508905, 101, OpenAI 增加使用次数, 2024-08-22 16:21:15.269, create, 1033414745606565888]
24-08-22.16:21:15.402 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:15.402 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:15.402 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350890","timeStamp":"2024-08-22 16:21:15.269"}, 18265350890, create, 1033414746160214017]
24-08-22.16:21:15.691 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350890","timeStamp":"2024-08-22 16:21:15.269"}
24-08-22.16:21:15.692 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:15.692 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:15.692 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350890]
24-08-22.16:21:15.692 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350890]
24-08-22.16:21:15.748 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350890","timeStamp":"2024-08-22 16:21:15.269"}
24-08-22.16:21:16.309 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653509341
24-08-22.16:21:16.309 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350934
24-08-22.16:21:16.311 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:16.311 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:16.311 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653509341, 101, OpenAI 增加使用次数, 2024-08-22 16:21:16.309, create, 1033414749968642048]
24-08-22.16:21:16.555 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:16.555 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:16.555 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350934","timeStamp":"2024-08-22 16:21:16.309"}, 18265350934, create, 1033414750992052225]
24-08-22.16:21:16.933 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350934","timeStamp":"2024-08-22 16:21:16.309"}
24-08-22.16:21:16.934 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:16.934 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:16.934 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350934]
24-08-22.16:21:16.934 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350934]
24-08-22.16:21:16.971 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350934","timeStamp":"2024-08-22 16:21:16.309"}
24-08-22.16:21:17.537 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653509856
24-08-22.16:21:17.537 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265350985
24-08-22.16:21:17.538 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:17.538 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:17.538 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653509856, 101, OpenAI 增加使用次数, 2024-08-22 16:21:17.537, create, 1033414755119247360]
24-08-22.16:21:17.704 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:17.704 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:17.704 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350985","timeStamp":"2024-08-22 16:21:17.537"}, 18265350985, create, 1033414755815501825]
24-08-22.16:21:18.093 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350985","timeStamp":"2024-08-22 16:21:17.537"}
24-08-22.16:21:18.094 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:18.096 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:18.096 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350985]
24-08-22.16:21:18.096 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265350985]
24-08-22.16:21:18.144 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265350985","timeStamp":"2024-08-22 16:21:17.537"}
24-08-22.16:21:18.691 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653510340
24-08-22.16:21:18.691 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351034
24-08-22.16:21:18.692 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:18.692 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:18.692 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653510340, 101, OpenAI 增加使用次数, 2024-08-22 16:21:18.691, create, 1033414759959474176]
24-08-22.16:21:18.863 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:18.864 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:18.864 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351034","timeStamp":"2024-08-22 16:21:18.691"}, 18265351034, create, 1033414760676700161]
24-08-22.16:21:19.303 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351034","timeStamp":"2024-08-22 16:21:18.691"}
24-08-22.16:21:19.305 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:19.305 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:19.305 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351034]
24-08-22.16:21:19.305 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351034]
24-08-22.16:21:19.363 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351034","timeStamp":"2024-08-22 16:21:18.691"}
24-08-22.16:21:19.949 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653510868
24-08-22.16:21:19.949 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351086
24-08-22.16:21:19.951 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:19.951 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:19.951 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653510868, 101, OpenAI 增加使用次数, 2024-08-22 16:21:19.949, create, 1033414765235908608]
24-08-22.16:21:20.013 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:20.066 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:20.067 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:20.067 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:20.067 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:20.067 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:20.134 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:20.134 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:20.134 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351086","timeStamp":"2024-08-22 16:21:19.949"}, 18265351086, create, 1033414766003466241]
24-08-22.16:21:20.557 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351086","timeStamp":"2024-08-22 16:21:19.949"}
24-08-22.16:21:20.558 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:20.558 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:20.558 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351086]
24-08-22.16:21:20.558 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351086]
24-08-22.16:21:20.602 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351086","timeStamp":"2024-08-22 16:21:19.949"}
24-08-22.16:21:21.152 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653511373
24-08-22.16:21:21.153 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351137
24-08-22.16:21:21.154 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:21.154 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:21.154 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653511373, 101, OpenAI 增加使用次数, 2024-08-22 16:21:21.153, create, 1033414770281656320]
24-08-22.16:21:21.327 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:21.327 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:21.327 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351137","timeStamp":"2024-08-22 16:21:21.153"}, 18265351137, create, 1033414771007270913]
24-08-22.16:21:21.694 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351137","timeStamp":"2024-08-22 16:21:21.153"}
24-08-22.16:21:21.696 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:21.696 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:21.696 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351137]
24-08-22.16:21:21.696 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351137]
24-08-22.16:21:21.750 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351137","timeStamp":"2024-08-22 16:21:21.153"}
24-08-22.16:21:22.302 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653511855
24-08-22.16:21:22.302 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351185
24-08-22.16:21:22.303 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:22.303 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:22.303 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653511855, 101, OpenAI 增加使用次数, 2024-08-22 16:21:22.302, create, 1033414775105105920]
24-08-22.16:21:22.507 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:22.507 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:22.507 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351185","timeStamp":"2024-08-22 16:21:22.302"}, 18265351185, create, 1033414775960743937]
24-08-22.16:21:22.904 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351185","timeStamp":"2024-08-22 16:21:22.302"}
24-08-22.16:21:22.905 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:22.905 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:22.905 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351185]
24-08-22.16:21:22.905 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351185]
24-08-22.16:21:22.943 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351185","timeStamp":"2024-08-22 16:21:22.302"}
24-08-22.16:21:23.503 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653512359
24-08-22.16:21:23.503 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351235
24-08-22.16:21:23.504 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:23.504 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:23.504 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653512359, 101, OpenAI 增加使用次数, 2024-08-22 16:21:23.503, create, 1033414780142465024]
24-08-22.16:21:23.704 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:23.705 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:23.705 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351235","timeStamp":"2024-08-22 16:21:23.503"}, 18265351235, create, 1033414780981325825]
24-08-22.16:21:24.124 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351235","timeStamp":"2024-08-22 16:21:23.503"}
24-08-22.16:21:24.125 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:24.125 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:24.125 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351235]
24-08-22.16:21:24.125 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351235]
24-08-22.16:21:24.162 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351235","timeStamp":"2024-08-22 16:21:23.503"}
24-08-22.16:21:24.714 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653512867
24-08-22.16:21:24.714 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351286
24-08-22.16:21:24.715 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:24.716 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:24.716 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653512867, 101, OpenAI 增加使用次数, 2024-08-22 16:21:24.714, create, 1033414785221767168]
24-08-22.16:21:24.904 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:24.904 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:24.904 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351286","timeStamp":"2024-08-22 16:21:24.714"}, 18265351286, create, 1033414786010296321]
24-08-22.16:21:25.012 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:25.013 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:25.013 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:25.014 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:25.014 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:25.064 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:25.293 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351286","timeStamp":"2024-08-22 16:21:24.714"}
24-08-22.16:21:25.294 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:25.294 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:25.294 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351286]
24-08-22.16:21:25.294 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351286]
24-08-22.16:21:25.344 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351286","timeStamp":"2024-08-22 16:21:24.714"}
24-08-22.16:21:25.902 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653513365
24-08-22.16:21:25.902 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351336
24-08-22.16:21:25.903 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:25.903 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:25.903 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653513365, 101, OpenAI 增加使用次数, 2024-08-22 16:21:25.902, create, 1033414790200406016]
24-08-22.16:21:26.074 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:26.074 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:26.075 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351336","timeStamp":"2024-08-22 16:21:25.902"}, 18265351336, create, 1033414790921826305]
24-08-22.16:21:26.483 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351336","timeStamp":"2024-08-22 16:21:25.902"}
24-08-22.16:21:26.484 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:26.484 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:26.484 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351336]
24-08-22.16:21:26.484 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351336]
24-08-22.16:21:26.533 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351336","timeStamp":"2024-08-22 16:21:25.902"}
24-08-22.16:21:27.104 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653513869
24-08-22.16:21:27.104 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351386
24-08-22.16:21:27.107 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:27.107 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:27.107 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653513869, 101, OpenAI 增加使用次数, 2024-08-22 16:21:27.104, create, 1033414795250348032]
24-08-22.16:21:27.306 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:27.306 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:27.306 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351386","timeStamp":"2024-08-22 16:21:27.104"}, 18265351386, create, 1033414796085014529]
24-08-22.16:21:27.721 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351386","timeStamp":"2024-08-22 16:21:27.104"}
24-08-22.16:21:27.722 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:27.722 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:27.722 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351386]
24-08-22.16:21:27.722 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351386]
24-08-22.16:21:27.775 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351386","timeStamp":"2024-08-22 16:21:27.104"}
24-08-22.16:21:28.334 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653514385
24-08-22.16:21:28.334 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351438
24-08-22.16:21:28.335 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:28.335 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:28.335 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653514385, 101, OpenAI 增加使用次数, 2024-08-22 16:21:28.334, create, 1033414800405147648]
24-08-22.16:21:28.504 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:28.505 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:28.505 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351438","timeStamp":"2024-08-22 16:21:28.334"}, 18265351438, create, 1033414801113985025]
24-08-22.16:21:28.933 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351438","timeStamp":"2024-08-22 16:21:28.334"}
24-08-22.16:21:28.934 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:28.934 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:28.935 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351438]
24-08-22.16:21:28.935 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351438]
24-08-22.16:21:28.973 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351438","timeStamp":"2024-08-22 16:21:28.334"}
24-08-22.16:21:29.523 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653514884
24-08-22.16:21:29.523 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351488
24-08-22.16:21:29.524 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:29.524 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:29.524 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653514884, 101, OpenAI 增加使用次数, 2024-08-22 16:21:29.523, create, 1033414805392175104]
24-08-22.16:21:29.725 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:29.725 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:29.725 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351488","timeStamp":"2024-08-22 16:21:29.523"}, 18265351488, create, 1033414806231035905]
24-08-22.16:21:30.003 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:30.005 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:30.005 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:30.005 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:30.005 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:30.042 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:30.174 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351488","timeStamp":"2024-08-22 16:21:29.523"}
24-08-22.16:21:30.175 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:30.175 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:30.175 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351488]
24-08-22.16:21:30.175 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351488]
24-08-22.16:21:30.242 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351488","timeStamp":"2024-08-22 16:21:29.523"}
24-08-22.16:21:30.799 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653515419
24-08-22.16:21:30.799 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351541
24-08-22.16:21:30.801 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:30.801 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:30.801 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653515419, 101, OpenAI 增加使用次数, 2024-08-22 16:21:30.799, create, 1033414810744107008]
24-08-22.16:21:30.961 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:30.961 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:30.961 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351541","timeStamp":"2024-08-22 16:21:30.799"}, 18265351541, create, 1033414811419389953]
24-08-22.16:21:31.321 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351541","timeStamp":"2024-08-22 16:21:30.799"}
24-08-22.16:21:31.322 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:31.322 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:31.322 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351541]
24-08-22.16:21:31.322 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351541]
24-08-22.16:21:31.365 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351541","timeStamp":"2024-08-22 16:21:30.799"}
24-08-22.16:21:31.921 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653515890
24-08-22.16:21:31.921 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351589
24-08-22.16:21:31.922 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:31.922 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:31.922 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653515890, 101, OpenAI 增加使用次数, 2024-08-22 16:21:31.921, create, 1033414815450116096]
24-08-22.16:21:32.093 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:32.093 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:32.093 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351589","timeStamp":"2024-08-22 16:21:31.921"}, 18265351589, create, 1033414816163147777]
24-08-22.16:21:32.431 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351589","timeStamp":"2024-08-22 16:21:31.921"}
24-08-22.16:21:32.432 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:32.432 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:32.432 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351589]
24-08-22.16:21:32.432 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351589]
24-08-22.16:21:32.471 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351589","timeStamp":"2024-08-22 16:21:31.921"}
24-08-22.16:21:33.029 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653516354
24-08-22.16:21:33.029 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351635
24-08-22.16:21:33.030 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:33.030 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:33.030 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653516354, 101, OpenAI 增加使用次数, 2024-08-22 16:21:33.029, create, 1033414820097404928]
24-08-22.16:21:33.262 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:33.262 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:33.262 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351635","timeStamp":"2024-08-22 16:21:33.029"}, 18265351635, create, 1033414821070483457]
24-08-22.16:21:33.622 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351635","timeStamp":"2024-08-22 16:21:33.029"}
24-08-22.16:21:33.623 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:33.623 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:33.623 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351635]
24-08-22.16:21:33.623 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351635]
24-08-22.16:21:33.664 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351635","timeStamp":"2024-08-22 16:21:33.029"}
24-08-22.16:21:34.215 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653516852
24-08-22.16:21:34.215 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351685
24-08-22.16:21:34.217 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:34.217 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:34.217 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653516852, 101, OpenAI 增加使用次数, 2024-08-22 16:21:34.215, create, 1033414825076043776]
24-08-22.16:21:34.383 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:34.383 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:34.383 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351685","timeStamp":"2024-08-22 16:21:34.215"}, 18265351685, create, 1033414825772298241]
24-08-22.16:21:34.742 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351685","timeStamp":"2024-08-22 16:21:34.215"}
24-08-22.16:21:34.743 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:34.743 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:34.743 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351685]
24-08-22.16:21:34.743 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351685]
24-08-22.16:21:34.782 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351685","timeStamp":"2024-08-22 16:21:34.215"}
24-08-22.16:21:35.000 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:35.048 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:35.050 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:35.050 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:35.050 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:35.050 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:35.325 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653517317
24-08-22.16:21:35.325 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351731
24-08-22.16:21:35.326 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:35.326 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:35.326 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653517317, 101, OpenAI 增加使用次数, 2024-08-22 16:21:35.325, create, 1033414829723332608]
24-08-22.16:21:35.451 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:35.451 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:35.451 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351731","timeStamp":"2024-08-22 16:21:35.325"}, 18265351731, create, 1033414830251814913]
24-08-22.16:21:35.821 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351731","timeStamp":"2024-08-22 16:21:35.325"}
24-08-22.16:21:35.821 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:35.822 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:35.822 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351731]
24-08-22.16:21:35.822 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351731]
24-08-22.16:21:35.860 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351731","timeStamp":"2024-08-22 16:21:35.325"}
24-08-22.16:21:36.416 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653517775
24-08-22.16:21:36.416 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351777
24-08-22.16:21:36.417 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:36.417 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:36.417 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653517775, 101, OpenAI 增加使用次数, 2024-08-22 16:21:36.416, create, 1033414834303512576]
24-08-22.16:21:36.642 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:36.642 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:36.642 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351777","timeStamp":"2024-08-22 16:21:36.416"}, 18265351777, create, 1033414835238842369]
24-08-22.16:21:37.029 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351777","timeStamp":"2024-08-22 16:21:36.416"}
24-08-22.16:21:37.030 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:37.030 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:37.030 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351777]
24-08-22.16:21:37.030 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351777]
24-08-22.16:21:37.093 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351777","timeStamp":"2024-08-22 16:21:36.416"}
24-08-22.16:21:37.659 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653518296
24-08-22.16:21:37.659 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351829
24-08-22.16:21:37.660 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:37.660 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:37.660 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653518296, 101, OpenAI 增加使用次数, 2024-08-22 16:21:37.659, create, 1033414839517032448]
24-08-22.16:21:37.899 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:37.899 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:37.899 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351829","timeStamp":"2024-08-22 16:21:37.659"}, 18265351829, create, 1033414840519471105]
24-08-22.16:21:38.279 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351829","timeStamp":"2024-08-22 16:21:37.659"}
24-08-22.16:21:38.280 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:38.280 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:38.280 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351829]
24-08-22.16:21:38.280 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351829]
24-08-22.16:21:38.321 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351829","timeStamp":"2024-08-22 16:21:37.659"}
24-08-22.16:21:38.887 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653518811
24-08-22.16:21:38.887 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351881
24-08-22.16:21:38.887 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:38.887 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:38.887 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653518811, 101, OpenAI 增加使用次数, 2024-08-22 16:21:38.887, create, 1033414844663443456]
24-08-22.16:21:39.081 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:39.082 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:39.082 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351881","timeStamp":"2024-08-22 16:21:38.887"}, 18265351881, create, 1033414845477138433]
24-08-22.16:21:39.440 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351881","timeStamp":"2024-08-22 16:21:38.887"}
24-08-22.16:21:39.441 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:39.441 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:39.441 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351881]
24-08-22.16:21:39.441 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351881]
24-08-22.16:21:39.481 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351881","timeStamp":"2024-08-22 16:21:38.887"}
24-08-22.16:21:40.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:40.037 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653519294
24-08-22.16:21:40.037 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351929
24-08-22.16:21:40.039 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:40.039 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:40.039 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653519294, 101, OpenAI 增加使用次数, 2024-08-22 16:21:40.037, create, 1033414849491087360]
24-08-22.16:21:40.053 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:40.092 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:40.092 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:40.093 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:40.093 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:40.211 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:40.211 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:40.211 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351929","timeStamp":"2024-08-22 16:21:40.037"}, 18265351929, create, 1033414850212507649]
24-08-22.16:21:40.601 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351929","timeStamp":"2024-08-22 16:21:40.037"}
24-08-22.16:21:40.602 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:40.602 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:40.602 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351929]
24-08-22.16:21:40.602 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351929]
24-08-22.16:21:40.656 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351929","timeStamp":"2024-08-22 16:21:40.037"}
24-08-22.16:21:41.211 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653519786
24-08-22.16:21:41.211 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265351978
24-08-22.16:21:41.212 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:41.212 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:41.212 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653519786, 101, OpenAI 增加使用次数, 2024-08-22 16:21:41.211, create, 1033414854411005952]
24-08-22.16:21:41.402 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:41.403 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:41.403 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351978","timeStamp":"2024-08-22 16:21:41.211"}, 18265351978, create, 1033414855212118017]
24-08-22.16:21:41.781 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351978","timeStamp":"2024-08-22 16:21:41.211"}
24-08-22.16:21:41.782 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:41.782 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:41.782 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351978]
24-08-22.16:21:41.782 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265351978]
24-08-22.16:21:41.828 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265351978","timeStamp":"2024-08-22 16:21:41.211"}
24-08-22.16:21:42.370 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653520272
24-08-22.16:21:42.370 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352027
24-08-22.16:21:42.371 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:42.371 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:42.371 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653520272, 101, OpenAI 增加使用次数, 2024-08-22 16:21:42.37, create, 1033414859276398592]
24-08-22.16:21:42.612 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:42.612 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:42.612 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352027","timeStamp":"2024-08-22 16:21:42.37"}, 18265352027, create, 1033414860283031553]
24-08-22.16:21:42.989 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352027","timeStamp":"2024-08-22 16:21:42.37"}
24-08-22.16:21:42.989 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:42.989 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:42.989 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352027]
24-08-22.16:21:42.990 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352027]
24-08-22.16:21:43.031 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352027","timeStamp":"2024-08-22 16:21:42.37"}
24-08-22.16:21:43.592 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653520785
24-08-22.16:21:43.592 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352078
24-08-22.16:21:43.593 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:43.593 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:43.593 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653520785, 101, OpenAI 增加使用次数, 2024-08-22 16:21:43.592, create, 1033414864401838080]
24-08-22.16:21:43.765 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:43.765 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:43.765 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352078","timeStamp":"2024-08-22 16:21:43.592"}, 18265352078, create, 1033414865119064065]
24-08-22.16:21:44.091 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352078","timeStamp":"2024-08-22 16:21:43.592"}
24-08-22.16:21:44.092 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:44.092 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:44.092 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352078]
24-08-22.16:21:44.092 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352078]
24-08-22.16:21:44.132 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352078","timeStamp":"2024-08-22 16:21:43.592"}
24-08-22.16:21:44.683 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653521242
24-08-22.16:21:44.683 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352124
24-08-22.16:21:44.685 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:44.685 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:44.685 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653521242, 101, OpenAI 增加使用次数, 2024-08-22 16:21:44.683, create, 1033414868973629440]
24-08-22.16:21:44.889 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:44.889 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:44.889 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352124","timeStamp":"2024-08-22 16:21:44.683"}, 18265352124, create, 1033414869833461761]
24-08-22.16:21:45.008 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:45.052 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:45.053 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:45.053 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:45.053 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:45.053 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:45.261 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352124","timeStamp":"2024-08-22 16:21:44.683"}
24-08-22.16:21:45.262 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:45.262 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:45.262 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352124]
24-08-22.16:21:45.262 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352124]
24-08-22.16:21:45.302 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352124","timeStamp":"2024-08-22 16:21:44.683"}
24-08-22.16:21:45.850 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653521732
24-08-22.16:21:45.850 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352173
24-08-22.16:21:45.852 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:45.852 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:45.852 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653521732, 101, OpenAI 增加使用次数, 2024-08-22 16:21:45.85, create, 1033414873868382208]
24-08-22.16:21:46.022 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:46.022 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:46.022 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352173","timeStamp":"2024-08-22 16:21:45.85"}, 18265352173, create, 1033414874585608193]
24-08-22.16:21:46.361 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352173","timeStamp":"2024-08-22 16:21:45.85"}
24-08-22.16:21:46.362 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:46.362 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:46.362 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352173]
24-08-22.16:21:46.362 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352173]
24-08-22.16:21:46.401 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352173","timeStamp":"2024-08-22 16:21:45.85"}
24-08-22.16:21:46.957 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653522196
24-08-22.16:21:46.957 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352219
24-08-22.16:21:46.959 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:46.959 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:46.959 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653522196, 101, OpenAI 增加使用次数, 2024-08-22 16:21:46.957, create, 1033414878515671040]
24-08-22.16:21:47.121 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:47.121 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:47.121 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352219","timeStamp":"2024-08-22 16:21:46.957"}, 18265352219, create, 1033414879199342593]
24-08-22.16:21:47.492 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352219","timeStamp":"2024-08-22 16:21:46.957"}
24-08-22.16:21:47.493 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:47.493 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:47.493 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352219]
24-08-22.16:21:47.493 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352219]
24-08-22.16:21:47.548 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352219","timeStamp":"2024-08-22 16:21:46.957"}
24-08-22.16:21:48.113 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653522681
24-08-22.16:21:48.113 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352268
24-08-22.16:21:48.114 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:48.114 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:48.114 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653522681, 101, OpenAI 增加使用次数, 2024-08-22 16:21:48.113, create, 1033414883360092160]
24-08-22.16:21:48.281 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:48.281 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:48.281 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352268","timeStamp":"2024-08-22 16:21:48.113"}, 18265352268, create, 1033414884064735233]
24-08-22.16:21:48.611 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352268","timeStamp":"2024-08-22 16:21:48.113"}
24-08-22.16:21:48.612 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:48.612 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:48.612 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352268]
24-08-22.16:21:48.612 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352268]
24-08-22.16:21:48.650 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352268","timeStamp":"2024-08-22 16:21:48.113"}
24-08-22.16:21:49.207 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653523140
24-08-22.16:21:49.207 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352314
24-08-22.16:21:49.208 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:49.208 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:49.208 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653523140, 101, OpenAI 增加使用次数, 2024-08-22 16:21:49.207, create, 1033414887952855040]
24-08-22.16:21:49.380 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:49.380 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:49.380 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352314","timeStamp":"2024-08-22 16:21:49.207"}, 18265352314, create, 1033414888674275329]
24-08-22.16:21:49.761 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352314","timeStamp":"2024-08-22 16:21:49.207"}
24-08-22.16:21:49.761 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:49.761 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:49.761 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352314]
24-08-22.16:21:49.761 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352314]
24-08-22.16:21:49.806 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352314","timeStamp":"2024-08-22 16:21:49.207"}
24-08-22.16:21:50.002 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:50.051 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:50.125 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:50.125 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:50.126 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:50.126 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:50.360 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653523623
24-08-22.16:21:50.360 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352362
24-08-22.16:21:50.361 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:50.361 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:50.361 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653523623, 101, OpenAI 增加使用次数, 2024-08-22 16:21:50.36, create, 1033414892788887552]
24-08-22.16:21:50.491 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:50.491 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:50.491 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352362","timeStamp":"2024-08-22 16:21:50.36"}, 18265352362, create, 1033414893329952769]
24-08-22.16:21:50.891 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352362","timeStamp":"2024-08-22 16:21:50.36"}
24-08-22.16:21:50.892 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:50.892 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:50.892 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352362]
24-08-22.16:21:50.892 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352362]
24-08-22.16:21:50.929 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352362","timeStamp":"2024-08-22 16:21:50.36"}
24-08-22.16:21:51.481 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653524094
24-08-22.16:21:51.481 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352409
24-08-22.16:21:51.482 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:51.482 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:51.482 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653524094, 101, OpenAI 增加使用次数, 2024-08-22 16:21:51.481, create, 1033414897490702336]
24-08-22.16:21:51.641 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:51.641 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:51.641 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352409","timeStamp":"2024-08-22 16:21:51.481"}, 18265352409, create, 1033414898157596673]
24-08-22.16:21:52.058 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352409","timeStamp":"2024-08-22 16:21:51.481"}
24-08-22.16:21:52.059 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:52.059 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:52.059 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352409]
24-08-22.16:21:52.059 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352409]
24-08-22.16:21:52.111 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352409","timeStamp":"2024-08-22 16:21:51.481"}
24-08-22.16:21:52.681 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653524597
24-08-22.16:21:52.681 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352459
24-08-22.16:21:52.681 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:52.681 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:52.681 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653524597, 101, OpenAI 增加使用次数, 2024-08-22 16:21:52.681, create, 1033414902519672832]
24-08-22.16:21:52.863 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:52.863 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:52.863 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352459","timeStamp":"2024-08-22 16:21:52.681"}, 18265352459, create, 1033414903283036161]
24-08-22.16:21:53.230 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352459","timeStamp":"2024-08-22 16:21:52.681"}
24-08-22.16:21:53.231 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:53.231 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:53.231 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352459]
24-08-22.16:21:53.231 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352459]
24-08-22.16:21:53.279 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352459","timeStamp":"2024-08-22 16:21:52.681"}
24-08-22.16:21:53.851 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653525088
24-08-22.16:21:53.851 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352508
24-08-22.16:21:53.853 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:53.853 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:53.853 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653525088, 101, OpenAI 增加使用次数, 2024-08-22 16:21:53.851, create, 1033414907431202816]
24-08-22.16:21:54.062 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:54.062 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:54.062 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352508","timeStamp":"2024-08-22 16:21:53.851"}, 18265352508, create, 1033414908312006657]
24-08-22.16:21:54.402 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352508","timeStamp":"2024-08-22 16:21:53.851"}
24-08-22.16:21:54.402 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:54.402 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:54.402 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352508]
24-08-22.16:21:54.402 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352508]
24-08-22.16:21:54.440 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352508","timeStamp":"2024-08-22 16:21:53.851"}
24-08-22.16:21:55.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:55.001 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653525570
24-08-22.16:21:55.001 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352557
24-08-22.16:21:55.002 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:55.002 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:55.002 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653525570, 101, OpenAI 增加使用次数, 2024-08-22 16:21:55.001, create, 1033414912250458112]
24-08-22.16:21:55.042 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:21:55.044 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:21:55.044 [pool-7-thread-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:21:55.044 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:55.044 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:21:55.171 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:55.171 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:55.171 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352557","timeStamp":"2024-08-22 16:21:55.001"}, 18265352557, create, 1033414912959295489]
24-08-22.16:21:55.510 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352557","timeStamp":"2024-08-22 16:21:55.001"}
24-08-22.16:21:55.510 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:55.510 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:55.510 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352557]
24-08-22.16:21:55.510 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352557]
24-08-22.16:21:55.550 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352557","timeStamp":"2024-08-22 16:21:55.001"}
24-08-22.16:21:56.095 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653526029
24-08-22.16:21:56.095 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352602
24-08-22.16:21:56.096 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:56.096 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:56.096 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653526029, 101, OpenAI 增加使用次数, 2024-08-22 16:21:56.095, create, 1033414916843220992]
24-08-22.16:21:56.282 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:56.282 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:56.282 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352602","timeStamp":"2024-08-22 16:21:56.095"}, 18265352602, create, 1033414917623361537]
24-08-22.16:21:56.661 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352602","timeStamp":"2024-08-22 16:21:56.095"}
24-08-22.16:21:56.661 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:56.661 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:56.661 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352602]
24-08-22.16:21:56.661 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352602]
24-08-22.16:21:56.701 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352602","timeStamp":"2024-08-22 16:21:56.095"}
24-08-22.16:21:57.246 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653526512
24-08-22.16:21:57.246 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352651
24-08-22.16:21:57.247 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:57.247 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:57.247 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653526512, 101, OpenAI 增加使用次数, 2024-08-22 16:21:57.246, create, 1033414921670864896]
24-08-22.16:21:57.413 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:57.413 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:57.413 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352651","timeStamp":"2024-08-22 16:21:57.246"}, 18265352651, create, 1033414922362925057]
24-08-22.16:21:57.782 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352651","timeStamp":"2024-08-22 16:21:57.246"}
24-08-22.16:21:57.783 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:57.783 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:57.783 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352651]
24-08-22.16:21:57.783 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352651]
24-08-22.16:21:57.831 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352651","timeStamp":"2024-08-22 16:21:57.246"}
24-08-22.16:21:58.388 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653526991
24-08-22.16:21:58.388 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352699
24-08-22.16:21:58.390 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:58.390 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:58.390 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653526991, 101, OpenAI 增加使用次数, 2024-08-22 16:21:58.388, create, 1033414926460760064]
24-08-22.16:21:58.581 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:58.581 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:58.581 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352699","timeStamp":"2024-08-22 16:21:58.388"}, 18265352699, create, 1033414927266066433]
24-08-22.16:21:58.940 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352699","timeStamp":"2024-08-22 16:21:58.388"}
24-08-22.16:21:58.941 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:21:58.941 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:21:58.941 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352699]
24-08-22.16:21:58.941 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352699]
24-08-22.16:21:59.012 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352699","timeStamp":"2024-08-22 16:21:58.388"}
24-08-22.16:21:59.571 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653527487
24-08-22.16:21:59.571 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352748
24-08-22.16:21:59.571 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:21:59.571 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:59.571 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653527487, 101, OpenAI 增加使用次数, 2024-08-22 16:21:59.571, create, 1033414931418427392]
24-08-22.16:21:59.780 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:21:59.780 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:21:59.780 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352748","timeStamp":"2024-08-22 16:21:59.571"}, 18265352748, create, 1033414932295036929]
24-08-22.16:22:00.006 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:22:00.060 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:22:00.062 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:22:00.062 [pool-7-thread-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:22:00.062 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:22:00.062 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:22:00.143 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352748","timeStamp":"2024-08-22 16:21:59.571"}
24-08-22.16:22:00.144 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:00.144 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:00.144 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352748]
24-08-22.16:22:00.144 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352748]
24-08-22.16:22:00.185 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352748","timeStamp":"2024-08-22 16:21:59.571"}
24-08-22.16:22:00.748 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653527980
24-08-22.16:22:00.748 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352798
24-08-22.16:22:00.749 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:22:00.749 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:00.749 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653527980, 101, OpenAI 增加使用次数, 2024-08-22 16:22:00.748, create, 1033414936355123200]
24-08-22.16:22:00.966 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:22:00.966 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:00.966 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352798","timeStamp":"2024-08-22 16:22:00.748"}, 18265352798, create, 1033414937265287169]
24-08-22.16:22:01.340 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352798","timeStamp":"2024-08-22 16:22:00.748"}
24-08-22.16:22:01.341 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:01.341 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:01.341 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352798]
24-08-22.16:22:01.341 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352798]
24-08-22.16:22:01.381 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352798","timeStamp":"2024-08-22 16:22:00.748"}
24-08-22.16:22:01.946 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653528483
24-08-22.16:22:01.946 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352848
24-08-22.16:22:01.947 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:22:01.947 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:01.947 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653528483, 101, OpenAI 增加使用次数, 2024-08-22 16:22:01.946, create, 1033414941384093696]
24-08-22.16:22:02.146 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:22:02.146 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:02.146 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352848","timeStamp":"2024-08-22 16:22:01.946"}, 18265352848, create, 1033414942218760193]
24-08-22.16:22:02.533 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352848","timeStamp":"2024-08-22 16:22:01.946"}
24-08-22.16:22:02.533 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:02.533 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:02.533 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352848]
24-08-22.16:22:02.533 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352848]
24-08-22.16:22:02.581 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352848","timeStamp":"2024-08-22 16:22:01.946"}
24-08-22.16:22:03.133 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653528981
24-08-22.16:22:03.133 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352898
24-08-22.16:22:03.134 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:22:03.134 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:03.134 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653528981, 101, OpenAI 增加使用次数, 2024-08-22 16:22:03.133, create, 1033414946358538240]
24-08-22.16:22:03.301 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:22:03.301 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:03.301 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352898","timeStamp":"2024-08-22 16:22:03.133"}, 18265352898, create, 1033414947063181313]
24-08-22.16:22:03.628 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352898","timeStamp":"2024-08-22 16:22:03.133"}
24-08-22.16:22:03.629 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:03.629 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:03.629 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352898]
24-08-22.16:22:03.629 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352898]
24-08-22.16:22:03.670 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352898","timeStamp":"2024-08-22 16:22:03.133"}
24-08-22.16:22:04.225 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653529439
24-08-22.16:22:04.225 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352943
24-08-22.16:22:04.226 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:22:04.226 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:04.226 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653529439, 101, OpenAI 增加使用次数, 2024-08-22 16:22:04.225, create, 1033414950938718208]
24-08-22.16:22:04.391 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:22:04.391 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:04.391 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352943","timeStamp":"2024-08-22 16:22:04.225"}, 18265352943, create, 1033414951634972673]
24-08-22.16:22:04.750 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352943","timeStamp":"2024-08-22 16:22:04.225"}
24-08-22.16:22:04.751 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:04.751 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:04.751 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352943]
24-08-22.16:22:04.751 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352943]
24-08-22.16:22:04.791 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352943","timeStamp":"2024-08-22 16:22:04.225"}
24-08-22.16:22:05.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:22:05.051 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:22:05.093 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:22:05.093 [pool-7-thread-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@24f5f5ab], lock=Optional.empty, window=Optional.empty)
24-08-22.16:22:05.093 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:22:05.093 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:22:05.350 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653529911
24-08-22.16:22:05.350 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265352991
24-08-22.16:22:05.351 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:22:05.351 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:05.351 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653529911, 101, OpenAI 增加使用次数, 2024-08-22 16:22:05.35, create, 1033414955657310208]
24-08-22.16:22:05.483 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:22:05.483 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:05.483 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352991","timeStamp":"2024-08-22 16:22:05.35"}, 18265352991, create, 1033414956210958337]
24-08-22.16:22:05.810 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352991","timeStamp":"2024-08-22 16:22:05.35"}
24-08-22.16:22:05.810 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:05.810 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:05.810 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352991]
24-08-22.16:22:05.810 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265352991]
24-08-22.16:22:05.854 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:${spring.rabbitmq.topic.send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265352991","timeStamp":"2024-08-22 16:22:05.35"}
24-08-22.16:22:06.403 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653530352
24-08-22.16:22:06.403 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265353035
24-08-22.16:22:06.404 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:22:06.404 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:06.404 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653530352, 101, OpenAI 增加使用次数, 2024-08-22 16:22:06.403, create, 1033414960073912320]
24-08-22.16:22:06.472 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:22:06.520 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:22:06.521 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:22:06.571 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:22:06.571 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:22:06.571 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265353035","timeStamp":"2024-08-22 16:22:06.403"}, 18265353035, create, 1033414960774361089]
24-08-22.16:22:06.903 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:22:06.920 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265353035","timeStamp":"2024-08-22 16:22:06.403"}
24-08-22.16:22:06.921 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:06.921 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:06.921 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265353035]
24-08-22.16:22:06.921 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265353035]
24-08-22.16:22:06.923 [main            ] ERROR AwardRepository        - 写入中奖记录，发送MQ消息失败 userId:lyt topic:spring.rabbitmq.topic.send_award
24-08-22.16:22:06.924 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:22:06.924 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:22:06.924 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265353035]
24-08-22.16:22:06.924 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265353035]
24-08-22.16:22:07.275 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:22:07.277 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:22:07.277 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:22:07.277 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:22:07.277 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:22:07.279 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:22:07.279 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:22:07.386 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:22:07.392 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:22:07.392 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:22:07.397 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:24:49.086 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 12576 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:24:49.088 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:24:50.787 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:24:50.792 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:24:50.864 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 0 Redis repository interfaces.
24-08-22.16:24:51.371 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:24:51.384 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:24:51.645 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$7cce6912] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:24:52.796 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:24:53.432 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:24:53.766 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:24:54.142 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:24:55.481 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:24:55.495 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:24:56.079 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:25:00.794 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:25:00.808 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:25:00.808 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:25:00.809 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:25:00.809 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:25:00.809 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:25:00.809 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:25:00.809 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@5e774546
24-08-22.16:25:00.958 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:25:01.073 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:25:01.342 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7dc16d33:0/SimpleConnection@11501f90 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 61242]
24-08-22.16:25:01.959 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:25:01.959 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:25:01.975 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.448 seconds (JVM running for 14.599)
24-08-22.16:25:02.277 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653604119
24-08-22.16:25:02.279 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360412
24-08-22.16:25:03.378 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:03.378 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:03.379 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653604119, 101, OpenAI 增加使用次数, 2024-08-22 16:25:02.277, create, 1033415701689774080]
24-08-22.16:25:03.667 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:03.667 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:03.667 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360412","timeStamp":"2024-08-22 16:25:02.279"}, 18265360412, create, 1033415703522684929]
24-08-22.16:25:04.161 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360412","timeStamp":"2024-08-22 16:25:02.279"}
24-08-22.16:25:04.213 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:04.213 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:04.213 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360412]
24-08-22.16:25:04.213 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360412]
24-08-22.16:25:04.213 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360412","timeStamp":"2024-08-22 16:25:02.279"}
24-08-22.16:25:04.823 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653605187
24-08-22.16:25:04.823 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360518
24-08-22.16:25:04.825 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:04.825 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:04.825 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653605187, 101, OpenAI 增加使用次数, 2024-08-22 16:25:04.823, create, 1033415708430020608]
24-08-22.16:25:05.008 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:05.030 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:05.030 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:05.030 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360518","timeStamp":"2024-08-22 16:25:04.823"}, 18265360518, create, 1033415709285658625]
24-08-22.16:25:05.079 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:05.117 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:05.117 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:05.117 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:05.117 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:05.419 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360518","timeStamp":"2024-08-22 16:25:04.823"}
24-08-22.16:25:05.420 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:05.420 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:05.420 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360518]
24-08-22.16:25:05.420 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360518]
24-08-22.16:25:05.458 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360518","timeStamp":"2024-08-22 16:25:04.823"}
24-08-22.16:25:06.010 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653605685
24-08-22.16:25:06.010 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360568
24-08-22.16:25:06.012 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:06.012 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:06.012 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653605685, 101, OpenAI 增加使用次数, 2024-08-22 16:25:06.01, create, 1033415713404465152]
24-08-22.16:25:06.179 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:06.179 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:06.179 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360568","timeStamp":"2024-08-22 16:25:06.01"}, 18265360568, create, 1033415714109108225]
24-08-22.16:25:06.576 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360568","timeStamp":"2024-08-22 16:25:06.01"}
24-08-22.16:25:06.577 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:06.577 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:06.577 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360568]
24-08-22.16:25:06.577 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360568]
24-08-22.16:25:06.618 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360568","timeStamp":"2024-08-22 16:25:06.01"}
24-08-22.16:25:07.168 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653606171
24-08-22.16:25:07.168 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360617
24-08-22.16:25:07.169 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:07.169 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:07.169 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653606171, 101, OpenAI 增加使用次数, 2024-08-22 16:25:07.168, create, 1033415718261469184]
24-08-22.16:25:07.368 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:07.368 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:07.368 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360617","timeStamp":"2024-08-22 16:25:07.168"}, 18265360617, create, 1033415719096135681]
24-08-22.16:25:07.737 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360617","timeStamp":"2024-08-22 16:25:07.168"}
24-08-22.16:25:07.738 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:07.738 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:07.738 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360617]
24-08-22.16:25:07.738 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360617]
24-08-22.16:25:07.778 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360617","timeStamp":"2024-08-22 16:25:07.168"}
24-08-22.16:25:08.325 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653606656
24-08-22.16:25:08.325 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360665
24-08-22.16:25:08.327 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:08.327 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:08.327 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653606656, 101, OpenAI 增加使用次数, 2024-08-22 16:25:08.325, create, 1033415723114278912]
24-08-22.16:25:08.524 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:08.524 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:08.524 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360665","timeStamp":"2024-08-22 16:25:08.325"}, 18265360665, create, 1033415723940556801]
24-08-22.16:25:08.908 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360665","timeStamp":"2024-08-22 16:25:08.325"}
24-08-22.16:25:08.909 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:08.909 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:08.909 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360665]
24-08-22.16:25:08.909 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360665]
24-08-22.16:25:08.947 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360665","timeStamp":"2024-08-22 16:25:08.325"}
24-08-22.16:25:09.498 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653607148
24-08-22.16:25:09.498 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360714
24-08-22.16:25:09.499 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:09.499 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:09.499 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653607148, 101, OpenAI 增加使用次数, 2024-08-22 16:25:09.498, create, 1033415728030003200]
24-08-22.16:25:09.766 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:09.766 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:09.766 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360714","timeStamp":"2024-08-22 16:25:09.498"}, 18265360714, create, 1033415729149882369]
24-08-22.16:25:10.001 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:10.002 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:10.002 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:10.002 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:10.003 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:10.047 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:10.107 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360714","timeStamp":"2024-08-22 16:25:09.498"}
24-08-22.16:25:10.109 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:10.109 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:10.109 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360714]
24-08-22.16:25:10.109 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360714]
24-08-22.16:25:10.148 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360714","timeStamp":"2024-08-22 16:25:09.498"}
24-08-22.16:25:10.703 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653607653
24-08-22.16:25:10.703 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360765
24-08-22.16:25:10.705 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:10.705 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:10.705 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653607653, 101, OpenAI 增加使用次数, 2024-08-22 16:25:10.703, create, 1033415733092528128]
24-08-22.16:25:10.867 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:10.868 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:10.868 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360765","timeStamp":"2024-08-22 16:25:10.703"}, 18265360765, create, 1033415733772005377]
24-08-22.16:25:11.216 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360765","timeStamp":"2024-08-22 16:25:10.703"}
24-08-22.16:25:11.217 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:11.217 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:11.217 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360765]
24-08-22.16:25:11.217 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360765]
24-08-22.16:25:11.257 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360765","timeStamp":"2024-08-22 16:25:10.703"}
24-08-22.16:25:11.824 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653608124
24-08-22.16:25:11.825 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360812
24-08-22.16:25:11.826 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:11.827 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:11.827 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653608124, 101, OpenAI 增加使用次数, 2024-08-22 16:25:11.825, create, 1033415737794342912]
24-08-22.16:25:11.988 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:11.988 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:11.988 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360812","timeStamp":"2024-08-22 16:25:11.825"}, 18265360812, create, 1033415738469625857]
24-08-22.16:25:12.347 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360812","timeStamp":"2024-08-22 16:25:11.825"}
24-08-22.16:25:12.348 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:12.348 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:12.348 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360812]
24-08-22.16:25:12.348 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360812]
24-08-22.16:25:12.396 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360812","timeStamp":"2024-08-22 16:25:11.825"}
24-08-22.16:25:12.947 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653608595
24-08-22.16:25:12.947 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360859
24-08-22.16:25:12.950 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:12.950 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:12.950 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653608595, 101, OpenAI 增加使用次数, 2024-08-22 16:25:12.947, create, 1033415742500352000]
24-08-22.16:25:13.127 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:13.127 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:13.127 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360859","timeStamp":"2024-08-22 16:25:12.947"}, 18265360859, create, 1033415743246938113]
24-08-22.16:25:13.476 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360859","timeStamp":"2024-08-22 16:25:12.947"}
24-08-22.16:25:13.477 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:13.477 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:13.477 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360859]
24-08-22.16:25:13.477 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360859]
24-08-22.16:25:13.517 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360859","timeStamp":"2024-08-22 16:25:12.947"}
24-08-22.16:25:14.101 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653609079
24-08-22.16:25:14.101 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360907
24-08-22.16:25:14.102 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:14.102 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:14.102 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653609079, 101, OpenAI 增加使用次数, 2024-08-22 16:25:14.101, create, 1033415747340578816]
24-08-22.16:25:14.288 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:14.288 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:14.288 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360907","timeStamp":"2024-08-22 16:25:14.101"}, 18265360907, create, 1033415748116525057]
24-08-22.16:25:14.636 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360907","timeStamp":"2024-08-22 16:25:14.101"}
24-08-22.16:25:14.637 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:14.637 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:14.637 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360907]
24-08-22.16:25:14.637 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360907]
24-08-22.16:25:14.684 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360907","timeStamp":"2024-08-22 16:25:14.101"}
24-08-22.16:25:15.009 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:15.055 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:15.056 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:15.056 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:15.056 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:15.056 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:15.243 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653609558
24-08-22.16:25:15.243 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360955
24-08-22.16:25:15.244 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:15.244 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:15.244 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653609558, 101, OpenAI 增加使用次数, 2024-08-22 16:25:15.243, create, 1033415752126279680]
24-08-22.16:25:15.366 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:15.366 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:15.366 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360955","timeStamp":"2024-08-22 16:25:15.243"}, 18265360955, create, 1033415752642179073]
24-08-22.16:25:15.665 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360955","timeStamp":"2024-08-22 16:25:15.243"}
24-08-22.16:25:15.666 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:15.666 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:15.666 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360955]
24-08-22.16:25:15.666 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360955]
24-08-22.16:25:15.707 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360955","timeStamp":"2024-08-22 16:25:15.243"}
24-08-22.16:25:16.254 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653609982
24-08-22.16:25:16.254 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265360998
24-08-22.16:25:16.255 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:16.255 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:16.255 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653609982, 101, OpenAI 增加使用次数, 2024-08-22 16:25:16.254, create, 1033415756370915328]
24-08-22.16:25:16.427 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:16.427 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:16.427 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360998","timeStamp":"2024-08-22 16:25:16.254"}, 18265360998, create, 1033415757088141313]
24-08-22.16:25:16.799 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360998","timeStamp":"2024-08-22 16:25:16.254"}
24-08-22.16:25:16.800 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:16.800 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:16.800 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360998]
24-08-22.16:25:16.800 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265360998]
24-08-22.16:25:16.845 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265360998","timeStamp":"2024-08-22 16:25:16.254"}
24-08-22.16:25:17.411 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653610467
24-08-22.16:25:17.411 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361046
24-08-22.16:25:17.412 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:17.412 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:17.412 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653610467, 101, OpenAI 增加使用次数, 2024-08-22 16:25:17.411, create, 1033415761219530752]
24-08-22.16:25:17.607 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:17.607 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:17.607 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361046","timeStamp":"2024-08-22 16:25:17.411"}, 18265361046, create, 1033415762037420033]
24-08-22.16:25:18.006 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361046","timeStamp":"2024-08-22 16:25:17.411"}
24-08-22.16:25:18.007 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:18.007 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:18.007 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361046]
24-08-22.16:25:18.007 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361046]
24-08-22.16:25:18.046 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361046","timeStamp":"2024-08-22 16:25:17.411"}
24-08-22.16:25:18.613 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653610971
24-08-22.16:25:18.613 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361097
24-08-22.16:25:18.614 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:18.614 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:18.614 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653610971, 101, OpenAI 增加使用次数, 2024-08-22 16:25:18.613, create, 1033415766265278464]
24-08-22.16:25:18.826 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:18.826 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:18.826 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361097","timeStamp":"2024-08-22 16:25:18.613"}, 18265361097, create, 1033415767154470913]
24-08-22.16:25:19.196 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361097","timeStamp":"2024-08-22 16:25:18.613"}
24-08-22.16:25:19.197 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:19.197 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:19.197 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361097]
24-08-22.16:25:19.197 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361097]
24-08-22.16:25:19.237 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361097","timeStamp":"2024-08-22 16:25:18.613"}
24-08-22.16:25:19.796 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653611467
24-08-22.16:25:19.796 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361146
24-08-22.16:25:19.797 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:19.797 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:19.797 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653611467, 101, OpenAI 增加使用次数, 2024-08-22 16:25:19.796, create, 1033415771227140096]
24-08-22.16:25:19.966 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:19.966 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:19.966 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361146","timeStamp":"2024-08-22 16:25:19.796"}, 18265361146, create, 1033415771935977473]
24-08-22.16:25:20.016 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:20.103 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:20.149 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:20.149 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:20.149 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:20.149 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:20.368 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361146","timeStamp":"2024-08-22 16:25:19.796"}
24-08-22.16:25:20.369 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:20.369 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:20.370 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361146]
24-08-22.16:25:20.370 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361146]
24-08-22.16:25:20.407 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361146","timeStamp":"2024-08-22 16:25:19.796"}
24-08-22.16:25:21.026 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653611983
24-08-22.16:25:21.026 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361198
24-08-22.16:25:21.028 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:21.028 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:21.028 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653611983, 101, OpenAI 增加使用次数, 2024-08-22 16:25:21.026, create, 1033415776390328320]
24-08-22.16:25:21.197 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:21.197 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:21.197 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361198","timeStamp":"2024-08-22 16:25:21.026"}, 18265361198, create, 1033415777099165697]
24-08-22.16:25:21.546 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361198","timeStamp":"2024-08-22 16:25:21.026"}
24-08-22.16:25:21.547 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:21.547 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:21.547 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361198]
24-08-22.16:25:21.547 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361198]
24-08-22.16:25:21.587 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361198","timeStamp":"2024-08-22 16:25:21.026"}
24-08-22.16:25:22.171 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653612463
24-08-22.16:25:22.171 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361246
24-08-22.16:25:22.172 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:22.172 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:22.172 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653612463, 101, OpenAI 增加使用次数, 2024-08-22 16:25:22.171, create, 1033415781188612096]
24-08-22.16:25:22.336 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:22.336 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:22.336 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361246","timeStamp":"2024-08-22 16:25:22.171"}, 18265361246, create, 1033415781876477953]
24-08-22.16:25:22.688 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361246","timeStamp":"2024-08-22 16:25:22.171"}
24-08-22.16:25:22.688 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:22.688 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:22.688 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361246]
24-08-22.16:25:22.688 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361246]
24-08-22.16:25:22.730 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361246","timeStamp":"2024-08-22 16:25:22.171"}
24-08-22.16:25:23.278 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653612928
24-08-22.16:25:23.278 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361292
24-08-22.16:25:23.279 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:23.279 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:23.279 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653612928, 101, OpenAI 增加使用次数, 2024-08-22 16:25:23.278, create, 1033415785831706624]
24-08-22.16:25:23.478 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:23.478 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:23.478 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361292","timeStamp":"2024-08-22 16:25:23.278"}, 18265361292, create, 1033415786666373121]
24-08-22.16:25:23.856 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361292","timeStamp":"2024-08-22 16:25:23.278"}
24-08-22.16:25:23.857 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:23.857 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:23.857 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361292]
24-08-22.16:25:23.857 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361292]
24-08-22.16:25:23.896 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361292","timeStamp":"2024-08-22 16:25:23.278"}
24-08-22.16:25:24.446 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653613418
24-08-22.16:25:24.446 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361341
24-08-22.16:25:24.448 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:24.448 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:24.448 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653613418, 101, OpenAI 增加使用次数, 2024-08-22 16:25:24.446, create, 1033415790730653696]
24-08-22.16:25:24.674 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:24.674 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:24.674 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361341","timeStamp":"2024-08-22 16:25:24.446"}, 18265361341, create, 1033415791682760705]
24-08-22.16:25:24.999 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361341","timeStamp":"2024-08-22 16:25:24.446"}
24-08-22.16:25:25.000 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:25.000 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:25.000 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361341]
24-08-22.16:25:25.000 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361341]
24-08-22.16:25:25.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:25.037 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361341","timeStamp":"2024-08-22 16:25:24.446"}
24-08-22.16:25:25.046 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:25.098 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:25.098 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:25.098 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:25.098 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:25.584 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653613895
24-08-22.16:25:25.584 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361389
24-08-22.16:25:25.585 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:25.585 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:25.585 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653613895, 101, OpenAI 增加使用次数, 2024-08-22 16:25:25.584, create, 1033415795499577344]
24-08-22.16:25:25.707 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:25.707 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:25.707 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361389","timeStamp":"2024-08-22 16:25:25.584"}, 18265361389, create, 1033415796011282433]
24-08-22.16:25:26.065 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361389","timeStamp":"2024-08-22 16:25:25.584"}
24-08-22.16:25:26.066 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:26.066 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:26.066 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361389]
24-08-22.16:25:26.066 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361389]
24-08-22.16:25:26.106 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361389","timeStamp":"2024-08-22 16:25:25.584"}
24-08-22.16:25:26.660 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653614346
24-08-22.16:25:26.660 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361434
24-08-22.16:25:26.661 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:26.661 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:26.661 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653614346, 101, OpenAI 增加使用次数, 2024-08-22 16:25:26.66, create, 1033415800012648448]
24-08-22.16:25:26.827 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:26.827 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:26.827 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361434","timeStamp":"2024-08-22 16:25:26.66"}, 18265361434, create, 1033415800708902913]
24-08-22.16:25:27.196 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361434","timeStamp":"2024-08-22 16:25:26.66"}
24-08-22.16:25:27.197 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:27.197 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:27.197 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361434]
24-08-22.16:25:27.197 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361434]
24-08-22.16:25:27.246 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361434","timeStamp":"2024-08-22 16:25:26.66"}
24-08-22.16:25:27.803 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653614826
24-08-22.16:25:27.803 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361482
24-08-22.16:25:27.804 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:27.804 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:27.804 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653614826, 101, OpenAI 增加使用次数, 2024-08-22 16:25:27.803, create, 1033415804810932224]
24-08-22.16:25:27.966 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:27.966 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:27.966 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361482","timeStamp":"2024-08-22 16:25:27.803"}, 18265361482, create, 1033415805486215169]
24-08-22.16:25:28.321 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361482","timeStamp":"2024-08-22 16:25:27.803"}
24-08-22.16:25:28.321 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:28.321 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:28.321 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361482]
24-08-22.16:25:28.321 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361482]
24-08-22.16:25:28.357 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361482","timeStamp":"2024-08-22 16:25:27.803"}
24-08-22.16:25:28.909 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653615289
24-08-22.16:25:28.909 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361528
24-08-22.16:25:28.911 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:28.911 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:28.911 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653615289, 101, OpenAI 增加使用次数, 2024-08-22 16:25:28.909, create, 1033415809449832448]
24-08-22.16:25:29.114 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:29.114 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:29.114 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361528","timeStamp":"2024-08-22 16:25:28.909"}, 18265361528, create, 1033415810305470465]
24-08-22.16:25:29.480 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361528","timeStamp":"2024-08-22 16:25:28.909"}
24-08-22.16:25:29.481 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:29.481 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:29.481 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361528]
24-08-22.16:25:29.481 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361528]
24-08-22.16:25:29.524 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361528","timeStamp":"2024-08-22 16:25:28.909"}
24-08-22.16:25:30.006 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:30.056 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:30.100 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:30.100 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:30.100 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:30.100 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:30.116 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653615796
24-08-22.16:25:30.116 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361579
24-08-22.16:25:30.116 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:30.116 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:30.116 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653615796, 101, OpenAI 增加使用次数, 2024-08-22 16:25:30.116, create, 1033415814508163072]
24-08-22.16:25:30.286 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:30.286 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:30.286 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361579","timeStamp":"2024-08-22 16:25:30.116"}, 18265361579, create, 1033415815221194753]
24-08-22.16:25:30.636 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361579","timeStamp":"2024-08-22 16:25:30.116"}
24-08-22.16:25:30.637 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:30.637 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:30.637 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361579]
24-08-22.16:25:30.637 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361579]
24-08-22.16:25:30.688 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361579","timeStamp":"2024-08-22 16:25:30.116"}
24-08-22.16:25:31.237 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653616266
24-08-22.16:25:31.237 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361626
24-08-22.16:25:31.238 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:31.238 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:31.238 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653616266, 101, OpenAI 增加使用次数, 2024-08-22 16:25:31.237, create, 1033415819209977856]
24-08-22.16:25:31.409 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:31.409 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:31.409 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361626","timeStamp":"2024-08-22 16:25:31.237"}, 18265361626, create, 1033415819927203841]
24-08-22.16:25:31.755 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361626","timeStamp":"2024-08-22 16:25:31.237"}
24-08-22.16:25:31.756 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:31.756 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:31.756 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361626]
24-08-22.16:25:31.756 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361626]
24-08-22.16:25:31.796 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361626","timeStamp":"2024-08-22 16:25:31.237"}
24-08-22.16:25:32.346 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653616731
24-08-22.16:25:32.346 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361673
24-08-22.16:25:32.347 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:32.347 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:32.347 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653616731, 101, OpenAI 增加使用次数, 2024-08-22 16:25:32.346, create, 1033415823865655296]
24-08-22.16:25:32.517 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:32.517 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:32.517 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361673","timeStamp":"2024-08-22 16:25:32.346"}, 18265361673, create, 1033415824574492673]
24-08-22.16:25:32.869 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361673","timeStamp":"2024-08-22 16:25:32.346"}
24-08-22.16:25:32.870 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:32.870 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:32.870 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361673]
24-08-22.16:25:32.870 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361673]
24-08-22.16:25:32.908 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361673","timeStamp":"2024-08-22 16:25:32.346"}
24-08-22.16:25:33.485 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653617209
24-08-22.16:25:33.485 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361720
24-08-22.16:25:33.486 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:33.486 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:33.486 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653617209, 101, OpenAI 增加使用次数, 2024-08-22 16:25:33.485, create, 1033415828642967552]
24-08-22.16:25:33.709 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:33.709 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:33.709 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361720","timeStamp":"2024-08-22 16:25:33.485"}, 18265361720, create, 1033415829574103041]
24-08-22.16:25:34.166 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361720","timeStamp":"2024-08-22 16:25:33.485"}
24-08-22.16:25:34.167 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:34.167 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:34.167 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361720]
24-08-22.16:25:34.167 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361720]
24-08-22.16:25:34.209 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361720","timeStamp":"2024-08-22 16:25:33.485"}
24-08-22.16:25:34.757 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653617742
24-08-22.16:25:34.757 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361774
24-08-22.16:25:34.758 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:34.758 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:34.758 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653617742, 101, OpenAI 增加使用次数, 2024-08-22 16:25:34.757, create, 1033415833978122240]
24-08-22.16:25:34.971 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:34.972 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:34.972 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361774","timeStamp":"2024-08-22 16:25:34.757"}, 18265361774, create, 1033415834871508993]
24-08-22.16:25:35.007 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:35.118 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:25:35.192 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:25:35.192 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3305b36e], lock=Optional.empty, window=Optional.empty)
24-08-22.16:25:35.192 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:35.192 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:25:35.476 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361774","timeStamp":"2024-08-22 16:25:34.757"}
24-08-22.16:25:35.476 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:35.476 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:35.476 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361774]
24-08-22.16:25:35.476 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361774]
24-08-22.16:25:35.519 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361774","timeStamp":"2024-08-22 16:25:34.757"}
24-08-22.16:25:36.099 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653618305
24-08-22.16:25:36.099 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361830
24-08-22.16:25:36.100 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:36.100 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:36.100 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653618305, 101, OpenAI 增加使用次数, 2024-08-22 16:25:36.099, create, 1033415839602683904]
24-08-22.16:25:36.407 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:36.407 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:36.407 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361830","timeStamp":"2024-08-22 16:25:36.099"}, 18265361830, create, 1033415840890335233]
24-08-22.16:25:36.930 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361830","timeStamp":"2024-08-22 16:25:36.099"}
24-08-22.16:25:36.931 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:25:36.931 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:25:36.931 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361830]
24-08-22.16:25:36.931 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265361830]
24-08-22.16:25:37.007 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361830","timeStamp":"2024-08-22 16:25:36.099"}
24-08-22.16:25:37.565 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653618920
24-08-22.16:25:37.565 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265361892
24-08-22.16:25:37.566 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:25:37.566 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:37.566 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653618920, 101, OpenAI 增加使用次数, 2024-08-22 16:25:37.565, create, 1033415845751533568]
24-08-22.16:25:37.873 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:25:37.936 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:25:37.937 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:25:37.972 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:25:37.972 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:25:37.972 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265361892","timeStamp":"2024-08-22 16:25:37.565"}, 18265361892, create, 1033415847458615297]
24-08-22.16:25:38.259 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:25:38.259 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:25:38.261 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:25:38.261 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:25:38.261 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:25:38.261 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:25:38.263 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:25:38.263 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:25:38.385 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:25:38.394 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:25:38.394 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:25:38.403 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:25:38.418 [main            ] WARN  ProxyConnection        - HikariPool-1 - Connection com.mysql.cj.jdbc.ConnectionImpl@72602969 marked as broken because of SQLSTATE(08S01), ErrorCode(0)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:322)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:318)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:85)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:64)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.syncExecute(ExecutorEngine.java:101)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.serialExecute(ExecutorEngine.java:87)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.execute(ExecutorEngine.java:81)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:65)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:49)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.doExecute(JDBCLockEngine.java:116)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.execute(JDBCLockEngine.java:93)
	at org.apache.shardingsphere.driver.executor.DriverJDBCExecutor.execute(DriverJDBCExecutor.java:127)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.execute(ShardingSpherePreparedStatement.java:298)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	at com.sun.proxy.$Proxy245.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy253.insert(Unknown Source)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:76)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:71)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$39a0c0e3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$2211b0dd.saveUserAwardRecord(<generated>)
	at com.big.market.infrastructure.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:57)
	at com.big.market.infrastructure.domain.test.award.AwardServiceTest.test_saveUserAwardRecord(AwardServiceTest.java:44)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:647)
	at com.mysql.cj.protocol.a.NativeProtocol.sendQueryPacket(NativeProtocol.java:946)
	at com.mysql.cj.NativeSession.execSQL(NativeSession.java:1075)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:930)
	... 81 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:171)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at sun.security.ssl.InputRecord.readFully(InputRecord.java:465)
	at sun.security.ssl.InputRecord.read(InputRecord.java:503)
	at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:983)
	at sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:940)
	at sun.security.ssl.AppInputStream.read(AppInputStream.java:105)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 86 common frames omitted
24-08-22.16:25:38.459 [main            ] WARN  ProxyConnection        - HikariPool-2 - Connection com.mysql.cj.jdbc.ConnectionImpl@1e32be24 marked as broken because of SQLSTATE(08003), ErrorCode(0)
java.sql.SQLNonTransientConnectionException: No operations allowed after connection closed.
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:110)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:97)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:89)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:63)
	at com.mysql.cj.jdbc.exceptions.SQLError.createSQLException(SQLError.java:73)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:73)
	at com.mysql.cj.jdbc.ConnectionImpl.rollback(ConnectionImpl.java:1865)
	at com.zaxxer.hikari.pool.ProxyConnection.rollback(ProxyConnection.java:396)
	at com.zaxxer.hikari.pool.HikariProxyConnection.rollback(HikariProxyConnection.java)
	at org.apache.shardingsphere.driver.jdbc.adapter.executor.ForceExecuteTemplate.execute(ForceExecuteTemplate.java:42)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ConnectionManager.rollback(ConnectionManager.java:107)
	at org.apache.shardingsphere.driver.jdbc.core.connection.ShardingSphereConnection.rollback(ShardingSphereConnection.java:170)
	at org.springframework.jdbc.datasource.DataSourceTransactionManager.doRollback(DataSourceTransactionManager.java:348)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:835)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:809)
	at org.springframework.transaction.support.TransactionTemplate.rollbackOnException(TransactionTemplate.java:168)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:144)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:71)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$39a0c0e3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$2211b0dd.saveUserAwardRecord(<generated>)
	at com.big.market.infrastructure.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:57)
	at com.big.market.infrastructure.domain.test.award.AwardServiceTest.test_saveUserAwardRecord(AwardServiceTest.java:44)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.mysql.cj.exceptions.ConnectionIsClosedException: No operations allowed after connection closed.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.NativeSession.checkClosed(NativeSession.java:1171)
	at com.mysql.cj.jdbc.ConnectionImpl.checkClosed(ConnectionImpl.java:576)
	at com.mysql.cj.jdbc.ConnectionImpl.rollback(ConnectionImpl.java:1819)
	... 56 common frames omitted
24-08-22.16:25:38.461 [main            ] ERROR TransactionTemplate    - Application exception overridden by rollback exception
org.springframework.dao.RecoverableDataAccessException: 
### Error updating database.  Cause: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
### The error may exist in file [C:\Users\27132\Java\big-market\big-market-app\target\classes\mybatis\mapper\TaskMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into task(             topic,             user_id,             message,             message_id,             state         ) values (?,                  ?,                  ?,                  ?,                  ?);
### Cause: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
; Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.; nested exception is com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:100)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy245.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy253.insert(Unknown Source)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:76)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:71)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$39a0c0e3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$2211b0dd.saveUserAwardRecord(<generated>)
	at com.big.market.infrastructure.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:57)
	at com.big.market.infrastructure.domain.test.award.AwardServiceTest.test_saveUserAwardRecord(AwardServiceTest.java:44)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:953)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:370)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:322)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:318)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:85)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:64)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.syncExecute(ExecutorEngine.java:101)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.serialExecute(ExecutorEngine.java:87)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.execute(ExecutorEngine.java:81)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:65)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:49)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.doExecute(JDBCLockEngine.java:116)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.execute(JDBCLockEngine.java:93)
	at org.apache.shardingsphere.driver.executor.DriverJDBCExecutor.execute(DriverJDBCExecutor.java:127)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.execute(ShardingSpherePreparedStatement.java:298)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 54 common frames omitted
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 13 milliseconds ago. The last packet sent successfully to the server was 13 milliseconds ago.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:647)
	at com.mysql.cj.protocol.a.NativeProtocol.sendQueryPacket(NativeProtocol.java:946)
	at com.mysql.cj.NativeSession.execSQL(NativeSession.java:1075)
	at com.mysql.cj.jdbc.ClientPreparedStatement.executeInternal(ClientPreparedStatement.java:930)
	... 81 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:171)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at sun.security.ssl.InputRecord.readFully(InputRecord.java:465)
	at sun.security.ssl.InputRecord.read(InputRecord.java:503)
	at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:983)
	at sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:940)
	at sun.security.ssl.AppInputStream.read(AppInputStream.java:105)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 86 common frames omitted
24-08-22.16:27:39.272 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 28540 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:27:39.273 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:27:40.785 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:27:40.790 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:27:40.863 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 52 ms. Found 0 Redis repository interfaces.
24-08-22.16:27:41.408 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:27:41.422 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:27:41.676 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$e31d518e] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:27:42.879 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:27:43.513 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:27:43.883 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:27:44.247 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:27:45.561 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:27:45.575 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:27:46.199 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:27:51.013 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:27:51.027 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:27:51.027 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:27:51.027 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:27:51.028 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:27:51.028 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:27:51.028 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:27:51.028 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@20dab85c
24-08-22.16:27:51.210 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:27:51.324 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:27:51.590 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#69497a36:0/SimpleConnection@41861964 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 61458]
24-08-22.16:27:52.207 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:27:52.207 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:27:52.222 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.42 seconds (JVM running for 14.628)
24-08-22.16:27:52.520 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653675524
24-08-22.16:27:52.522 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265367552
24-08-22.16:29:13.408 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=1m27s743ms543µs600ns).
24-08-22.16:29:13.408 [HikariPool-2 housekeeper] WARN  HikariPool             - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=1m27s106ms30µs400ns).
24-08-22.16:29:13.410 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:17.442 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:28.919 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:33.703 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:36.343 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:37.541 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:29:37.541 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:29:37.541 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:29:37.541 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:29:37.541 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.541 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:37.542 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:40.253 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:40.301 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:40.302 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:29:40.302 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:29:40.302 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:40.302 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:29:40.779 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:29:40.780 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:29:40.780 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653675524, 101, OpenAI 增加使用次数, 2024-08-22 16:27:52.52, create, 1033416864581529600]
24-08-22.16:29:41.000 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:29:41.001 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:29:41.001 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265367552","timeStamp":"2024-08-22 16:27:52.522"}, 18265367552, create, 1033416866573824001]
24-08-22.16:29:59.912 [HikariPool-2 housekeeper] WARN  HikariPool             - HikariPool-2 - Thread starvation or clock leap detected (housekeeper delta=46s506ms534µs700ns).
24-08-22.16:29:59.912 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:59.912 [HikariPool-1 housekeeper] WARN  HikariPool             - HikariPool-1 - Thread starvation or clock leap detected (housekeeper delta=46s506ms135µs200ns).
24-08-22.16:29:59.961 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:29:59.975 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265367552","timeStamp":"2024-08-22 16:27:52.522"}
24-08-22.16:30:00.350 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:00.351 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:30:00.352 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:30:00.352 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:00.352 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:00.361 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265367552","timeStamp":"2024-08-22 16:27:52.522"}
24-08-22.16:30:00.480 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:30:00.480 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:30:00.480 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265367552]
24-08-22.16:30:00.480 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265367552]
24-08-22.16:30:05.839 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:07.238 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:30:07.238 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:30:07.238 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:07.238 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:07.310 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:07.738 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653732239
24-08-22.16:30:07.738 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265373223
24-08-22.16:30:12.634 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:19.109 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:30:19.109 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:30:19.109 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:19.109 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:19.110 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:30:19.110 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:19.110 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653732239, 101, OpenAI 增加使用次数, 2024-08-22 16:30:07.738, create, 1033417026636853248]
24-08-22.16:30:19.158 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:19.203 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:30:19.203 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:30:19.203 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:19.203 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:19.291 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:30:19.291 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:19.291 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373223","timeStamp":"2024-08-22 16:30:07.738"}, 18265373223, create, 1033417027391827969]
24-08-22.16:30:19.709 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373223","timeStamp":"2024-08-22 16:30:07.738"}
24-08-22.16:30:19.711 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:30:19.711 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:30:19.711 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373223]
24-08-22.16:30:19.711 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373223]
24-08-22.16:30:19.759 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373223","timeStamp":"2024-08-22 16:30:07.738"}
24-08-22.16:30:20.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:20.051 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:30:20.092 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:30:20.092 [pool-7-thread-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@6d7930c7], lock=Optional.empty, window=Optional.empty)
24-08-22.16:30:20.092 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:20.092 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:30:20.304 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653737509
24-08-22.16:30:20.304 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265373750
24-08-22.16:30:20.305 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:30:20.305 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:20.305 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653737509, 101, OpenAI 增加使用次数, 2024-08-22 16:30:20.304, create, 1033417031649046528]
24-08-22.16:30:20.431 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:30:20.432 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:20.432 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373750","timeStamp":"2024-08-22 16:30:20.304"}, 18265373750, create, 1033417032177528833]
24-08-22.16:30:20.752 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373750","timeStamp":"2024-08-22 16:30:20.304"}
24-08-22.16:30:20.753 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:30:20.754 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:30:20.754 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373750]
24-08-22.16:30:20.754 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373750]
24-08-22.16:30:20.790 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373750","timeStamp":"2024-08-22 16:30:20.304"}
24-08-22.16:30:21.383 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653737962
24-08-22.16:30:21.383 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265373796
24-08-22.16:30:21.384 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:30:21.384 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:21.384 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653737962, 101, OpenAI 增加使用次数, 2024-08-22 16:30:21.383, create, 1033417036174700544]
24-08-22.16:30:21.611 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:30:21.611 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:21.611 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373796","timeStamp":"2024-08-22 16:30:21.383"}, 18265373796, create, 1033417037126807553]
24-08-22.16:30:21.960 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373796","timeStamp":"2024-08-22 16:30:21.383"}
24-08-22.16:30:21.960 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:30:21.962 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:30:21.962 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373796]
24-08-22.16:30:21.962 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373796]
24-08-22.16:30:22.012 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373796","timeStamp":"2024-08-22 16:30:21.383"}
24-08-22.16:30:22.557 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653738454
24-08-22.16:30:22.557 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265373845
24-08-22.16:30:22.558 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:30:22.558 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:22.558 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653738454, 101, OpenAI 增加使用次数, 2024-08-22 16:30:22.557, create, 1033417041098813440]
24-08-22.16:30:22.721 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:30:22.722 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:22.722 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373845","timeStamp":"2024-08-22 16:30:22.557"}, 18265373845, create, 1033417041782484993]
24-08-22.16:30:23.121 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:spring.rabbitmq.topic.send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373845","timeStamp":"2024-08-22 16:30:22.557"}
24-08-22.16:30:23.122 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:30:23.122 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:30:23.122 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373845]
24-08-22.16:30:23.122 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265373845]
24-08-22.16:30:23.159 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373845","timeStamp":"2024-08-22 16:30:22.557"}
24-08-22.16:30:23.671 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:30:23.714 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653738940
24-08-22.16:30:23.714 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265373894
24-08-22.16:30:23.715 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:30:23.715 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:23.715 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653738940, 101, OpenAI 增加使用次数, 2024-08-22 16:30:23.714, create, 1033417045947428864]
24-08-22.16:30:23.717 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:30:23.717 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:30:23.881 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:30:23.881 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:30:23.881 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [spring.rabbitmq.topic.send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265373894","timeStamp":"2024-08-22 16:30:23.714"}, 18265373894, create, 1033417046647877633]
24-08-22.16:30:24.212 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:30:24.212 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:30:24.214 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:30:24.214 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:30:24.214 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:30:24.214 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:30:24.216 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:30:24.216 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:30:24.313 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:30:24.315 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:30:24.322 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:30:24.322 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:30:24.328 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:30:53.722 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 12860 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:30:53.723 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:30:55.399 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:30:55.407 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:30:55.484 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 51 ms. Found 0 Redis repository interfaces.
24-08-22.16:30:56.016 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:30:56.175 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:30:56.597 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$7cce6912] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:30:57.978 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:30:58.783 [redisson-netty-2-6] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:30:59.229 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:30:59.659 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:31:01.073 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:31:01.086 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:31:01.743 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:31:07.136 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:31:07.151 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:31:07.151 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:31:07.152 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:31:07.153 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:31:07.153 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:31:07.153 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:31:07.153 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@2e962cec
24-08-22.16:31:07.370 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:31:07.509 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:31:07.822 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#37bafef8:0/SimpleConnection@664c6bbc [delegate=amqp://admin@8.138.41.137:5672/, localPort= 61654]
24-08-22.16:31:08.441 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:31:08.441 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:31:08.458 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 15.249 seconds (JVM running for 16.465)
24-08-22.16:31:08.762 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653757834
24-08-22.16:31:08.764 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265375783
24-08-22.16:31:09.747 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:09.747 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:09.748 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653757834, 101, OpenAI 增加使用次数, 2024-08-22 16:31:08.762, create, 1033417238449205248]
24-08-22.16:31:10.002 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:31:10.026 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:10.027 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:10.027 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375783","timeStamp":"2024-08-22 16:31:08.764"}, 18265375783, create, 1033417240110149633]
24-08-22.16:31:10.072 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:31:10.183 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:31:10.183 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3bf66a94], lock=Optional.empty, window=Optional.empty)
24-08-22.16:31:10.183 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:31:10.183 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:31:10.513 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375783","timeStamp":"2024-08-22 16:31:08.764"}
24-08-22.16:31:10.524 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:10.524 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:10.524 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375783]
24-08-22.16:31:10.524 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375783]
24-08-22.16:31:11.139 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653758831
24-08-22.16:31:11.140 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265375883
24-08-22.16:31:11.141 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:11.141 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:11.141 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653758831, 101, OpenAI 增加使用次数, 2024-08-22 16:31:11.139, create, 1033417244870684672]
24-08-22.16:31:11.341 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:11.341 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:11.341 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375883","timeStamp":"2024-08-22 16:31:11.14"}, 18265375883, create, 1033417245705351169]
24-08-22.16:31:11.690 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375883","timeStamp":"2024-08-22 16:31:11.14"}
24-08-22.16:31:11.691 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:11.691 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:11.691 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375883]
24-08-22.16:31:11.691 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375883]
24-08-22.16:31:12.294 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653759316
24-08-22.16:31:12.294 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265375931
24-08-22.16:31:12.295 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:12.295 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:12.295 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653759316, 101, OpenAI 增加使用次数, 2024-08-22 16:31:12.294, create, 1033417249710911488]
24-08-22.16:31:12.491 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:12.491 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:12.491 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375931","timeStamp":"2024-08-22 16:31:12.294"}, 18265375931, create, 1033417250528800769]
24-08-22.16:31:12.850 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375931","timeStamp":"2024-08-22 16:31:12.294"}
24-08-22.16:31:12.851 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:12.852 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:12.852 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375931]
24-08-22.16:31:12.852 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375931]
24-08-22.16:31:13.437 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653759795
24-08-22.16:31:13.437 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265375979
24-08-22.16:31:13.438 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:13.438 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:13.438 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653759795, 101, OpenAI 增加使用次数, 2024-08-22 16:31:13.437, create, 1033417254505000960]
24-08-22.16:31:13.611 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:13.611 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:13.611 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375979","timeStamp":"2024-08-22 16:31:13.437"}, 18265375979, create, 1033417255226421249]
24-08-22.16:31:13.972 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265375979","timeStamp":"2024-08-22 16:31:13.437"}
24-08-22.16:31:13.973 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:13.973 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:13.973 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375979]
24-08-22.16:31:13.973 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265375979]
24-08-22.16:31:14.569 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653760270
24-08-22.16:31:14.569 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376027
24-08-22.16:31:14.570 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:14.570 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:14.570 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653760270, 101, OpenAI 增加使用次数, 2024-08-22 16:31:14.569, create, 1033417259252953088]
24-08-22.16:31:14.728 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:14.728 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:14.728 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376027","timeStamp":"2024-08-22 16:31:14.569"}, 18265376027, create, 1033417259911458817]
24-08-22.16:31:15.003 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:31:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:31:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3bf66a94], lock=Optional.empty, window=Optional.empty)
24-08-22.16:31:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:31:15.004 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:31:15.054 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:31:15.088 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376027","timeStamp":"2024-08-22 16:31:14.569"}
24-08-22.16:31:15.089 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:15.089 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:15.089 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376027]
24-08-22.16:31:15.089 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376027]
24-08-22.16:31:15.674 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653760733
24-08-22.16:31:15.674 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376073
24-08-22.16:31:15.675 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:15.675 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:15.675 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653760733, 101, OpenAI 增加使用次数, 2024-08-22 16:31:15.674, create, 1033417263887659008]
24-08-22.16:31:15.839 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:15.839 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:15.839 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376073","timeStamp":"2024-08-22 16:31:15.674"}, 18265376073, create, 1033417264571330561]
24-08-22.16:31:16.175 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376073","timeStamp":"2024-08-22 16:31:15.674"}
24-08-22.16:31:16.176 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:16.176 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:16.176 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376073]
24-08-22.16:31:16.176 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376073]
24-08-22.16:31:16.797 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653761204
24-08-22.16:31:16.797 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376120
24-08-22.16:31:16.798 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:16.798 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:16.798 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653761204, 101, OpenAI 增加使用次数, 2024-08-22 16:31:16.797, create, 1033417268597862400]
24-08-22.16:31:16.989 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:16.989 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:16.989 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376120","timeStamp":"2024-08-22 16:31:16.797"}, 18265376120, create, 1033417269394780161]
24-08-22.16:31:17.318 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376120","timeStamp":"2024-08-22 16:31:16.797"}
24-08-22.16:31:17.319 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:17.319 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:17.319 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376120]
24-08-22.16:31:17.321 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376120]
24-08-22.16:31:17.918 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653761674
24-08-22.16:31:17.918 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376167
24-08-22.16:31:17.919 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:17.920 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:17.920 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653761674, 101, OpenAI 增加使用次数, 2024-08-22 16:31:17.918, create, 1033417273299677184]
24-08-22.16:31:18.116 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:18.117 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:18.117 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376167","timeStamp":"2024-08-22 16:31:17.918"}, 18265376167, create, 1033417274125955073]
24-08-22.16:31:18.577 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376167","timeStamp":"2024-08-22 16:31:17.918"}
24-08-22.16:31:18.578 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:18.578 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:18.578 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376167]
24-08-22.16:31:18.578 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376167]
24-08-22.16:31:19.224 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653762222
24-08-22.16:31:19.224 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376222
24-08-22.16:31:19.226 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:19.226 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:19.226 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653762222, 101, OpenAI 增加使用次数, 2024-08-22 16:31:19.224, create, 1033417278777438208]
24-08-22.16:31:19.458 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:19.458 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:19.458 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376222","timeStamp":"2024-08-22 16:31:19.224"}, 18265376222, create, 1033417279754711041]
24-08-22.16:31:19.808 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376222","timeStamp":"2024-08-22 16:31:19.224"}
24-08-22.16:31:19.808 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:19.809 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:19.809 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376222]
24-08-22.16:31:19.809 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376222]
24-08-22.16:31:20.001 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:31:20.074 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:31:20.076 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:31:20.076 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@3bf66a94], lock=Optional.empty, window=Optional.empty)
24-08-22.16:31:20.076 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:31:20.076 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:31:20.439 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653762732
24-08-22.16:31:20.439 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376273
24-08-22.16:31:20.441 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:20.441 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:20.441 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653762732, 101, OpenAI 增加使用次数, 2024-08-22 16:31:20.439, create, 1033417283873517568]
24-08-22.16:31:20.590 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:20.590 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:20.590 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376273","timeStamp":"2024-08-22 16:31:20.439"}, 18265376273, create, 1033417284498468865]
24-08-22.16:31:20.989 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376273","timeStamp":"2024-08-22 16:31:20.439"}
24-08-22.16:31:20.989 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:20.989 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:20.990 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376273]
24-08-22.16:31:20.990 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376273]
24-08-22.16:31:21.584 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653763212
24-08-22.16:31:21.584 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376321
24-08-22.16:31:21.585 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:21.585 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:21.585 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653763212, 101, OpenAI 增加使用次数, 2024-08-22 16:31:21.584, create, 1033417288671801344]
24-08-22.16:31:21.749 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:21.749 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:21.750 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376321","timeStamp":"2024-08-22 16:31:21.584"}, 18265376321, create, 1033417289363861505]
24-08-22.16:31:22.108 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376321","timeStamp":"2024-08-22 16:31:21.584"}
24-08-22.16:31:22.109 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:22.109 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:22.109 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376321]
24-08-22.16:31:22.109 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376321]
24-08-22.16:31:22.694 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653763678
24-08-22.16:31:22.694 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265376367
24-08-22.16:31:22.695 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:31:22.695 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:22.695 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653763678, 101, OpenAI 增加使用次数, 2024-08-22 16:31:22.694, create, 1033417293331673088]
24-08-22.16:31:22.869 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:31:22.869 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:31:22.869 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376367","timeStamp":"2024-08-22 16:31:22.694"}, 18265376367, create, 1033417294057287681]
24-08-22.16:31:23.248 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265376367","timeStamp":"2024-08-22 16:31:22.694"}
24-08-22.16:31:23.249 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:31:23.249 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:31:23.249 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376367]
24-08-22.16:31:23.249 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265376367]
24-08-22.16:31:23.379 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:31:23.418 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:31:23.418 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:31:23.422 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:31:23.638 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:31:23.640 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:31:23.640 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:31:23.640 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:31:23.641 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:31:23.642 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:31:23.643 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:31:23.744 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:31:23.755 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:31:23.756 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:31:23.765 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:32:23.792 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 9320 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:32:23.793 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:32:25.471 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:32:25.477 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:32:25.547 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 0 Redis repository interfaces.
24-08-22.16:32:26.063 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:32:26.079 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:32:26.334 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$14a3866c] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:32:27.514 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:32:28.145 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:32:28.521 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:32:28.876 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:32:30.121 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:32:30.135 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:32:30.787 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:32:35.605 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:32:35.618 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:32:35.618 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:32:35.619 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:32:35.619 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:32:35.619 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:32:35.619 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:32:35.619 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@27c2f134
24-08-22.16:32:35.777 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:32:35.913 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:32:36.223 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#71de943f:0/SimpleConnection@60e2b6e3 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 61799]
24-08-22.16:32:36.844 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:32:36.844 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:32:36.860 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.538 seconds (JVM running for 14.634)
24-08-22.16:32:37.160 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653794911
24-08-22.16:32:37.162 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379491
24-08-22.16:32:38.140 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:38.140 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:38.140 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653794911, 101, OpenAI 增加使用次数, 2024-08-22 16:32:37.16, create, 1033417609179541504]
24-08-22.16:32:38.440 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:38.440 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:38.440 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379491","timeStamp":"2024-08-22 16:32:37.162"}, 18265379491, create, 1033417610966315009]
24-08-22.16:32:38.912 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379491","timeStamp":"2024-08-22 16:32:37.162"}
24-08-22.16:32:38.963 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:38.964 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:38.964 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379491]
24-08-22.16:32:38.964 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379491]
24-08-22.16:32:39.587 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653795929
24-08-22.16:32:39.587 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379592
24-08-22.16:32:39.590 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:39.590 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:39.590 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653795929, 101, OpenAI 增加使用次数, 2024-08-22 16:32:39.587, create, 1033417615848484864]
24-08-22.16:32:39.760 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:39.760 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:39.760 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379592","timeStamp":"2024-08-22 16:32:39.587"}, 18265379592, create, 1033417616561516545]
24-08-22.16:32:40.015 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:32:40.081 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:32:40.103 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:32:40.103 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@21b2adeb], lock=Optional.empty, window=Optional.empty)
24-08-22.16:32:40.103 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:32:40.103 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:32:40.166 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379592","timeStamp":"2024-08-22 16:32:39.587"}
24-08-22.16:32:40.166 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:40.166 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:40.166 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379592]
24-08-22.16:32:40.166 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379592]
24-08-22.16:32:40.826 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653796449
24-08-22.16:32:40.827 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379644
24-08-22.16:32:40.829 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:40.829 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:40.829 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653796449, 101, OpenAI 增加使用次数, 2024-08-22 16:32:40.827, create, 1033417621041033216]
24-08-22.16:32:41.068 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:41.068 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:41.068 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379644","timeStamp":"2024-08-22 16:32:40.827"}, 18265379644, create, 1033417622047666177]
24-08-22.16:32:41.507 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379644","timeStamp":"2024-08-22 16:32:40.827"}
24-08-22.16:32:41.508 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:41.508 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:41.508 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379644]
24-08-22.16:32:41.508 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379644]
24-08-22.16:32:42.116 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653796990
24-08-22.16:32:42.116 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379699
24-08-22.16:32:42.117 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:42.117 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:42.117 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653796990, 101, OpenAI 增加使用次数, 2024-08-22 16:32:42.116, create, 1033417626451685376]
24-08-22.16:32:42.375 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:42.375 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:42.375 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379699","timeStamp":"2024-08-22 16:32:42.116"}, 18265379699, create, 1033417627529621505]
24-08-22.16:32:42.739 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379699","timeStamp":"2024-08-22 16:32:42.116"}
24-08-22.16:32:42.740 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:42.740 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:42.740 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379699]
24-08-22.16:32:42.740 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379699]
24-08-22.16:32:43.381 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653797520
24-08-22.16:32:43.381 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379752
24-08-22.16:32:43.382 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:43.382 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:43.382 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653797520, 101, OpenAI 增加使用次数, 2024-08-22 16:32:43.381, create, 1033417631757479936]
24-08-22.16:32:43.622 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:43.622 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:43.622 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379752","timeStamp":"2024-08-22 16:32:43.381"}, 18265379752, create, 1033417632764112897]
24-08-22.16:32:43.976 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379752","timeStamp":"2024-08-22 16:32:43.381"}
24-08-22.16:32:43.977 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:43.977 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:43.977 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379752]
24-08-22.16:32:43.977 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379752]
24-08-22.16:32:44.576 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653798021
24-08-22.16:32:44.576 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379802
24-08-22.16:32:44.577 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:44.577 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:44.577 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653798021, 101, OpenAI 增加使用次数, 2024-08-22 16:32:44.576, create, 1033417636769673216]
24-08-22.16:32:44.793 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:44.793 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:44.793 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379802","timeStamp":"2024-08-22 16:32:44.576"}, 18265379802, create, 1033417637671448577]
24-08-22.16:32:45.010 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:32:45.011 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:32:45.011 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@21b2adeb], lock=Optional.empty, window=Optional.empty)
24-08-22.16:32:45.012 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:32:45.012 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:32:45.058 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:32:45.188 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379802","timeStamp":"2024-08-22 16:32:44.576"}
24-08-22.16:32:45.189 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:45.189 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:45.189 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379802]
24-08-22.16:32:45.189 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379802]
24-08-22.16:32:45.800 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653798535
24-08-22.16:32:45.800 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379853
24-08-22.16:32:45.801 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:45.802 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:45.802 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653798535, 101, OpenAI 增加使用次数, 2024-08-22 16:32:45.8, create, 1033417641903501312]
24-08-22.16:32:46.028 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:46.028 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:46.028 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379853","timeStamp":"2024-08-22 16:32:45.8"}, 18265379853, create, 1033417642855608321]
24-08-22.16:32:46.436 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379853","timeStamp":"2024-08-22 16:32:45.8"}
24-08-22.16:32:46.437 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:46.437 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:46.437 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379853]
24-08-22.16:32:46.439 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379853]
24-08-22.16:32:47.033 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653799052
24-08-22.16:32:47.033 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379905
24-08-22.16:32:47.035 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:47.035 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:47.035 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653799052, 101, OpenAI 增加使用次数, 2024-08-22 16:32:47.033, create, 1033417647075078144]
24-08-22.16:32:47.214 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:47.214 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:47.214 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379905","timeStamp":"2024-08-22 16:32:47.033"}, 18265379905, create, 1033417647825858561]
24-08-22.16:32:47.618 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379905","timeStamp":"2024-08-22 16:32:47.033"}
24-08-22.16:32:47.619 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:47.619 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:47.619 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379905]
24-08-22.16:32:47.619 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379905]
24-08-22.16:32:48.217 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653799549
24-08-22.16:32:48.217 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265379954
24-08-22.16:32:48.218 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:48.218 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:48.218 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653799549, 101, OpenAI 增加使用次数, 2024-08-22 16:32:48.217, create, 1033417652036939776]
24-08-22.16:32:48.453 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:48.453 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:48.453 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379954","timeStamp":"2024-08-22 16:32:48.217"}, 18265379954, create, 1033417653022601217]
24-08-22.16:32:48.856 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265379954","timeStamp":"2024-08-22 16:32:48.217"}
24-08-22.16:32:48.857 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:48.857 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:48.857 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379954]
24-08-22.16:32:48.857 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265379954]
24-08-22.16:32:49.456 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653800068
24-08-22.16:32:49.456 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265380006
24-08-22.16:32:49.457 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:49.457 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:49.457 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653800068, 101, OpenAI 增加使用次数, 2024-08-22 16:32:49.456, create, 1033417657237876736]
24-08-22.16:32:49.692 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:49.692 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:49.692 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380006","timeStamp":"2024-08-22 16:32:49.456"}, 18265380006, create, 1033417658219343873]
24-08-22.16:32:50.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:32:50.086 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380006","timeStamp":"2024-08-22 16:32:49.456"}
24-08-22.16:32:50.086 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:32:50.086 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:50.086 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:50.086 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:32:50.086 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380006]
24-08-22.16:32:50.088 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380006]
24-08-22.16:32:50.086 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@21b2adeb], lock=Optional.empty, window=Optional.empty)
24-08-22.16:32:50.088 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:32:50.088 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:32:50.674 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653800579
24-08-22.16:32:50.674 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265380057
24-08-22.16:32:50.675 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:50.675 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:50.675 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653800579, 101, OpenAI 增加使用次数, 2024-08-22 16:32:50.674, create, 1033417662346539008]
24-08-22.16:32:50.959 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:50.959 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:50.959 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380057","timeStamp":"2024-08-22 16:32:50.674"}, 18265380057, create, 1033417663537721345]
24-08-22.16:32:51.357 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380057","timeStamp":"2024-08-22 16:32:50.674"}
24-08-22.16:32:51.357 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:51.357 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:51.357 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380057]
24-08-22.16:32:51.357 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380057]
24-08-22.16:32:51.953 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653801116
24-08-22.16:32:51.953 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265380111
24-08-22.16:32:51.954 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:51.955 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:51.955 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653801116, 101, OpenAI 增加使用次数, 2024-08-22 16:32:51.953, create, 1033417667711053824]
24-08-22.16:32:52.151 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:52.151 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:52.151 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380111","timeStamp":"2024-08-22 16:32:51.953"}, 18265380111, create, 1033417668537331713]
24-08-22.16:32:52.506 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380111","timeStamp":"2024-08-22 16:32:51.953"}
24-08-22.16:32:52.506 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:52.506 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:52.506 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380111]
24-08-22.16:32:52.506 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380111]
24-08-22.16:32:53.092 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653801593
24-08-22.16:32:53.092 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265380159
24-08-22.16:32:53.093 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:32:53.093 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:53.093 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653801593, 101, OpenAI 增加使用次数, 2024-08-22 16:32:53.092, create, 1033417672488366080]
24-08-22.16:32:53.282 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:32:53.282 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:32:53.282 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380159","timeStamp":"2024-08-22 16:32:53.092"}, 18265380159, create, 1033417673276895233]
24-08-22.16:32:53.408 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:32:53.466 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:32:53.466 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:32:53.658 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380159","timeStamp":"2024-08-22 16:32:53.092"}
24-08-22.16:32:53.659 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:53.659 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:53.659 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380159]
24-08-22.16:32:53.659 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380159]
24-08-22.16:32:53.661 [main            ] ERROR AwardRepository        - 写入中奖记录，发送MQ消息失败 userId:lyt topic:send_award
24-08-22.16:32:53.662 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:32:53.662 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:32:53.662 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380159]
24-08-22.16:32:53.662 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380159]
24-08-22.16:32:53.828 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:32:54.073 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:32:54.075 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:32:54.075 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:32:54.075 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:32:54.075 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:32:54.076 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:32:54.077 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:32:54.180 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:32:54.188 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:32:54.188 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:32:54.194 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:33:07.807 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 9932 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:33:07.808 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:33:09.446 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:33:09.452 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:33:09.532 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 53 ms. Found 0 Redis repository interfaces.
24-08-22.16:33:10.085 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:33:10.101 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:33:10.387 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$e5d31448] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:33:11.536 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:33:12.163 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:33:12.498 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:33:12.918 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:33:14.129 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:33:14.142 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:33:14.716 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:33:19.429 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:33:19.441 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:33:19.442 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:33:19.442 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:33:19.443 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:33:19.443 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:33:19.443 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:33:19.443 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@2d7bfb13
24-08-22.16:33:19.588 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:33:19.705 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:33:19.992 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#72161dbb:0/SimpleConnection@5f571d96 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 61925]
24-08-22.16:33:20.887 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:33:20.887 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:33:20.904 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.611 seconds (JVM running for 14.789)
24-08-22.16:33:21.201 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653813383
24-08-22.16:33:21.204 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381338
24-08-22.16:33:22.195 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:22.195 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:22.195 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653813383, 101, OpenAI 增加使用次数, 2024-08-22 16:33:21.201, create, 1033417793988964352]
24-08-22.16:33:22.454 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:22.454 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:22.454 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381338","timeStamp":"2024-08-22 16:33:21.204"}, 18265381338, create, 1033417795595382785]
24-08-22.16:33:22.890 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381338","timeStamp":"2024-08-22 16:33:21.204"}
24-08-22.16:33:22.948 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:22.948 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:22.948 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381338]
24-08-22.16:33:22.948 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381338]
24-08-22.16:33:22.953 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381338","timeStamp":"2024-08-22 16:33:21.204"}
24-08-22.16:33:23.546 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653814367
24-08-22.16:33:23.546 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381436
24-08-22.16:33:23.547 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:23.547 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:23.547 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653814367, 101, OpenAI 增加使用次数, 2024-08-22 16:33:23.546, create, 1033417800221700096]
24-08-22.16:33:23.728 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:23.728 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:23.728 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381436","timeStamp":"2024-08-22 16:33:23.546"}, 18265381436, create, 1033417800976674817]
24-08-22.16:33:24.088 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381436","timeStamp":"2024-08-22 16:33:23.546"}
24-08-22.16:33:24.089 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:24.089 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:24.089 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381436]
24-08-22.16:33:24.089 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381436]
24-08-22.16:33:24.128 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381436","timeStamp":"2024-08-22 16:33:23.546"}
24-08-22.16:33:24.714 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653814857
24-08-22.16:33:24.714 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381485
24-08-22.16:33:24.715 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:24.715 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:24.715 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653814857, 101, OpenAI 增加使用次数, 2024-08-22 16:33:24.714, create, 1033417805120647168]
24-08-22.16:33:24.917 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:24.917 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:24.917 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381485","timeStamp":"2024-08-22 16:33:24.714"}, 18265381485, create, 1033417805967896577]
24-08-22.16:33:25.011 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:25.090 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:25.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:33:25.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@70b53b8b], lock=Optional.empty, window=Optional.empty)
24-08-22.16:33:25.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:25.097 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:25.255 [pool-7-thread-2 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380159","timeStamp":"2024-08-22 16:32:53.092"}
24-08-22.16:33:25.256 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:25.256 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:25.256 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380159]
24-08-22.16:33:25.256 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265380159]
24-08-22.16:33:25.287 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381485","timeStamp":"2024-08-22 16:33:24.714"}
24-08-22.16:33:25.288 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:25.288 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:25.289 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381485]
24-08-22.16:33:25.289 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381485]
24-08-22.16:33:25.297 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265380159","timeStamp":"2024-08-22 16:32:53.092"}
24-08-22.16:33:25.346 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381485","timeStamp":"2024-08-22 16:33:24.714"}
24-08-22.16:33:25.897 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653815353
24-08-22.16:33:25.897 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381535
24-08-22.16:33:25.898 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:25.898 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:25.898 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653815353, 101, OpenAI 增加使用次数, 2024-08-22 16:33:25.897, create, 1033417810082508800]
24-08-22.16:33:26.118 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:26.118 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:26.118 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381535","timeStamp":"2024-08-22 16:33:25.897"}, 18265381535, create, 1033417811001061377]
24-08-22.16:33:26.520 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381535","timeStamp":"2024-08-22 16:33:25.897"}
24-08-22.16:33:26.521 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:26.521 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:26.521 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381535]
24-08-22.16:33:26.521 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381535]
24-08-22.16:33:26.563 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381535","timeStamp":"2024-08-22 16:33:25.897"}
24-08-22.16:33:27.113 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653815863
24-08-22.16:33:27.113 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381586
24-08-22.16:33:27.114 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:27.114 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:27.114 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653815863, 101, OpenAI 增加使用次数, 2024-08-22 16:33:27.113, create, 1033417815182782464]
24-08-22.16:33:27.288 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:27.288 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:27.288 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381586","timeStamp":"2024-08-22 16:33:27.113"}, 18265381586, create, 1033417815912591361]
24-08-22.16:33:27.695 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381586","timeStamp":"2024-08-22 16:33:27.113"}
24-08-22.16:33:27.696 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:27.696 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:27.696 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381586]
24-08-22.16:33:27.696 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381586]
24-08-22.16:33:27.762 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381586","timeStamp":"2024-08-22 16:33:27.113"}
24-08-22.16:33:28.315 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653816367
24-08-22.16:33:28.315 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381636
24-08-22.16:33:28.316 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:28.316 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:28.316 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653816367, 101, OpenAI 增加使用次数, 2024-08-22 16:33:28.315, create, 1033417820224335872]
24-08-22.16:33:28.503 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:28.503 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:28.503 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381636","timeStamp":"2024-08-22 16:33:28.315"}, 18265381636, create, 1033417821004476417]
24-08-22.16:33:28.835 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381636","timeStamp":"2024-08-22 16:33:28.315"}
24-08-22.16:33:28.838 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:28.838 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:28.838 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381636]
24-08-22.16:33:28.838 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381636]
24-08-22.16:33:28.877 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381636","timeStamp":"2024-08-22 16:33:28.315"}
24-08-22.16:33:29.434 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653816836
24-08-22.16:33:29.434 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381683
24-08-22.16:33:29.435 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:29.435 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:29.435 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653816836, 101, OpenAI 增加使用次数, 2024-08-22 16:33:29.434, create, 1033417824917762048]
24-08-22.16:33:29.605 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:29.605 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:29.606 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381683","timeStamp":"2024-08-22 16:33:29.434"}, 18265381683, create, 1033417825626599425]
24-08-22.16:33:29.965 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381683","timeStamp":"2024-08-22 16:33:29.434"}
24-08-22.16:33:29.966 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:29.966 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:29.966 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381683]
24-08-22.16:33:29.966 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381683]
24-08-22.16:33:30.006 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381683","timeStamp":"2024-08-22 16:33:29.434"}
24-08-22.16:33:30.009 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:30.010 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:33:30.010 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@70b53b8b], lock=Optional.empty, window=Optional.empty)
24-08-22.16:33:30.010 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:30.010 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:30.062 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:30.557 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653817307
24-08-22.16:33:30.557 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381730
24-08-22.16:33:30.559 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:30.559 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:30.559 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653817307, 101, OpenAI 增加使用次数, 2024-08-22 16:33:30.557, create, 1033417829627965440]
24-08-22.16:33:30.746 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:30.746 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:30.746 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381730","timeStamp":"2024-08-22 16:33:30.557"}, 18265381730, create, 1033417830416494593]
24-08-22.16:33:31.111 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381730","timeStamp":"2024-08-22 16:33:30.557"}
24-08-22.16:33:31.111 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:31.111 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:31.111 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381730]
24-08-22.16:33:31.111 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381730]
24-08-22.16:33:31.158 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381730","timeStamp":"2024-08-22 16:33:30.557"}
24-08-22.16:33:31.708 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653817790
24-08-22.16:33:31.708 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381779
24-08-22.16:33:31.709 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:31.709 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:31.709 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653817790, 101, OpenAI 增加使用次数, 2024-08-22 16:33:31.708, create, 1033417834455609344]
24-08-22.16:33:31.976 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:31.976 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:31.976 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381779","timeStamp":"2024-08-22 16:33:31.708"}, 18265381779, create, 1033417835571294209]
24-08-22.16:33:32.417 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381779","timeStamp":"2024-08-22 16:33:31.708"}
24-08-22.16:33:32.418 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:32.418 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:32.418 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381779]
24-08-22.16:33:32.418 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381779]
24-08-22.16:33:32.496 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381779","timeStamp":"2024-08-22 16:33:31.708"}
24-08-22.16:33:33.062 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653818358
24-08-22.16:33:33.062 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381835
24-08-22.16:33:33.064 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:33.064 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:33.064 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653818358, 101, OpenAI 增加使用次数, 2024-08-22 16:33:33.062, create, 1033417840134696960]
24-08-22.16:33:33.270 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:33.271 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:33.271 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381835","timeStamp":"2024-08-22 16:33:33.062"}, 18265381835, create, 1033417841002917889]
24-08-22.16:33:33.630 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381835","timeStamp":"2024-08-22 16:33:33.062"}
24-08-22.16:33:33.631 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:33.631 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:33.631 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381835]
24-08-22.16:33:33.632 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381835]
24-08-22.16:33:33.668 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381835","timeStamp":"2024-08-22 16:33:33.062"}
24-08-22.16:33:34.242 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653818853
24-08-22.16:33:34.242 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381885
24-08-22.16:33:34.244 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:34.244 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:34.244 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653818853, 101, OpenAI 增加使用次数, 2024-08-22 16:33:34.242, create, 1033417845088169984]
24-08-22.16:33:34.449 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:34.449 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:34.449 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381885","timeStamp":"2024-08-22 16:33:34.242"}, 18265381885, create, 1033417845943808001]
24-08-22.16:33:34.847 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381885","timeStamp":"2024-08-22 16:33:34.242"}
24-08-22.16:33:34.848 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:34.848 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:34.848 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381885]
24-08-22.16:33:34.848 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381885]
24-08-22.16:33:34.892 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381885","timeStamp":"2024-08-22 16:33:34.242"}
24-08-22.16:33:35.010 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:35.012 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:33:35.012 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@70b53b8b], lock=Optional.empty, window=Optional.empty)
24-08-22.16:33:35.012 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:35.012 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:35.117 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:35.460 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653819364
24-08-22.16:33:35.460 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381936
24-08-22.16:33:35.461 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:35.461 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:35.461 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653819364, 101, OpenAI 增加使用次数, 2024-08-22 16:33:35.46, create, 1033417850192637952]
24-08-22.16:33:35.625 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:35.626 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:35.626 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381936","timeStamp":"2024-08-22 16:33:35.46"}, 18265381936, create, 1033417850880503809]
24-08-22.16:33:36.047 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381936","timeStamp":"2024-08-22 16:33:35.46"}
24-08-22.16:33:36.047 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:36.048 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:36.048 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381936]
24-08-22.16:33:36.048 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381936]
24-08-22.16:33:36.086 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381936","timeStamp":"2024-08-22 16:33:35.46"}
24-08-22.16:33:36.645 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653819861
24-08-22.16:33:36.645 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265381986
24-08-22.16:33:36.646 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:36.646 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:36.646 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653819861, 101, OpenAI 增加使用次数, 2024-08-22 16:33:36.645, create, 1033417855162888192]
24-08-22.16:33:36.835 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:36.835 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:36.835 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381986","timeStamp":"2024-08-22 16:33:36.645"}, 18265381986, create, 1033417855951417345]
24-08-22.16:33:37.284 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381986","timeStamp":"2024-08-22 16:33:36.645"}
24-08-22.16:33:37.286 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:37.286 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:37.287 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381986]
24-08-22.16:33:37.287 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265381986]
24-08-22.16:33:37.327 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265381986","timeStamp":"2024-08-22 16:33:36.645"}
24-08-22.16:33:37.884 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653820380
24-08-22.16:33:37.884 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265382038
24-08-22.16:33:37.886 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:37.886 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:37.886 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653820380, 101, OpenAI 增加使用次数, 2024-08-22 16:33:37.884, create, 1033417860355436544]
24-08-22.16:33:38.068 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:38.068 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:38.068 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382038","timeStamp":"2024-08-22 16:33:37.884"}, 18265382038, create, 1033417861122994177]
24-08-22.16:33:38.411 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382038","timeStamp":"2024-08-22 16:33:37.884"}
24-08-22.16:33:38.411 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:38.411 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:38.412 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382038]
24-08-22.16:33:38.412 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382038]
24-08-22.16:33:38.456 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382038","timeStamp":"2024-08-22 16:33:37.884"}
24-08-22.16:33:39.021 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653820857
24-08-22.16:33:39.021 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265382085
24-08-22.16:33:39.022 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:39.022 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:39.022 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653820857, 101, OpenAI 增加使用次数, 2024-08-22 16:33:39.021, create, 1033417865124360192]
24-08-22.16:33:39.187 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:39.187 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:39.187 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382085","timeStamp":"2024-08-22 16:33:39.021"}, 18265382085, create, 1033417865816420353]
24-08-22.16:33:39.587 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382085","timeStamp":"2024-08-22 16:33:39.021"}
24-08-22.16:33:39.589 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:39.589 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:39.589 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382085]
24-08-22.16:33:39.589 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382085]
24-08-22.16:33:39.628 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382085","timeStamp":"2024-08-22 16:33:39.021"}
24-08-22.16:33:40.001 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:40.002 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:33:40.002 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@70b53b8b], lock=Optional.empty, window=Optional.empty)
24-08-22.16:33:40.003 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:40.003 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:33:40.050 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:33:40.173 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653821341
24-08-22.16:33:40.173 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265382134
24-08-22.16:33:40.176 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:33:40.176 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:40.176 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653821341, 101, OpenAI 增加使用次数, 2024-08-22 16:33:40.173, create, 1033417869964587008]
24-08-22.16:33:40.308 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:33:40.308 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:33:40.309 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382134","timeStamp":"2024-08-22 16:33:40.173"}, 18265382134, create, 1033417870522429441]
24-08-22.16:33:40.392 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:33:40.436 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:33:40.436 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:33:40.637 [main            ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382134","timeStamp":"2024-08-22 16:33:40.173"}
24-08-22.16:33:40.638 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:40.638 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:40.638 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382134]
24-08-22.16:33:40.638 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382134]
24-08-22.16:33:40.640 [main            ] ERROR AwardRepository        - 写入中奖记录，发送MQ消息失败 userId:lyt topic:send_award
24-08-22.16:33:40.642 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:33:40.642 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:33:40.642 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382134]
24-08-22.16:33:40.642 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382134]
24-08-22.16:33:40.700 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:33:40.905 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:33:40.907 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:33:40.907 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:33:40.907 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:33:40.908 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:33:40.910 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:33:40.911 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:33:41.003 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:33:41.013 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:33:41.013 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:33:41.023 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:37:53.058 [main            ] INFO  AwardServiceTest       - Starting AwardServiceTest using Java 1.8.0_171 on LAPTOP-6UTBSJGB with PID 20708 (started by 27132 in C:\Users\27132\Java\big-market\big-market-app)
24-08-22.16:37:53.059 [main            ] INFO  AwardServiceTest       - The following 1 profile is active: "dev"
24-08-22.16:37:54.664 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-08-22.16:37:54.670 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-08-22.16:37:54.755 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 60 ms. Found 0 Redis repository interfaces.
24-08-22.16:37:55.267 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'stringToNoneShardingStrategyConfigurationConverter' of type [org.apache.shardingsphere.spring.boot.converter.StringToNoneShardingStrategyConfigurationConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:37:55.282 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'spring.shardingsphere-org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration' of type [org.apache.shardingsphere.spring.boot.prop.SpringBootPropertiesConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:37:55.540 [main            ] INFO  PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration' of type [org.apache.shardingsphere.spring.boot.ShardingSphereAutoConfiguration$$EnhancerBySpringCGLIB$$14a3866c] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
24-08-22.16:37:56.728 [main            ] INFO  Version                - Redisson 3.23.4
24-08-22.16:37:57.381 [redisson-netty-2-5] INFO  MasterPubSubConnectionPool - 1 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:37:57.731 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 8.138.41.137/8.138.41.137:16379
24-08-22.16:37:58.112 [main            ] INFO  HikariDataSource       - HikariPool-1 - Starting...
24-08-22.16:37:59.407 [main            ] INFO  HikariDataSource       - HikariPool-1 - Start completed.
24-08-22.16:37:59.421 [main            ] INFO  HikariDataSource       - HikariPool-2 - Starting...
24-08-22.16:37:59.991 [main            ] INFO  HikariDataSource       - HikariPool-2 - Start completed.
24-08-22.16:38:04.852 [main            ] INFO  StdSchedulerFactory    - Using default implementation for ThreadExecutor
24-08-22.16:38:04.865 [main            ] INFO  SchedulerSignalerImpl  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
24-08-22.16:38:04.865 [main            ] INFO  QuartzScheduler        - Quartz Scheduler v.2.3.2 created.
24-08-22.16:38:04.866 [main            ] INFO  RAMJobStore            - RAMJobStore initialized.
24-08-22.16:38:04.866 [main            ] INFO  QuartzScheduler        - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'quartzScheduler' with instanceId 'NON_CLUSTERED'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.

24-08-22.16:38:04.866 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler 'quartzScheduler' initialized from an externally provided properties instance.
24-08-22.16:38:04.866 [main            ] INFO  StdSchedulerFactory    - Quartz scheduler version: 2.3.2
24-08-22.16:38:04.866 [main            ] INFO  QuartzScheduler        - JobFactory set to: org.springframework.scheduling.quartz.SpringBeanJobFactory@5bad04d1
24-08-22.16:38:05.018 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-08-22.16:38:05.132 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [8.138.41.137:5672]
24-08-22.16:38:05.398 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#765ccc7a:0/SimpleConnection@63f79099 [delegate=amqp://admin@8.138.41.137:5672/, localPort= 62462]
24-08-22.16:38:05.981 [main            ] INFO  SchedulerFactoryBean   - Starting Quartz Scheduler now
24-08-22.16:38:05.982 [main            ] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED started.
24-08-22.16:38:05.992 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382134","timeStamp":"2024-08-22 16:33:40.173"}
24-08-22.16:38:05.999 [main            ] INFO  AwardServiceTest       - Started AwardServiceTest in 13.47 seconds (JVM running for 14.641)
24-08-22.16:38:06.300 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653932962
24-08-22.16:38:06.302 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393296
24-08-22.16:38:07.368 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:07.368 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:07.368 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653932962, 101, OpenAI 增加使用次数, 2024-08-22 16:38:06.3, create, 1033418990061858816]
24-08-22.16:38:07.656 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:07.656 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:07.656 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393296","timeStamp":"2024-08-22 16:38:06.302"}, 18265393296, create, 1033418991815077889]
24-08-22.16:38:08.122 [pool-7-thread-1 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393296","timeStamp":"2024-08-22 16:38:06.302"}
24-08-22.16:38:08.184 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393296","timeStamp":"2024-08-22 16:38:06.302"}
24-08-22.16:38:08.185 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:08.186 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:08.186 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393296]
24-08-22.16:38:08.186 [pool-7-thread-1 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393296]
24-08-22.16:38:08.584 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653933920
24-08-22.16:38:08.584 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393392
24-08-22.16:38:08.586 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:08.586 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:08.586 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653933920, 101, OpenAI 增加使用次数, 2024-08-22 16:38:08.584, create, 1033418995757723648]
24-08-22.16:38:08.722 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:08.722 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:08.722 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393392","timeStamp":"2024-08-22 16:38:08.584"}, 18265393392, create, 1033418996332343297]
24-08-22.16:38:09.071 [pool-7-thread-2 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393392","timeStamp":"2024-08-22 16:38:08.584"}
24-08-22.16:38:09.072 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:09.072 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:09.072 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393392]
24-08-22.16:38:09.072 [pool-7-thread-2 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393392]
24-08-22.16:38:09.112 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393392","timeStamp":"2024-08-22 16:38:08.584"}
24-08-22.16:38:09.581 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653934338
24-08-22.16:38:09.581 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393433
24-08-22.16:38:09.583 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:09.583 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:09.583 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653934338, 101, OpenAI 增加使用次数, 2024-08-22 16:38:09.581, create, 1033418999939444736]
24-08-22.16:38:09.781 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:09.781 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:09.782 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393433","timeStamp":"2024-08-22 16:38:09.581"}, 18265393433, create, 1033419000774111233]
24-08-22.16:38:10.001 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:38:10.079 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:38:10.107 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:38:10.107 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@413ed8af], lock=Optional.empty, window=Optional.empty)
24-08-22.16:38:10.107 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:38:10.107 [pool-7-thread-3 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:38:10.162 [pool-7-thread-4 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393433","timeStamp":"2024-08-22 16:38:09.581"}
24-08-22.16:38:10.162 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:10.162 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:10.162 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393433]
24-08-22.16:38:10.162 [pool-7-thread-4 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393433]
24-08-22.16:38:10.211 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393433","timeStamp":"2024-08-22 16:38:09.581"}
24-08-22.16:38:10.271 [pool-7-thread-5 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382134","timeStamp":"2024-08-22 16:33:40.173"}
24-08-22.16:38:10.271 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:10.272 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:10.272 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382134]
24-08-22.16:38:10.272 [pool-7-thread-5 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265382134]
24-08-22.16:38:10.312 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265382134","timeStamp":"2024-08-22 16:33:40.173"}
24-08-22.16:38:10.669 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653934795
24-08-22.16:38:10.669 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393479
24-08-22.16:38:10.670 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:10.670 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:10.670 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653934795, 101, OpenAI 增加使用次数, 2024-08-22 16:38:10.669, create, 1033419004498653184]
24-08-22.16:38:10.802 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:10.803 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:10.803 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393479","timeStamp":"2024-08-22 16:38:10.669"}, 18265393479, create, 1033419005056495617]
24-08-22.16:38:11.181 [pool-7-thread-6 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393479","timeStamp":"2024-08-22 16:38:10.669"}
24-08-22.16:38:11.182 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:11.182 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:11.182 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393479]
24-08-22.16:38:11.182 [pool-7-thread-6 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393479]
24-08-22.16:38:11.230 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393479","timeStamp":"2024-08-22 16:38:10.669"}
24-08-22.16:38:11.685 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653935221
24-08-22.16:38:11.685 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393522
24-08-22.16:38:11.686 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:11.686 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:11.686 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653935221, 101, OpenAI 增加使用次数, 2024-08-22 16:38:11.685, create, 1033419008764260352]
24-08-22.16:38:11.861 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:11.861 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:11.861 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393522","timeStamp":"2024-08-22 16:38:11.685"}, 18265393522, create, 1033419009498263553]
24-08-22.16:38:12.251 [pool-7-thread-7 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393522","timeStamp":"2024-08-22 16:38:11.685"}
24-08-22.16:38:12.252 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:12.252 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:12.252 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393522]
24-08-22.16:38:12.252 [pool-7-thread-7 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393522]
24-08-22.16:38:12.295 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393522","timeStamp":"2024-08-22 16:38:11.685"}
24-08-22.16:38:12.755 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653935670
24-08-22.16:38:12.757 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393567
24-08-22.16:38:12.758 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:12.758 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:12.758 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653935670, 101, OpenAI 增加使用次数, 2024-08-22 16:38:12.755, create, 1033419013260554240]
24-08-22.16:38:12.930 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:12.930 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:12.930 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393567","timeStamp":"2024-08-22 16:38:12.757"}, 18265393567, create, 1033419013981974529]
24-08-22.16:38:13.258 [pool-7-thread-8 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393567","timeStamp":"2024-08-22 16:38:12.757"}
24-08-22.16:38:13.259 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:13.259 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:13.259 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393567]
24-08-22.16:38:13.259 [pool-7-thread-8 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393567]
24-08-22.16:38:13.310 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393567","timeStamp":"2024-08-22 16:38:12.757"}
24-08-22.16:38:13.766 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653936094
24-08-22.16:38:13.766 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393609
24-08-22.16:38:13.767 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:13.768 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:13.768 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653936094, 101, OpenAI 增加使用次数, 2024-08-22 16:38:13.766, create, 1033419017492606976]
24-08-22.16:38:13.960 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:13.960 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:13.960 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393609","timeStamp":"2024-08-22 16:38:13.766"}, 18265393609, create, 1033419018297913345]
24-08-22.16:38:14.323 [pool-7-thread-9 ] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393609","timeStamp":"2024-08-22 16:38:13.766"}
24-08-22.16:38:14.323 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:14.323 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:14.323 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393609]
24-08-22.16:38:14.323 [pool-7-thread-9 ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393609]
24-08-22.16:38:14.370 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393609","timeStamp":"2024-08-22 16:38:13.766"}
24-08-22.16:38:14.824 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653936538
24-08-22.16:38:14.824 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393653
24-08-22.16:38:14.826 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:14.826 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:14.826 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653936538, 101, OpenAI 增加使用次数, 2024-08-22 16:38:14.824, create, 1033419021930180608]
24-08-22.16:38:14.991 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:14.991 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:14.991 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393653","timeStamp":"2024-08-22 16:38:14.824"}, 18265393653, create, 1033419022622240769]
24-08-22.16:38:15.012 [scheduling-1    ] INFO  UpdateAwardStockJob    - 定时任务，更新奖品消耗库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:38:15.051 [scheduling-1    ] INFO  UpdateActivitySkuStockJob - 定时任务，更新活动sku库存【延迟队列获取，降低对数据库的更新频次，不要产生竞争】
24-08-22.16:38:15.052 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Logic SQL: select topic,
               user_id,
               message,
               message_id
        from task where state = 'fail' or(state = 'create' and now() - update_time > 60) limit 10;;
24-08-22.16:38:15.053 [pool-7-thread-10] INFO  ShardingSphere-SQL     - SQLStatement: MySQLSelectStatement(limit=Optional[org.apache.shardingsphere.sql.parser.sql.common.segment.dml.pagination.limit.LimitSegment@413ed8af], lock=Optional.empty, window=Optional.empty)
24-08-22.16:38:15.053 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:38:15.053 [pool-7-thread-10] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: select topic,
               user_id,
               message,
               message_id
, id AS ORDER_BY_DERIVED_0         from task where state = 'fail' or(state = 'create' and now() - update_time > 60) ORDER BY id ASC  limit 10;;
24-08-22.16:38:15.340 [pool-7-thread-11] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393653","timeStamp":"2024-08-22 16:38:14.824"}
24-08-22.16:38:15.341 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:15.341 [pool-7-thread-11] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:15.341 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393653]
24-08-22.16:38:15.341 [pool-7-thread-11] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393653]
24-08-22.16:38:15.380 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393653","timeStamp":"2024-08-22 16:38:14.824"}
24-08-22.16:38:15.851 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653936968
24-08-22.16:38:15.851 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393696
24-08-22.16:38:15.853 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:15.853 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:15.853 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653936968, 101, OpenAI 增加使用次数, 2024-08-22 16:38:15.851, create, 1033419026237730816]
24-08-22.16:38:16.025 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:16.025 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:16.025 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393696","timeStamp":"2024-08-22 16:38:15.851"}, 18265393696, create, 1033419026963345409]
24-08-22.16:38:16.365 [pool-7-thread-12] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393696","timeStamp":"2024-08-22 16:38:15.851"}
24-08-22.16:38:16.366 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:16.366 [pool-7-thread-12] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:16.366 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393696]
24-08-22.16:38:16.366 [pool-7-thread-12] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393696]
24-08-22.16:38:16.400 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393696","timeStamp":"2024-08-22 16:38:15.851"}
24-08-22.16:38:16.878 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653937399
24-08-22.16:38:16.878 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393739
24-08-22.16:38:16.879 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:16.880 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:16.880 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653937399, 101, OpenAI 增加使用次数, 2024-08-22 16:38:16.878, create, 1033419030545281024]
24-08-22.16:38:17.099 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:17.099 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:17.099 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393739","timeStamp":"2024-08-22 16:38:16.878"}, 18265393739, create, 1033419031468027905]
24-08-22.16:38:17.459 [pool-7-thread-13] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393739","timeStamp":"2024-08-22 16:38:16.878"}
24-08-22.16:38:17.460 [pool-7-thread-13] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:17.460 [pool-7-thread-13] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:17.460 [pool-7-thread-13] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393739]
24-08-22.16:38:17.460 [pool-7-thread-13] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393739]
24-08-22.16:38:17.502 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic:send_award message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393739","timeStamp":"2024-08-22 16:38:16.878"}
24-08-22.16:38:17.961 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:38:17.969 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653937857
24-08-22.16:38:17.969 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393785
24-08-22.16:38:17.970 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:17.970 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:17.970 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653937857, 101, OpenAI 增加使用次数, 2024-08-22 16:38:17.969, create, 1033419035117072384]
24-08-22.16:38:18.000 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:38:18.000 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-08-22.16:38:18.172 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        ) values (?,
                 ?,
                 ?,
                 ?,
                 ?);
24-08-22.16:38:18.172 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:18.172 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: insert into task(
            topic,
            user_id,
            message,
            message_id,
            state
        , id) values (?, ?, ?, ?, ?, ?); ::: [send_award, lyt, {"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393785","timeStamp":"2024-08-22 16:38:17.969"}, 18265393785, create, 1033419035968516097]
24-08-22.16:38:18.520 [pool-7-thread-14] INFO  EventPublisher         - 发送 MQ 消息 topic:send_award, message:{"data":{"awardId":101,"awardTitle":"OpenAI 增加使用次数","userId":"lyt"},"id":"18265393785","timeStamp":"2024-08-22 16:38:17.969"}
24-08-22.16:38:18.520 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:18.520 [pool-7-thread-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:18.520 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393785]
24-08-22.16:38:18.520 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'completed', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393785]
24-08-22.16:38:18.522 [pool-7-thread-14] ERROR AwardRepository        - 写入中奖记录，发送MQ消息失败 userId:lyt topic:send_award
24-08-22.16:38:18.524 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Logic SQL: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?;
24-08-22.16:38:18.524 [pool-7-thread-14] INFO  ShardingSphere-SQL     - SQLStatement: MySQLUpdateStatement(orderBy=Optional.empty, limit=Optional.empty)
24-08-22.16:38:18.524 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Actual SQL: ds0 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393785]
24-08-22.16:38:18.524 [pool-7-thread-14] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: update task set state = 'fail', update_time = now()
        where user_id = ? and message_id = ?; ::: [lyt, 18265393785]
24-08-22.16:38:18.561 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:38:19.027 [main            ] INFO  SnowflakeUUIDUtils     - 12位数字的UUID:182653938300
24-08-22.16:38:19.027 [main            ] INFO  SnowflakeUUIDUtils     - 11位数字的UUID:18265393830
24-08-22.16:38:19.029 [main            ] INFO  ShardingSphere-SQL     - Logic SQL: insert into user_award_record(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state) values(?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?,
                                ?);
24-08-22.16:38:19.029 [main            ] INFO  ShardingSphere-SQL     - SQLStatement: MySQLInsertStatement(setAssignment=Optional.empty, onDuplicateKeyColumns=Optional.empty)
24-08-22.16:38:19.029 [main            ] INFO  ShardingSphere-SQL     - Actual SQL: ds1 ::: insert into user_award_record_0(user_id,
            activity_id,
            strategy_id,
            order_id,
            award_id,
            award_title,
            award_time,
            award_state, id) values(?, ?, ?, ?, ?, ?, ?, ?, ?); ::: [lyt, 100301, 100006, 182653938300, 101, OpenAI 增加使用次数, 2024-08-22 16:38:19.027, create, 1033419039558840320]
24-08-22.16:38:19.037 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-08-22.16:38:19.039 [SpringApplicationShutdownHook] INFO  SchedulerFactoryBean   - Shutting down Quartz Scheduler
24-08-22.16:38:19.039 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutting down.
24-08-22.16:38:19.039 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED paused.
24-08-22.16:38:19.039 [SpringApplicationShutdownHook] INFO  QuartzScheduler        - Scheduler quartzScheduler_$_NON_CLUSTERED shutdown complete.
24-08-22.16:38:19.042 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:38:19.042 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-08-22.16:38:19.144 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown initiated...
24-08-22.16:38:19.152 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-1 - Shutdown completed.
24-08-22.16:38:19.152 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown initiated...
24-08-22.16:38:19.160 [SpringApplicationShutdownHook] INFO  HikariDataSource       - HikariPool-2 - Shutdown completed.
24-08-22.16:38:19.171 [main            ] WARN  ProxyConnection        - HikariPool-2 - Connection com.mysql.cj.jdbc.ConnectionImpl@aab2419 marked as broken because of SQLSTATE(08S01), ErrorCode(0)
com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1422)
	at com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1407)
	at com.mysql.cj.jdbc.ClientPreparedStatement.checkReadOnlySafeStatement(ClientPreparedStatement.java:307)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:317)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:322)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:318)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:85)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:64)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.syncExecute(ExecutorEngine.java:101)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.serialExecute(ExecutorEngine.java:87)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.execute(ExecutorEngine.java:81)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:65)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:49)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.doExecute(JDBCLockEngine.java:116)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.execute(JDBCLockEngine.java:93)
	at org.apache.shardingsphere.driver.executor.DriverJDBCExecutor.execute(DriverJDBCExecutor.java:127)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.execute(ShardingSpherePreparedStatement.java:298)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	at com.sun.proxy.$Proxy245.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy268.insert(Unknown Source)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:77)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:74)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$39a0c0e3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$8de4ab4.saveUserAwardRecord(<generated>)
	at com.big.market.infrastructure.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:57)
	at com.big.market.infrastructure.domain.test.award.AwardServiceTest.test_saveUserAwardRecord(AwardServiceTest.java:44)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:647)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:134)
	at com.mysql.cj.NativeSession.sendCommand(NativeSession.java:311)
	at com.mysql.cj.NativeSession.queryServerVariable(NativeSession.java:1008)
	at com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1414)
	... 83 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:171)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at sun.security.ssl.InputRecord.readFully(InputRecord.java:465)
	at sun.security.ssl.InputRecord.read(InputRecord.java:503)
	at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:983)
	at sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:940)
	at sun.security.ssl.AppInputStream.read(AppInputStream.java:105)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 89 common frames omitted
24-08-22.16:38:19.212 [main            ] ERROR TransactionTemplate    - Application exception overridden by rollback exception
org.springframework.dao.RecoverableDataAccessException: 
### Error updating database.  Cause: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
### The error may exist in file [C:\Users\27132\Java\big-market\big-market-app\target\classes\mybatis\mapper\UserAwardRecordMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: insert into user_award_record(user_id,             activity_id,             strategy_id,             order_id,             award_id,             award_title,             award_time,             award_state) values(?,                                 ?,                                 ?,                                 ?,                                 ?,                                 ?,                                 ?,                                 ?);
### Cause: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
; Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.; nested exception is com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
	at org.springframework.jdbc.support.SQLExceptionSubclassTranslator.doTranslate(SQLExceptionSubclassTranslator.java:100)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:70)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:79)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:91)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:441)
	at com.sun.proxy.$Proxy245.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:272)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:62)
	at org.apache.ibatis.binding.MapperProxy$PlainMethodInvoker.invoke(MapperProxy.java:152)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:85)
	at com.sun.proxy.$Proxy268.insert(Unknown Source)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.lambda$saveUserAwardRecord$0(AwardRepository.java:77)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository.saveUserAwardRecord(AwardRepository.java:74)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$FastClassBySpringCGLIB$$39a0c0e3.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:793)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:137)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:763)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:708)
	at com.big.market.infrastructure.infrastructure.persistent.repository.AwardRepository$$EnhancerBySpringCGLIB$$8de4ab4.saveUserAwardRecord(<generated>)
	at com.big.market.infrastructure.domain.award.service.AwardService.saveUserAwardRecord(AwardService.java:57)
	at com.big.market.infrastructure.domain.test.award.AwardServiceTest.test_saveUserAwardRecord(AwardServiceTest.java:44)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.springframework.test.context.junit4.statements.RunBeforeTestExecutionCallbacks.evaluate(RunBeforeTestExecutionCallbacks.java:74)
	at org.springframework.test.context.junit4.statements.RunAfterTestExecutionCallbacks.evaluate(RunAfterTestExecutionCallbacks.java:84)
	at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)
	at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)
	at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:251)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:97)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
	at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:190)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:232)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:55)
Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
	at com.mysql.cj.jdbc.exceptions.SQLError.createCommunicationsException(SQLError.java:174)
	at com.mysql.cj.jdbc.exceptions.SQLExceptionsMapping.translateException(SQLExceptionsMapping.java:64)
	at com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1422)
	at com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1407)
	at com.mysql.cj.jdbc.ClientPreparedStatement.checkReadOnlySafeStatement(ClientPreparedStatement.java:307)
	at com.mysql.cj.jdbc.ClientPreparedStatement.execute(ClientPreparedStatement.java:317)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.execute(ProxyPreparedStatement.java:44)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.execute(HikariProxyPreparedStatement.java)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:322)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement$2.executeSQL(ShardingSpherePreparedStatement.java:318)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:85)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutorCallback.execute(JDBCExecutorCallback.java:64)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.syncExecute(ExecutorEngine.java:101)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.serialExecute(ExecutorEngine.java:87)
	at org.apache.shardingsphere.infra.executor.kernel.ExecutorEngine.execute(ExecutorEngine.java:81)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:65)
	at org.apache.shardingsphere.infra.executor.sql.execute.engine.driver.jdbc.JDBCExecutor.execute(JDBCExecutor.java:49)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.doExecute(JDBCLockEngine.java:116)
	at org.apache.shardingsphere.driver.executor.JDBCLockEngine.execute(JDBCLockEngine.java:93)
	at org.apache.shardingsphere.driver.executor.DriverJDBCExecutor.execute(DriverJDBCExecutor.java:127)
	at org.apache.shardingsphere.driver.jdbc.core.statement.ShardingSpherePreparedStatement.execute(ShardingSpherePreparedStatement.java:298)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.update(PreparedStatementHandler.java:47)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.update(RoutingStatementHandler.java:74)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:50)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:197)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:184)
	at sun.reflect.GeneratedMethodAccessor17.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:427)
	... 54 common frames omitted
Caused by: com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure

The last packet successfully received from the server was 39 milliseconds ago. The last packet sent successfully to the server was 39 milliseconds ago.
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:61)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:105)
	at com.mysql.cj.exceptions.ExceptionFactory.createException(ExceptionFactory.java:151)
	at com.mysql.cj.exceptions.ExceptionFactory.createCommunicationsException(ExceptionFactory.java:167)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:544)
	at com.mysql.cj.protocol.a.NativeProtocol.checkErrorMessage(NativeProtocol.java:708)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:647)
	at com.mysql.cj.protocol.a.NativeProtocol.sendCommand(NativeProtocol.java:134)
	at com.mysql.cj.NativeSession.sendCommand(NativeSession.java:311)
	at com.mysql.cj.NativeSession.queryServerVariable(NativeSession.java:1008)
	at com.mysql.cj.jdbc.ConnectionImpl.isReadOnly(ConnectionImpl.java:1414)
	... 83 common frames omitted
Caused by: java.net.SocketException: Socket closed
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:171)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at sun.security.ssl.InputRecord.readFully(InputRecord.java:465)
	at sun.security.ssl.InputRecord.read(InputRecord.java:503)
	at sun.security.ssl.SSLSocketImpl.readRecord(SSLSocketImpl.java:983)
	at sun.security.ssl.SSLSocketImpl.readDataRecord(SSLSocketImpl.java:940)
	at sun.security.ssl.AppInputStream.read(AppInputStream.java:105)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at com.mysql.cj.protocol.FullReadInputStream.readFully(FullReadInputStream.java:64)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:63)
	at com.mysql.cj.protocol.a.SimplePacketReader.readHeader(SimplePacketReader.java:45)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:52)
	at com.mysql.cj.protocol.a.TimeTrackingPacketReader.readHeader(TimeTrackingPacketReader.java:41)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:54)
	at com.mysql.cj.protocol.a.MultiPacketReader.readHeader(MultiPacketReader.java:44)
	at com.mysql.cj.protocol.a.NativeProtocol.readMessage(NativeProtocol.java:538)
	... 89 common frames omitted
